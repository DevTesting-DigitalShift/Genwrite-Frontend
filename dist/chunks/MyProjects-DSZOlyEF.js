import{u as Ee,p as Le,l as Ue,r as s,j as e,H as Ge,L as He}from"./vendor-react-De2z0TIU.js";import{b as ze}from"./SkeletonLoader-CUzOutGK.js";import{s as Ye,u as Qe,w as Ke,E as qe,k as We}from"../assets/index-CsB5qvyX.js";import{h as l}from"./vendor-utils-8H1_Lg8i.js";import{bU as Ze,bV as Ve,bW as pe,bX as Je}from"./vendor-misc-VtNtTC9_.js";import{x as Xe,y as et,z as he,G as tt,H as xe,J as st,K as at,I as lt,N as X,B as _,d as Q,O as rt,k as nt,Q as ot,U as it,s as F}from"./vendor-ui-C0h2rz9i.js";import{m as b}from"./vendor-animation-DLXwypMl.js";import{f as ct,X as dt,h as ut,ab as mt,ac as gt,ad as pt,a6 as ht,N as ee,c as xt}from"./vendor-icons-Cq_V5qsk.js";import"./vendor-documents-Bo4tJiCa.js";import"./vendor-http-DugNE7E_.js";import"./vendor-state-WK08LdY7.js";var ft=(B,E,y)=>new Promise((L,I)=>{var U=m=>{try{N(y.next(m))}catch(f){I(f)}},G=m=>{try{N(y.throw(m))}catch(f){I(f)}},N=m=>m.done?L(m.value):Promise.resolve(m.value).then(U,G);N((y=y.apply(B,E)).next())});const{RangePicker:bt}=rt,Rt=()=>{var B,E,y,L,I,U,G,N;const m=Ee(),f=Le(),K=Ze(),te=Ue(Ye),a=(te==null?void 0:te.id)||"guest",[se,fe]=s.useState([]),[$,c]=s.useState(1),[v,H]=s.useState(15),[g,k]=s.useState(()=>sessionStorage.getItem(`user_${a}_sortType`)||"updatedAt"),[p,R]=s.useState(()=>sessionStorage.getItem(`user_${a}_sortOrder`)||"desc"),[h,D]=s.useState(()=>sessionStorage.getItem(`user_${a}_statusFilter`)||"all"),[r,S]=s.useState([sessionStorage.getItem(`user_${a}_dateRangeStart`)?l(sessionStorage.getItem(`user_${a}_dateRangeStart`)):null,sessionStorage.getItem(`user_${a}_dateRangeEnd`)?l(sessionStorage.getItem(`user_${a}_dateRangeEnd`)):null]),[i,j]=s.useState([sessionStorage.getItem(`user_${a}_presetDateRangeStart`)?l(sessionStorage.getItem(`user_${a}_presetDateRangeStart`)):null,sessionStorage.getItem(`user_${a}_presetDateRangeEnd`)?l(sessionStorage.getItem(`user_${a}_presetDateRangeEnd`)):null]),[x,q]=s.useState(()=>sessionStorage.getItem(`user_${a}_searchTerm`)||""),[be,A]=s.useState(!1),[ye,O]=s.useState(!1),[ve,C]=s.useState(!1),[P,w]=s.useState(()=>sessionStorage.getItem(`user_${a}_activePresetLabel`)||""),{handlePopup:Se}=Qe(),je=120,[ae,we]=s.useState(0);s.useEffect(()=>{sessionStorage.setItem(`user_${a}_sortType`,g),sessionStorage.setItem(`user_${a}_sortOrder`,p),sessionStorage.setItem(`user_${a}_statusFilter`,h),sessionStorage.setItem(`user_${a}_searchTerm`,x),sessionStorage.setItem(`user_${a}_activePresetLabel`,P),sessionStorage.setItem(`user_${a}_dateRangeStart`,r[0]?r[0].toISOString():""),sessionStorage.setItem(`user_${a}_dateRangeEnd`,r[1]?r[1].toISOString():""),sessionStorage.setItem(`user_${a}_presetDateRangeStart`,i[0]?i[0].toISOString():""),sessionStorage.setItem(`user_${a}_presetDateRangeEnd`,i[1]?i[1].toISOString():"")},[a,g,p,h,x,r,i,P]),s.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[$]);const _e=s.useCallback(()=>{k("updatedAt"),R("desc"),D("all"),S([null,null]),j([null,null]),w(""),q(""),c(1),sessionStorage.removeItem(`user_${a}_sortType`),sessionStorage.removeItem(`user_${a}_sortOrder`),sessionStorage.removeItem(`user_${a}_statusFilter`),sessionStorage.removeItem(`user_${a}_searchTerm`),sessionStorage.removeItem(`user_${a}_activePresetLabel`),sessionStorage.removeItem(`user_${a}_dateRangeStart`),sessionStorage.removeItem(`user_${a}_dateRangeEnd`),sessionStorage.removeItem(`user_${a}_presetDateRangeStart`),sessionStorage.removeItem(`user_${a}_presetDateRangeEnd`)},[a]),Ne=s.useCallback(()=>{q(""),c(1)},[]),W=g==="updatedAt"&&p==="desc",Ce=s.useMemo(()=>x||!W||h!=="all"||r[0]||i[0],[x,W,h,r,i]),Ie=s.useCallback(()=>g==="title"&&p==="asc"?"A-Z":g==="title"&&p==="desc"?"Z-A":g==="updatedAt"&&p==="desc"?"Recently Updated":g==="updatedAt"&&p==="asc"?"Oldest Updated":"Recently Updated",[g,p]),$e=s.useCallback(()=>{switch(h){case"complete":return"Completed";case"pending":return"Pending";case"failed":return"Failed";default:return"All"}},[h]),ke=s.useCallback(()=>P||(r[0]&&r[1]?`${l(r[0]).format("MMM DD")} - ${l(r[1]).format("MMM DD")}`:"All Dates"),[P,r]),Re=s.useCallback(()=>ft(null,null,function*(){const t={start:r[0]?l(r[0]).toISOString():i[0]?l(i[0]).toISOString():void 0,end:r[1]?l(r[1]).toISOString():i[1]?l(i[1]).toISOString():void 0,isArchived:""};return(yield m(We(t)).unwrap()).data||[]}),[m,r,i]),{data:z=[],isLoading:le}=Ve({queryKey:["blogs",(E=(B=r[0])==null?void 0:B.toISOString())!=null?E:null,(L=(y=r[1])==null?void 0:y.toISOString())!=null?L:null,(U=(I=i[0])==null?void 0:I.toISOString())!=null?U:null,(N=(G=i[1])==null?void 0:G.toISOString())!=null?N:null],queryFn:Re,staleTime:10*60*1e3,cacheTime:15*60*1e3,onError:t=>{F.error("Failed to load blogs. Please try again.")}}),re=pe({mutationFn:t=>m(Ke({id:t})).unwrap(),onSuccess:()=>{K.invalidateQueries(["blogs"]),F.success("Blog retry initiated.")},onError:t=>{F.error("Failed to retry blog.")}}),ne=pe({mutationFn:t=>m(qe(t)).unwrap(),onSuccess:()=>{K.invalidateQueries(["blogs"]),F.success("Blog moved to trash.")},onError:t=>{F.error("Failed to archive blog.")}}),oe=s.useMemo(()=>new Je(z,{keys:[{name:"title",weight:.5},{name:"content",weight:.3},{name:"focusKeywords",weight:.2}],threshold:.3,includeScore:!0,shouldSort:!0}),[z]),Z=s.useMemo(()=>{let t=z;x.trim()&&(t=oe.search(x).map(({item:o})=>o)),h!=="all"&&(t=t.filter(o=>o.status===h)),r[0]&&r[1]?t=t.filter(o=>l(o.updatedAt).isBetween(r[0],r[1],"day","[]")):i[0]&&i[1]&&(t=t.filter(o=>l(o.updatedAt).isBetween(i[0],i[1],"day","[]")));const n=[...t];return g==="title"?n.sort((o,d)=>p==="asc"?o.title.localeCompare(d.title):d.title.localeCompare(o.title)):g==="updatedAt"&&n.sort((o,d)=>p==="asc"?new Date(o.updatedAt)-new Date(d.updatedAt):new Date(d.updatedAt)-new Date(o.updatedAt)),{blogs:n.slice(($-1)*v,$*v),total:n.length}},[z,x,h,r,i,g,p,$,v,oe]);s.useEffect(()=>{fe(Z.blogs),we(Z.total)},[Z]),s.useEffect(()=>{const t=()=>{window.innerWidth>=1024?H(15):window.innerWidth>=768?H(12):H(6),c(1)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const ie=s.useCallback(t=>{f(`/toolbox/${t._id}`)},[f]),ce=s.useCallback(t=>{f(`/blog-editor/${t._id}`)},[f]),De=s.useCallback(t=>{re.mutate(t)},[re]),Ae=s.useCallback(t=>{ne.mutate(t)},[ne]),de=s.useCallback((t,n=je)=>t?t.length>n?t.substring(0,n)+"...":t:"",[]),ue=s.useCallback(t=>{var n,o,d;return(d=(o=(n=t==null?void 0:t.replace(/<[^>]*>/g,""))==null?void 0:n.replace(/[\\*#=_~`>\-]+/g,""))==null?void 0:o.replace(/\s{2,}/g," "))==null?void 0:d.trim()},[]),Oe=s.useMemo(()=>[{label:"A-Z (Ascending)",icon:e.jsx(Xe,{}),onClick:()=>{k("title"),R("asc"),A(!1),c(1)}},{label:"Z-A (Descending)",icon:e.jsx(et,{}),onClick:()=>{k("title"),R("desc"),A(!1),c(1)}},{label:"Recently Updated",icon:e.jsx(he,{}),onClick:()=>{k("updatedAt"),R("desc"),A(!1),c(1)}},{label:"Oldest Updated",icon:e.jsx(tt,{}),onClick:()=>{k("updatedAt"),R("asc"),A(!1),c(1)}}],[]),Pe=s.useMemo(()=>[{label:"All Statuses",icon:e.jsx(xe,{}),onClick:()=>{D("all"),O(!1),c(1)}},{label:"Status: Completed",icon:e.jsx(xe,{}),onClick:()=>{D("complete"),O(!1),c(1)}},{label:"Status: Pending",icon:e.jsx(st,{}),onClick:()=>{D("pending"),O(!1),c(1)}},{label:"Status: Failed",icon:e.jsx(at,{}),onClick:()=>{D("failed"),O(!1),c(1)}}],[]),Me=s.useMemo(()=>[{label:"Last 7 Days",value:[l().subtract(7,"days"),l()],onClick:()=>{j([l().subtract(7,"days"),l()]),S([null,null]),w("Last 7 Days"),c(1),C(!1)}},{label:"Last 30 Days",value:[l().subtract(30,"days"),l()],onClick:()=>{j([l().subtract(30,"days"),l()]),S([null,null]),w("Last 30 Days"),c(1),C(!1)}},{label:"Last 3 Months",value:[l().subtract(3,"months"),l()],onClick:()=>{j([l().subtract(3,"months"),l()]),S([null,null]),w("Last 3 Months"),c(1),C(!1)}},{label:"Last 6 Months",value:[l().subtract(6,"months"),l()],onClick:()=>{j([l().subtract(6,"months"),l()]),S([null,null]),w("Last 6 Months"),c(1),C(!1)}},{label:"This Year",value:[l().startOf("year"),l()],onClick:()=>{j([l().startOf("year"),l()]),S([null,null]),w("This Year"),c(1),C(!1)}}],[]);return e.jsxs("div",{className:"p-5",children:[e.jsx(Ge,{children:e.jsx("title",{children:"Blogs | GenWrite"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(b.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4},className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Blogs Generated"}),e.jsx(b.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"text-gray-500 text-sm mt-2 max-w-md",children:"All your content creation tools in one place. Streamline your workflow with our powerful suite of tools."})]}),e.jsx(b.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(He,{to:"/blog-editor",className:"flex items-center gap-2 px-4 py-2 bg-[#1B6FC9] hover:bg-[#1B6FC9]/90 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(ct,{className:"w-4 h-4"}),"New Blog"]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 bg-white p-4 rounded-lg mb-6",children:[e.jsx("div",{className:"flex-1 flex items-center gap-2",children:e.jsx(lt,{placeholder:"Search blogs...",value:x,onChange:t=>{q(t.target.value),c(1)},prefix:e.jsx(ut,{className:"w-4 h-4 text-gray-500"}),suffix:x?e.jsx(dt,{className:"w-4 h-4 text-gray-500 cursor-pointer",onClick:Ne}):null,className:"rounded-lg border-gray-300 shadow-sm","aria-label":"Search blogs"})}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(X,{open:be,onOpenChange:t=>A(t),trigger:"click",placement:"bottomRight",content:e.jsx("div",{className:"min-w-[200px] rounded-lg space-y-1",children:Oe.map(({label:t,icon:n,onClick:o})=>e.jsx(Q,{title:t,placement:"left",children:e.jsxs("button",{onClick:o,className:"w-full flex items-center gap-3 px-4 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors","aria-label":`Sort by ${t}`,children:[e.jsx("span",{className:"text-lg",children:n}),e.jsx("span",{children:t})]})},t))}),children:e.jsx(b.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(_,{type:"default",icon:e.jsx(mt,{className:"w-4 h-4"}),className:`p-2 rounded-lg border-gray-300 shadow-sm hover:bg-gray-100 ${W?"":"border-blue-400 bg-blue-50 text-blue-600"}`,"aria-label":"Open sort menu",children:["Sort: ",Ie()]})})}),e.jsx(X,{open:ye,onOpenChange:t=>O(t),trigger:"click",placement:"bottomRight",content:e.jsx("div",{className:"min-w-[200px] rounded-lg space-y-1",children:Pe.map(({label:t,icon:n,onClick:o})=>e.jsx(Q,{title:t,placement:"left",children:e.jsxs("button",{onClick:o,className:"w-full flex items-center gap-3 px-4 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors","aria-label":`Filter by ${t}`,children:[e.jsx("span",{className:"text-lg",children:n}),e.jsx("span",{children:t})]})},t))}),children:e.jsx(b.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(_,{type:"default",icon:e.jsx(gt,{className:"w-4 h-4"}),className:`p-2 rounded-lg border-gray-300 shadow-sm hover:bg-gray-100 ${h!=="all"?"border-green-400 bg-green-50 text-green-600":""}`,"aria-label":"Open filter menu",children:["Filter: ",$e()]})})}),e.jsx(X,{open:ve,onOpenChange:t=>C(t),trigger:"click",placement:"bottomRight",content:e.jsx("div",{children:Me.map(({label:t,onClick:n})=>e.jsx(Q,{title:t,placement:"left",children:e.jsxs("button",{onClick:n,className:"w-full flex items-center gap-3 px-4 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors","aria-label":`Filter by ${t}`,children:[e.jsx("span",{className:"text-lg",children:e.jsx(he,{})}),e.jsx("span",{children:t})]})},t))}),children:e.jsx(b.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(_,{type:"default",icon:e.jsx(pt,{className:"w-4 h-4"}),className:`p-2 rounded-lg border-gray-300 shadow-sm hover:bg-gray-100 ${r[0]||i[0]?"border-purple-400 bg-purple-50 text-purple-600":""}`,"aria-label":"Open date preset menu",children:["Date: ",ke()]})})}),e.jsx(b.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(_,{type:"default",icon:e.jsx(ht,{className:"w-4 h-4"}),onClick:()=>K.invalidateQueries(["blogs"]),className:"p-2 rounded-lg border-gray-300 shadow-sm hover:bg-gray-100","aria-label":"Refresh blogs",children:"Refresh"})}),e.jsx(b.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(_,{type:"default",icon:e.jsx(ee,{className:"w-4 h-4"}),onClick:_e,className:`p-2 rounded-lg border-gray-300 shadow-sm hover:bg-gray-100 ${Ce?"border-red-400 bg-red-50 text-red-600":""}`,"aria-label":"Reset filters",children:"Reset"})})]}),e.jsx("div",{className:"flex-1",children:e.jsx(bt,{value:r,onChange:t=>{S(t),j([null,null]),w(""),c(1)},className:`w-full rounded-lg border-gray-300 shadow-sm ${r[0]||i[0]?"border-purple-400 shadow-purple-100":""}`,format:"YYYY-MM-DD",placeholder:["Start date","End date"],"aria-label":"Select date range",disabledDate:t=>t&&t>l().endOf("day")})})]}),le?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:[...Array(v)].map((t,n)=>e.jsx("div",{className:"bg-white shadow-md rounded-xl p-4",children:e.jsx(ze,{})},n))}):se.length===0?e.jsxs("div",{className:"flex flex-col justify-center items-center",style:{minHeight:"calc(100vh - 270px)"},children:[e.jsx("img",{src:"Images/no-blog.png",alt:"No blogs",style:{width:"8rem"}}),e.jsx("p",{className:"text-xl mt-5",children:"No blogs available."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 place-items-center p-2",children:se.map(t=>{const n=t.isManuallyEdited===!0,{_id:o,title:d,status:u,createdAt:Te,content:me,aiModel:M,focusKeywords:ge,updatedAt:Fe,wordpress:V,agendaJob:J}=t,Y=/gemini/gi.test(M);return e.jsx(nt.Ribbon,{text:e.jsx("span",{className:"flex items-center justify-center gap-1 py-1 font-medium tracking-wide",children:n?e.jsx(e.Fragment,{children:"Manually Generated"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`./Images/${Y?"gemini":M==="claude"?"claude":"chatgpt"}.png`,alt:Y?"Gemini":M==="claude"?"Claude":"ChatGPT",width:20,height:20,loading:"lazy",className:"bg-white"}),Y?"Gemini 2.0 flash":M==="claude"?"Claude 4 sonnet":"Gpt 4.1 nano"]})}),className:"absolute top-0",color:n?"#9CA3AF":Y?"#4796E3":M==="claude"?"#9368F8":"#74AA9C",children:e.jsxs("div",{className:`bg-white shadow-md hover:shadow-xl transition-all duration-300 rounded-xl p-4 min-h-[180px] min-w-[390px] relative ${n?"border-gray-500":u==="failed"?"border-red-500":u==="pending"||u==="in-progress"?"border-yellow-500":"border-green-500"} border-2`,title:d,children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 -mt-2",children:new Date(Te).toLocaleDateString("en-US",{dateStyle:"medium"})}),n?e.jsx("div",{className:"cursor-pointer",onClick:()=>ce(t),role:"button",tabIndex:0,onKeyDown:T=>T.key==="Enter"&&ce(t),"aria-label":`View blog ${d}`,children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg capitalize font-semibold text-gray-900 !text-left max-w-76",children:d}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:de(ue(me))||""})]})}):e.jsx(Q,{title:u==="complete"?d:u==="failed"?"Blog generation failed":u==="pending"?`Pending Blog will be generated ${J!=null&&J.nextRunAt?"at "+new Date(J.nextRunAt).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"shortly"}`:`Blog generation is ${u}`,color:u==="complete"?"green":u==="failed"?"red":"#eab308",children:e.jsx("div",{className:"cursor-pointer",onClick:()=>{(u==="complete"||u==="failed")&&ie(t)},role:"button",tabIndex:0,onKeyDown:T=>T.key==="Enter"&&(u==="complete"||u==="failed")&&ie(t),"aria-label":`View blog ${d}`,children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg capitalize font-semibold text-gray-900 !text-left max-w-76",children:d}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:de(ue(me))||""})]})})}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:ge==null?void 0:ge.map((T,Be)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:T},Be))}),u==="failed"&&e.jsx(ot,{title:"Retry Blog Generation",description:"Are you sure you want to retry generating this blog?",icon:e.jsx(ee,{style:{color:"red"},size:15,className:"mt-1 mr-1"}),okText:"Yes",cancelText:"No",onConfirm:()=>De(o),children:e.jsx(_,{type:"text",className:"p-2 hover:!border-blue-500 hover:text-blue-500","aria-label":"Retry blog generation",children:e.jsx(ee,{})})}),e.jsx(_,{type:"text",className:"p-2 hover:!border-red-500 hover:text-red-500",onClick:()=>Se({title:"Move to Trash",description:e.jsxs("span",{className:"my-2",children:["Blog ",e.jsx("b",{children:d})," will be moved to trash. You can restore it later."]}),confirmText:"Delete",onConfirm:()=>{Ae(o)},confirmProps:{type:"text",className:"border-red-500 hover:bg-red-500 hover:text-white"},cancelProps:{danger:!1}}),"aria-label":`Move blog ${d} to trash`,children:e.jsx(xt,{})})]}),e.jsxs("div",{className:"mt-3 -mb-2 flex justify-end text-xs text-right text-gray-500 font-medium",children:[(V==null?void 0:V.postedOn)&&e.jsxs("span",{className:"",children:["Posted on:"," ",new Date(V.postedOn).toLocaleDateString("en-US",{dateStyle:"medium"})]}),e.jsxs("span",{className:"ml-auto",children:["Last updated:"," ",new Date(Fe).toLocaleDateString("en-US",{dateStyle:"medium"})]})]})]})},o)})}),ae>v&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx(it,{current:$,total:ae,pageSize:v,onChange:(t,n)=>{c(t),n!==v&&(H(n),c(1))},showTotal:t=>`Total ${t} blogs`,responsive:!0,showSizeChanger:!1,pageSizeOptions:["6","12","15"],disabled:le})})]})]})};export{Rt as default};
