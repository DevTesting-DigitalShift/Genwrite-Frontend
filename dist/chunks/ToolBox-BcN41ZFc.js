import{r,p as It,l as et,o as ts,u as wt,j as e,M as mt,R as js,w as vs,H as Ns}from"./vendor-react-De2z0TIU.js";import{u as ss,L as _t,w as Cs,x as ns,y as ks,z as Ss,A as Ps,c as _s,i as Ot,B as Mt,C as Is,D as Es}from"../assets/index-CsB5qvyX.js";import{E as $s,P as Ls,a as Os,D as Ms,b as Rs,u as Ts,S as As,L as Hs,I as Bs,U as Fs,T as Ks,B as zs,c as Ds}from"./vendor-editor-CAITLBdr.js";import{m as He,p as rs,h as Us,d as Gs}from"./vendor-documents-Bo4tJiCa.js";import{bP as qs,bQ as Ws,bR as xt,bS as pt,bT as Ys}from"./vendor-misc-VtNtTC9_.js";import{s as c,d as R,M as ze,I as Xe,B as xe,e as Vs,S as Ke,j as kt,D as Xs,q as ls,k as Rt,a as Tt,c as Zs,T as Qs}from"./vendor-ui-C0h2rz9i.js";import{m as D,A as ft}from"./vendor-animation-DLXwypMl.js";import{q as rt,r as Je,c as Js,H as en,s as At,t as tn,u as at,v as ot,w as sn,x as nn,y as rn,z as ln,D as an,E as on,J as cn,K as dn,N as Ht,O as un,m as mn,Q as xn,V as Et,X as gt,f as yt,W as pn,Y as hn,_ as fn,$ as as,a0 as Bt,a as it,a1 as ct,a2 as gn,C as Ft,S as os,F as ht,Z as yn,a3 as Kt,a4 as bn,a5 as wn,a6 as jn,R as vn,a7 as Nn,a8 as Cn}from"./vendor-icons-Cq_V5qsk.js";import{g as kn}from"./getEstimatedCost-B6lBIM45.js";import{o as Sn,C as Pn,p as St}from"./templates-BeBY2wqa.js";import"./vendor-http-DugNE7E_.js";import"./vendor-state-WK08LdY7.js";import"./vendor-utils-8H1_Lg8i.js";const _n=new Os("proofreading"),In=$s.create({name:"proofreadingDecoration",addOptions(){return{suggestions:[]}},addProseMirrorPlugins(){return[new Ls({key:_n,props:{decorations:n=>{const s=[],{doc:o}=n,y=this.options.suggestions;return o.descendants((d,g)=>{if(!d.isText)return;const w=d.text||"";y.forEach(({original:m,change:x})=>{let v=0;for(;v<w.length;){const M=w.indexOf(m,v);if(M===-1)break;const L=g+M,P=L+m.length;s.push(Rs.inline(L,P,{class:"proofreading-mark",nodeName:"span","data-original":m,"data-suggestion":x,"data-from":L,"data-to":P})),v=M+m.length}})}),Ms.create(o,s)}}})]}});function En(n){const[s,o]=r.useState(null),y=r.useRef(null);return r.useEffect(()=>{if(!n)return;const w=m=>{const x=m.target.closest(".proofreading-mark");x&&x.dataset.suggestion?o(x):o(null)};return n.view.dom.addEventListener("mousedown",w),()=>n.view.dom.removeEventListener("mousedown",w)},[n]),{activeSpan:s,bubbleRef:y,applyChange:()=>{var w,m,x;if(!s||!n)return;const v=Number(s.dataset.from),M=Number(s.dataset.to),L=s.dataset.suggestion,P=s.dataset.original;if(!(!L||isNaN(v)||isNaN(M)))try{n.chain().focus().deleteRange({from:v,to:M}).insertContent(L).run();const O=((x=(m=(w=n.extensionManager.extensions.find(ne=>ne.name==="proofreadingDecoration"))==null?void 0:w.options)==null?void 0:m.suggestions)==null?void 0:x.filter(ne=>ne.original!==P))||[],Y=n.extensionManager.extensions.find(ne=>ne.name==="proofreadingDecoration");Y&&(Y.options.suggestions=O,n.view.dispatch(n.state.tr)),o(null)}catch(O){}},rejectChange:()=>{var w,m,x;if(!s||!n)return;const v=s.dataset.original;if(v)try{const M=((x=(m=(w=n.extensionManager.extensions.find(P=>P.name==="proofreadingDecoration"))==null?void 0:w.options)==null?void 0:m.suggestions)==null?void 0:x.filter(P=>P.original!==v))||[],L=n.extensionManager.extensions.find(P=>P.name==="proofreadingDecoration");L&&(L.options.suggestions=M,n.view.dispatch(n.state.tr)),o(null)}catch(M){}}}}var $n=Object.defineProperty,Ln=Object.defineProperties,On=Object.getOwnPropertyDescriptors,bt=Object.getOwnPropertySymbols,is=Object.prototype.hasOwnProperty,cs=Object.prototype.propertyIsEnumerable,zt=(n,s,o)=>s in n?$n(n,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[s]=o,Dt=(n,s)=>{for(var o in s||(s={}))is.call(s,o)&&zt(n,o,s[o]);if(bt)for(var o of bt(s))cs.call(s,o)&&zt(n,o,s[o]);return n},Ut=(n,s)=>Ln(n,On(s)),Mn=(n,s)=>{var o={};for(var y in n)is.call(n,y)&&s.indexOf(y)<0&&(o[y]=n[y]);if(n!=null&&bt)for(var y of bt(n))s.indexOf(y)<0&&cs.call(n,y)&&(o[y]=n[y]);return o},Gt=(n,s,o)=>new Promise((y,d)=>{var g=x=>{try{m(o.next(x))}catch(v){d(v)}},w=x=>{try{m(o.throw(x))}catch(v){d(v)}},m=x=>x.done?y(x.value):Promise.resolve(x.value).then(g,w);m((o=o.apply(n,s)).next())});He.setOptions({gfm:!0,breaks:!0,headerIds:!1,mangle:!1});const qt=[{label:"Arial",value:"font-arial"},{label:"Georgia",value:"font-georgia"},{label:"Mono",value:"font-mono"},{label:"Comic Sans",value:"font-comic"}],Rn=({blog:n,activeTab:s,setActiveTab:o,content:y,setContent:d,title:g,proofreadingResults:w,handleReplace:m,isSavingKeyword:x})=>{var v,M,L;const[P,O]=r.useState(!0),[Y,ne]=r.useState(qt[0].value),[je,he]=r.useState(!1),[ve,ie]=r.useState(!1),[re,fe]=r.useState(""),[N,Ne]=r.useState(""),[Q,V]=r.useState(""),[le,De]=r.useState(!1),[Ee,ae]=r.useState(!1),[Se,ge]=r.useState(null),[Be,Ae]=r.useState(!1),[$e,u]=r.useState(null),[_,K]=r.useState(null),[k,pe]=r.useState({from:0,to:0}),[j,Pe]=r.useState(!1),[Le,ye]=r.useState(null),[be,ce]=r.useState(!1),[Ue,Ge]=r.useState(null),[qe,_e]=r.useState(""),de=r.useRef(null),X=r.useRef(null),tt=r.useRef(null),[We,nt]=r.useState({top:0,left:0}),Oe=It(),{handlePopup:Me}=ss(),I=et(t=>t.auth.user),T=(M=I==null?void 0:I.plan)!=null?M:(v=I==null?void 0:I.subscription)==null?void 0:v.plan,ue=r.useRef(!1),B=ts(),me=r.useRef(null),Ce=B.pathname===`/blog-editor/${n==null?void 0:n._id}`,[jt,Re]=r.useState(!1),[G,Ie]=r.useState(null),vt=wt(),oe=(L=y!=null?y:n==null?void 0:n.content)!=null?L:"",Te=r.useCallback(t=>{if(!t)return"<p></p>";try{const a=He.parse(t),f=new DOMParser().parseFromString(a,"text/html");return f.querySelectorAll("script").forEach(S=>S.remove()),f.body.innerHTML}catch(a){return`<p>${t}</p>`}},[]),i=r.useCallback(t=>{if(!t)return"";try{const p=new DOMParser().parseFromString(t,"text/html");p.querySelectorAll("script").forEach(te=>te.remove());const f=p.body.innerHTML,S=new qs({strongDelimiter:"**",emDelimiter:"*",headingStyle:"atx",bulletListMarker:"-",codeDelimiter:"```",fence:"```",hr:"---"});return S.addRule("heading",{filter:["h1","h2","h3","h4","h5","h6"],replacement:function(te,ke){const se=parseInt(ke.nodeName.charAt(1));return`
`+"#".repeat(se)+" "+te+`

`}}),S.addRule("list",{filter:["ul","ol"],replacement:function(te,ke){return`
`+te+`
`}}),S.addRule("listItem",{filter:"li",replacement:function(te,ke){return(ke.parentNode.nodeName==="OL"?"1. ":"- ")+te.trim()+`
`}}),S.turndown(t)}catch(a){return t}},[]),h=r.useMemo(()=>oe?He.parse(oe,{gfm:!0}):"<p></p>",[oe]),l=Ts({extensions:[As.configure({heading:{levels:[1,2,3]},bold:{HTMLAttributes:{class:"font-bold"}}}),Hs.configure({HTMLAttributes:{class:"text-blue-600 underline"}}),Bs.configure({HTMLAttributes:{class:"rounded-lg mx-auto w-3/4 h-auto object-contain",style:"display: block;;"}}),Fs,Ks.configure({types:["heading","paragraph"]}),In.configure({suggestions:w})],content:h,onUpdate:({editor:t})=>{const a=t.getHTML(),p=i(a);p!==oe&&(d(p),ce(!0))},editorProps:{attributes:{class:`prose max-w-none focus:outline-none p-4 min-h-[400px] opacity-100 ${Y} blog-content editor-container`}},onSelectionUpdate:({editor:t})=>{const{from:a,to:p}=t.state.selection;pe({from:a,to:p})}},[Y,w,i,d]),{activeSpan:C,bubbleRef:$,applyChange:A,rejectChange:F}=En(l);r.useEffect(()=>{(()=>{if(s==="Normal"&&l){const a=l.view.dom;a&&(a.scrollTop=0)}else if(s==="Markdown"){const a=X.current;a&&(a.scrollTop=0)}else if(s==="HTML"){const a=de.current;a&&(a.scrollTop=0)}})()},[s,l]),r.useEffect(()=>{O(!0);const t=setTimeout(()=>{O(!1),l&&s==="Normal"&&l.commands.focus()},300);return()=>clearTimeout(t)},[s,l]),r.useEffect(()=>{(n==null?void 0:n.status)==="failed"&&!ue.current&&(c.error("Your blog generation failed. You can write blog manually."),ue.current=!0)},[n==null?void 0:n.status]),r.useEffect(()=>{const t=document.createElement("style");return t.id="text-editor-styles",t.textContent=`
      .font-arial { font-family: Arial, sans-serif; }
      .font-georgia { font-family: Georgia, serif; }
      .font-mono { font-family: 'SF Mono', monospace; }
      .font-comic { font-family: "Comic Sans MS", cursive; }
      .bubble-menu {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        padding: 0.25rem;
        display: flex;
        gap: 0.25rem;
        z-index: 50;
      }
      .suggestion-highlight {
        background: #fefcbf;
        cursor: pointer;
      }
      .editor-container {
        width: 100% !important;
        background: white;
      }
      .editor-container h1 {
        font-size: 1.5rem;
      }
      .editor-container h2 {
        font-size: 1.25rem;
      }
      .editor-container h3 {
        font-size: 1rem;
      }
      .editor-container ul, .editor-container ol {
        margin: 1rem 0;
        padding-left: 1.5rem;
      }
      .editor-container ul {
        list-style-type: disc;
      }
      .editor-container ol {
        list-style-type: decimal;
      }
      .editor-container li {
        margin: 0.5rem 0;
      }
      .editor-container p {
        color: #374151;
      }
      .editor-container strong {
        font-weight: bold;
        color: #1f2937;
      }
      .editor-container em {
        font-style: italic;
      }
      .editor-container a {
        color: #2563eb;
        text-decoration: underline;
        position: relative;
      }
      .editor-container a:hover {
        color: #1d4ed8;
      }
      .editor-container img {
        display: block;
        margin: 1.5rem auto;
        max-width: 100%;
        height: auto;
        border-radius: 0.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .editor-tab {
        padding: 0.75rem 1.5rem;
        font-weight: 500;
        border-bottom: 2px solid transparent;
        color: #6b7280;
        transition: all 0.2s ease;
        cursor: pointer;
      }
      .editor-tab:hover {
        color: #3b82f6;
        background: #f8fafc;
      }
      .editor-tab.active {
        color: #3b82f6;
        border-bottom-color: #3b82f6;
        background: white;
      }
      .code-textarea {
        font-family: 'SF Mono', monospace;
        font-size: 14px;
        border: none;
        outline: none;
        resize: none;
        background: #f8fafc;
        color: #1f2937;
        padding: 1.5rem;
        border-radius: 0.5rem;
        white-space: pre-wrap;
      }
      .code-textarea:focus {
        background: white;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
      }
      .suggestion-tooltip {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 0.5rem;
        padding: 0.75rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        z-index: 60;
        max-width: 300px;
        font-size: 0.875rem;
      }
      .proof-ui-bubble {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 0.5rem;
        padding: 0.5rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        z-index: 60;
      }
    `,document.head.appendChild(t),()=>{const a=document.getElementById("text-editor-styles");a&&a.parentNode&&a.parentNode.removeChild(a)}},[]),r.useEffect(()=>{if(l&&s==="Normal"&&!l.isDestroyed){const t=l.getHTML(),a=Te(oe);if(t!==a){const{from:p,to:f}=l.state.selection;l.commands.setContent(a,!1),l.commands.setTextSelection({from:p,to:f})}}},[oe,s,l,Te]),r.useEffect(()=>{if(l){const t=l.extensionManager.extensions.find(a=>a.name==="proofreadingDecoration");t&&(t.options.suggestions=w,l.view.dispatch(l.view.state.tr))}},[w,l]),r.useEffect(()=>{if(l)return ae(!0),()=>{l.isDestroyed||l.destroy()}},[l]),r.useEffect(()=>{s==="HTML"&&!le&&requestAnimationFrame(()=>Ws.highlightAll())},[oe,s,le]),r.useEffect(()=>{var t;const a=(t=n==null?void 0:n.content)!=null?t:"";if(oe!==a&&d(a),l&&!l.isDestroyed&&s==="Normal"){const p=a?He.parse(a,{gfm:!0}):"<p></p>";if(l.getHTML()!==p){const{from:f,to:S}=l.state.selection;l.commands.setContent(p,!1),l.commands.setTextSelection({from:f,to:S})}}},[n,l,s,d]),r.useEffect(()=>{s==="HTML"&&_e(Te(oe).replace(/>\s*</g,`>
<`))},[oe,s,Te]),r.useEffect(()=>{const t=a=>{tt.current&&!tt.current.contains(a.target)&&setShowModelDropdown(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),r.useLayoutEffect(()=>{if(C instanceof HTMLElement&&$.current){const t=C.getBoundingClientRect(),a=$.current.offsetHeight,p=t.top+window.scrollY-a-8,f=t.left+window.scrollX;nt({top:p,left:f})}},[C]);const Fe=()=>{Me({title:"Upgrade Required",description:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Editing blogs is only available for Pro and Enterprise users."}),e.jsx("br",{}),e.jsx("span",{children:"Upgrade your plan to unlock this feature."})]}),confirmText:"Buy Now",cancelText:"Cancel",onConfirm:()=>Oe("/pricing")})},E=r.useCallback(t=>{if(T==="free"||T==="basic"){Fe();return}t()},[T,Me,Oe]),we=r.useCallback(()=>{if(!l||l.state.selection.empty){c.error("Select text to link.");return}E(()=>{fe(""),he(!0)})},[l,E]),J=r.useCallback(()=>{E(()=>{Ne(""),V(""),ie(!0)})},[E]),st=()=>{Me(T==="free"||T==="basic"?{title:"Upgrade Required",description:"Rewrite is only available for Pro and Enterprise users.",confirmText:"Buy Now",cancelText:"Cancel",onConfirm:()=>Oe("/pricing")}:{title:"Retry Blog Generation",description:`Are you sure you want to retry generating this blog?
It will be of 10 credits`,onConfirm:W})},Ye=r.useCallback(()=>{if(!re||!/https?:\/\//i.test(re)){c.error("Enter a valid URL.");return}if(l){const{from:t,to:a}=l.state.selection;l.chain().focus().setLink({href:re,target:"_blank",rel:"noopener noreferrer"}).setTextSelection({from:t,to:a}).run(),he(!1),c.success("Link added.")}},[re,l]),b=r.useCallback((t,a,p)=>{const f=p.current;if(!f)return;const S=f.selectionStart,U=f.selectionEnd,te=f.value.substring(S,U),ke=`${t}${te}${a}`,se=f.value.substring(0,S)+ke+f.value.substring(U);d(se),ce(!0),requestAnimationFrame(()=>{const Ze=S+t.length+te.length;f.setSelectionRange(Ze,Ze),f.focus()})},[d]),z=r.useCallback(()=>{if(!N||!/https?:\/\//i.test(N)){c.error("Enter a valid image URL.");return}if(N.includes("<script")||N.includes("<\/script")){c.error("Script tags are not allowed in image URLs.");return}if(s==="Normal"&&l){const{from:t}=l.state.selection;l.chain().focus().setImage({src:N,alt:Q}).setTextSelection(t).run(),ie(!1),c.success("Image added.")}else if(s==="Markdown"){const t=`![${Q}](${N})`;b(t,"",X),ie(!1),c.success("Image added.")}else if(s==="HTML"){const t=`<img src="${N}" alt="${Q}" />`;b(t,"",de),ie(!1),c.success("Image added.")}},[N,Q,l,s,b]),q=r.useCallback(t=>{const a=t.target;if(a.selectionStart!==a.selectionEnd){const p=a.getBoundingClientRect(),f=window.pageYOffset||document.documentElement.scrollTop;ge({top:p.top+f-40,left:p.left+10})}else ge(null)},[]),H=()=>Gt(null,null,function*(){if(!(n!=null&&n._id)){c.error("Blog ID is missing.");return}if(!l&&s==="Normal"){c.error("Editor is not initialized.");return}let t,a,p;if(s==="Normal"){const S=l.state.selection;if(a=S.from,p=S.to,a===p){c.error("Please select some text to retry.");return}t=l.state.doc.textBetween(a,p,`
`)}else{const U=(s==="Markdown"?X:de).current;if(!U){c.error("Editor is not initialized.");return}if(a=U.selectionStart,p=U.selectionEnd,a===p){c.error("Please select some text to retry.");return}t=U.value.substring(a,p)}K(t),pe({from:a,to:p});const f={contentPart:t.trim()};l&&l.commands.blur();try{Ae(!0);const S=yield ns(n._id,f);S.data?(u(S.data),Pe(!0)):c.error("No content received from retry.")}catch(S){c.error(S.message||"Retry failed.")}finally{Ae(!1)}}),W=()=>Gt(null,null,function*(){if(!(n!=null&&n._id)){c.error("Blog ID is missing.");return}const t={createNew:!0};try{yield vt(Cs({id:n._id,payload:t})),Oe("/blogs")}catch(a){c.error(a.message||"Retry failed.")}}),lt=()=>{if($e){if(s==="Normal"&&l){const t=Te($e);l.chain().focus().deleteRange({from:k.from,to:k.to}).insertContentAt(k.from,t).setTextSelection({from:k.from,to:k.from+t.length}).run()}else{const a=(s==="Markdown"?X:de).current;d(p=>{const f=p.substring(0,k.from)+$e+p.substring(k.to);return a&&requestAnimationFrame(()=>{a.setSelectionRange(k.from,k.from+$e.length),a.focus()}),f})}c.success("Selected lines replaced successfully!"),Pe(!1),u(null),K(null),pe({from:0,to:0}),ce(!0)}},ds=()=>{Pe(!1),u(null),K(null),pe({from:0,to:0}),c.info("Retry content discarded.")},Nt=r.useCallback(t=>{if(t.target.tagName==="IMG"){const{src:a,alt:p}=t.target;Ie({src:a,alt:p||""}),V(p||""),Re(!0)}},[]);r.useEffect(()=>{var t;if(((t=n==null?void 0:n.images)==null?void 0:t.length)>0){let a=oe;(oe.match(/{Image:.*?}/g)||[]).forEach((f,S)=>{const U=n.images[S];U!=null&&U.url&&(a=a.replace(f,`![${U.alt||"Image"}](${U.url})`))}),d(a)}},[n,oe,d]);const us=r.useCallback(()=>{if(G){if(s==="Normal"&&l){let t=!1;l.state.doc.descendants((a,p)=>{a.type.name==="image"&&a.attrs.src===G.src&&(l.chain().focus().deleteRange({from:p,to:p+1}).run(),t=!0)}),t?(c.success("Image deleted."),Re(!1),Ie(null),V(""),ce(!0)):c.error("Failed to delete image.")}else if(s==="Markdown"){const t=new RegExp(`!\\[${Ve(G.alt||"")}\\]\\(${Ve(G.src)}\\)`,"g");d(a=>{const p=a.replace(t,"");return ce(!0),p}),c.success("Image deleted."),Re(!1),Ie(null),V("")}else if(s==="HTML"){const t=new RegExp(`<img\\s+src="${Ve(G.src)}"\\s+alt="${Ve(G.alt||"")}"\\s*/>`,"g");d(a=>{const f=Te(a).replace(t,""),S=i(f);return ce(!0),S}),c.success("Image deleted."),Re(!1),Ie(null),V("")}}},[G,l,s,d,Te,i]);r.useEffect(()=>{if(l&&s==="Normal"){const t=l.view.dom;return t.addEventListener("click",Nt),()=>{t.removeEventListener("click",Nt)}}},[l,s,Nt]);const $t=r.useCallback(()=>{if(!G||!Q){c.error("Alt text is required.");return}if(s==="Normal"&&l){let t=!1;l.state.doc.descendants((a,p)=>{a.type.name==="image"&&a.attrs.src===G.src&&(l.chain().focus().setNodeSelection(p).setImage({src:G.src,alt:Q}).run(),t=!0)}),t?(c.success("Image alt text updated."),Re(!1),Ie(null),V(""),ce(!0)):c.error("Failed to update image alt text.")}else if(s==="Markdown"){const t=new RegExp(`!\\[${Ve(G.alt||"")}\\]\\(${Ve(G.src)}\\)`,"g"),a=`![${Q}](${G.src})`;d(p=>{const f=p.replace(t,a);return ce(!0),f}),c.success("Image alt text updated."),Re(!1),Ie(null),V("")}else if(s==="HTML"){const t=new RegExp(`<img\\s+src="${Ve(G.src)}"\\s+alt="${Ve(G.alt||"")}"\\s*/>`,"g"),a=`<img src="${G.src}" alt="${Q}" />`;d(p=>{const S=Te(p).replace(t,a),U=i(S);return ce(!0),U}),c.success("Image alt text updated."),Re(!1),Ie(null),V("")}},[G,Q,l,s,d,Te,i]),Ve=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ms=r.useCallback(t=>{be?Ge(t):o(t)},[be,o]),xs=r.useCallback(()=>{ce(!1),o(Ue),Ge(null)},[Ue,o]),ps=r.useCallback(()=>{Ge(null)},[]),hs=t=>!!new DOMParser().parseFromString(t,"text/html").querySelector("script"),fs=r.useCallback(t=>{const a=t.target.files[0];if(!a)return;const p=s==="Markdown"&&a.name.endsWith(".md"),f=s==="HTML"&&a.name.endsWith(".html");if(!p&&!f){c.error(`Please upload a ${s==="Markdown"?".md":".html"} file.`);return}const S=new FileReader;S.onload=U=>{let te=U.target.result;if(f&&hs(te)){c.error("Script tags are not allowed in imported HTML content for security reasons.");return}d(te),ce(!0),c.success(`${a.name} imported successfully!`)},S.onerror=()=>{c.error("Failed to read the file.")},S.readAsText(a),t.target.value=null},[s,d]),Lt=({editorRef:t,mode:a})=>{if(!Se||!t.current)return null;const p={Markdown:[{icon:e.jsx(at,{className:"w-4 h-4"}),action:()=>E(()=>b("**","**",t))},{icon:e.jsx(ot,{className:"w-4 h-4"}),action:()=>E(()=>b("*","*",t))},{icon:e.jsx(rt,{className:"w-4 h-4"}),action:()=>E(()=>b("[","](url)",t))},{icon:e.jsx(Je,{className:"w-4 h-4"}),action:J}],HTML:[{icon:e.jsx(at,{className:"w-4 h-4"}),action:()=>E(()=>b("<strong>","</strong>",t))},{icon:e.jsx(ot,{className:"w-4 h-4"}),action:()=>E(()=>b("<em>","</em>",t))},{icon:e.jsx(rt,{className:"w-4 h-4"}),action:()=>E(()=>b('<a href="url">',"</a>",t))},{icon:e.jsx(Je,{className:"w-4 h-4"}),action:J}]};return e.jsx(D.div,{className:"absolute flex gap-2 bg-white shadow-lg p-2 rounded border z-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},style:Se,children:p[a].map((f,S)=>e.jsx(R,{title:f.icon.type.name,children:e.jsx("button",{onClick:f.action,className:"p-1 rounded hover:bg-gray-100",children:f.icon})},S))})},gs=r.useCallback(t=>t.trim().startsWith("<!DOCTYPE html>")||t.trim().startsWith("<html"),[]),ys=()=>{Me(T==="free"||T==="basic"?{title:"Upgrade Required",description:"Rewrite is only available for Pro and Enterprise users.",confirmText:"Buy Now",cancelText:"Cancel",onConfirm:()=>Oe("/pricing")}:{title:"Rewrite Selected Lines",description:"Do you want to rewrite the selected lines? You can rewrite only 3 times.",onConfirm:H})},bs=()=>e.jsxs("div",{className:"bg-white border-x border-gray-200 shadow-sm px-4 py-2 flex items-center",children:[e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(t=>e.jsx(R,{title:`Heading ${t}`,children:e.jsxs("button",{onClick:()=>E(()=>{s==="Normal"?l.chain().focus().toggleHeading({level:t}).run():s==="HTML"?b(`<h${t}>`,`</h${t}>`,de):b(`${"#".repeat(t)} `,"",X)}),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${s==="Normal"&&(l!=null&&l.isActive("heading",{level:t}))?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":`Heading ${t}`,type:"button",children:[t===1&&e.jsx(en,{className:"w-4 h-4"}),t===2&&e.jsx(At,{className:"w-4 h-4"}),t===3&&e.jsx(tn,{className:"w-4 h-4"})]})},t))}),e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-2"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{title:"Bold",children:e.jsx("button",{onClick:()=>E(()=>{s==="Normal"?l.chain().focus().toggleBold().run():s==="HTML"?b("<strong>","</strong>",de):b("**","**",X)}),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${s==="Normal"&&(l!=null&&l.isActive("bold"))?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":"Bold",type:"button",children:e.jsx(at,{className:"w-4 h-4"})})}),e.jsx(R,{title:"Italic",children:e.jsx("button",{onClick:()=>E(()=>{s==="Normal"?l.chain().focus().toggleItalic().run():s==="HTML"?b("<em>","</em>",de):b("*","*",X)}),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${s==="Normal"&&(l!=null&&l.isActive("italic"))?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":"Italic",type:"button",children:e.jsx(ot,{className:"w-4 h-4"})})}),e.jsx(R,{title:"Underline",children:e.jsx("button",{onClick:()=>E(()=>{s==="Normal"?l.chain().focus().toggleUnderline().run():s==="HTML"?b("<u>","</u>",de):b("<u>","</u>",X)}),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${s==="Normal"&&(l!=null&&l.isActive("underline"))?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":"Underline",type:"button",children:e.jsx(sn,{className:"w-4 h-4"})})})]}),e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-2"}),e.jsx("div",{className:"flex gap-1",children:["left","center"," personally"].map(t=>e.jsx(R,{title:`Align ${t}`,children:e.jsxs("button",{onClick:()=>E(()=>{s==="Normal"?l.chain().focus().setTextAlign(t).run():b(`<div style="text-align: ${t};">`,"</div>",s==="HTML"?de:X)}),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${s==="Normal"&&(l!=null&&l.isActive({textAlign:t}))?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":`Align ${t}`,type:"button",children:[t==="left"&&e.jsx(nn,{className:"w-4 h-4"}),t==="center"&&e.jsx(rn,{className:"w-4 h-4"}),t==="right"&&e.jsx(ln,{className:"w-4 h-4"})]})},t))}),e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-2"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{title:"Bullet List",children:e.jsx("button",{onClick:()=>E(()=>{s==="Normal"?l.chain().focus().toggleBulletList().run():s==="HTML"?b(`<ul>
<li>`,`</li>
</ul>`,de):b("- ","",X)}),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${s==="Normal"&&(l!=null&&l.isActive("bulletList"))?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":"Bullet List",type:"button",children:e.jsx(an,{className:"w-4 h-4"})})}),e.jsx(R,{title:"Ordered List",children:e.jsx("button",{onClick:()=>E(()=>{s==="Normal"?l.chain().focus().toggleOrderedList().run():s==="HTML"?b(`<ol>
<li>`,`</li>
</ol>`,de):b("1. ","",X)}),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${s==="Normal"&&(l!=null&&l.isActive("orderedList"))?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":"Ordered List",type:"button",children:e.jsx(on,{className:"w-4 h-4"})})})]}),e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-2"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(R,{title:"Link",children:e.jsx("button",{onClick:we,className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Link",type:"button",children:e.jsx(rt,{className:"w-4 h-4"})})}),e.jsx(R,{title:"Image",children:e.jsx("button",{onClick:J,className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Image",type:"button",children:e.jsx(Je,{className:"w-4 h-4"})})}),e.jsx(R,{title:"Undo",children:e.jsx("button",{onClick:()=>E(()=>l==null?void 0:l.chain().focus().undo().run()),className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Undo",type:"button",children:e.jsx(cn,{className:"w-4 h-4"})})}),e.jsx(R,{title:"Redo",children:e.jsx("button",{onClick:()=>E(()=>l==null?void 0:l.chain().focus().redo().run()),className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Redo",type:"button",children:e.jsx(dn,{className:"w-4 h-4"})})}),!Ce&&e.jsx(R,{title:"Rewrite",children:e.jsx("button",{onClick:()=>E(()=>{Me({title:"Rewrite Selected Lines",description:"Do you want to rewrite the selected lines? You can rewrite only 3 times.",onConfirm:H})}),className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Rewrite",type:"button",children:e.jsx(Ht,{className:"w-4 h-4"})})}),e.jsx(R,{title:"Copy",children:e.jsx("button",{onClick:()=>E(()=>{navigator.clipboard.writeText(s==="HTML"?qe:oe),c.success("Content copied to clipboard!")}),className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Copy",type:"button",children:e.jsx(un,{className:"w-4 h-4"})})}),!Ce&&e.jsx(R,{title:"Regenerate Content",children:e.jsx("button",{onClick:st,className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Regenerate",type:"button",children:e.jsx(Vs,{className:"w-4 h-4"})})}),(s==="Markdown"||s==="HTML")&&e.jsx(R,{title:`Import ${s==="Markdown"?".md":".html"} File`,children:e.jsx("button",{onClick:()=>{var t;return(t=me.current)==null?void 0:t.click()},className:"p-2 rounded-md hover:bg-gray-100 transition-colors duration-150 flex items-center justify-center","aria-label":"Import File",type:"button",children:e.jsx(mn,{className:"w-4 h-4"})})})]}),(s==="Markdown"||s==="HTML")&&e.jsx("input",{type:"file",ref:me,style:{display:"none"},accept:s==="Markdown"?".md":".html",onChange:fs}),e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-2"}),e.jsx(Ke,{value:Y,onChange:t=>E(()=>ne(t)),className:"w-32","aria-label":"Font",children:qt.map(t=>e.jsx(Ke.Option,{value:t.value,children:t.label},t.value))}),(s==="Markdown"||s==="HTML")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-2"}),e.jsx(R,{title:le?"Hide Preview":"Show Preview",children:e.jsx("button",{onClick:()=>De(!le),className:`p-2 rounded-md transition-colors duration-150 flex items-center justify-center ${le?"bg-blue-100 text-blue-600":"hover:bg-gray-100"}`,"aria-label":"Toggle Preview",type:"button",children:le?e.jsx(xn,{className:"w-4 h-4"}):e.jsx(Et,{className:"w-4 h-4"})})})]})]}),ws=()=>{if(P||!Ee||(n==null?void 0:n.status)==="pending")return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-300px)] bg-white border rounded-lg",children:e.jsx(_t,{})});if(le&&(s==="Markdown"||s==="HTML")){if(s==="HTML"&&gs(qe)){const t=rs.sanitize(qe,{USE_PROFILES:{html:!0},ADD_TAGS:["style"],ADD_ATTR:["target"]});return e.jsx("div",{className:`p-8 rounded-lg rounded-t-none overflow-y-auto custom-scroll h-screen border border-gray-200 ${Y}`,children:e.jsx("iframe",{srcDoc:t,title:"HTML Preview",sandbox:"allow-same-origin"})})}return e.jsx("div",{className:`p-8 rounded-lg rounded-t-none overflow-y-auto custom-scroll h-screen border border-gray-200 bg-white ${Y}`,children:e.jsx(mt,{remarkPlugins:[pt],rehypePlugins:[xt],components:{a:({href:t,children:a})=>e.jsx(R,{title:t,placement:"top",children:e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:a})}),img:({src:t,alt:a})=>e.jsx("img",{src:t,alt:a,className:"rounded-lg mx-auto my-3 w-3/4 h-auto shadow-sm"}),h1:({children:t})=>e.jsx("h1",{className:"text-2xl font-bold",children:t}),h2:({children:t})=>e.jsx("h2",{className:"text-xl font-semibold",children:t}),h3:({children:t})=>e.jsx("h3",{className:"text-lg font-medium",children:t}),p:({children:t})=>e.jsx("p",{className:"mb-4 leading-relaxed text-gray-700",children:js.Children.map(t,(a,p)=>{if(typeof a=="string"){let f=a,S=[],U=0;const te=[...w].sort((ke,se)=>se.original.length-ke.original.length);for(;f.length>0;){let ke=!1;for(const se of te){const Ze=new RegExp(se.original.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),Qe=f.match(Ze);if(Qe&&Qe.index===0){S.push(e.jsxs("span",{className:"suggestion-highlight",onMouseEnter:()=>ye(se),onMouseLeave:()=>ye(null),children:[Qe[0],Le===se&&e.jsxs("div",{className:"suggestion-tooltip",style:{top:"100%",left:0},children:[e.jsxs("p",{className:"text-sm mb-2",children:[e.jsx("strong",{children:"Suggested:"})," ",se.change]}),e.jsx("button",{className:"bg-blue-600 text-white px-2 py-1 rounded",onClick:()=>m(se.original,se.change),children:"Replace"})]})]},`${p}-${U++}`)),f=f.slice(Qe[0].length),ke=!0;break}}if(!ke){let se=f.length;for(const Ze of te){const Qe=new RegExp(Ze.original.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),Ct=f.match(Qe);Ct&&Ct.index<se&&(se=Ct.index)}se===f.length?(S.push(e.jsx("span",{children:f},`${p}-${U++}`)),f=""):(S.push(e.jsx("span",{children:f.slice(0,se)},`${p}-${U++}`)),f=f.slice(se))}}return S}return a})}),ul:({children:t})=>e.jsx("ul",{className:"list-disc list-inside mb-4 space-y-2 text-gray-700",children:t}),ol:({children:t})=>e.jsx("ol",{className:"list-decimal list-inside mb-4 space-y-2 text-gray-700",children:t}),li:({children:t})=>e.jsx("li",{className:"leading-relaxed",children:t}),code:t=>{var a=t,{node:p,inline:f,className:S,children:U}=a,te=Mn(a,["node","inline","className","children"]);const ke=/language-(\w+)/.exec(S||"");return!f&&ke?e.jsx("pre",{className:"bg-gray-800 text-white p-4 rounded-lg",children:e.jsx("code",Ut(Dt({className:S},te),{children:U}))}):e.jsx("code",Ut(Dt({className:"bg-gray-100 text-red-600 px-1 rounded"},te),{children:U}))}},children:oe})})}return e.jsxs("div",{className:"bg-white border rounded-lg rounded-t-none shadow-sm",children:[s==="Normal"&&e.jsxs("div",{className:"h-screen overflow-auto custom-scroll",children:[l&&e.jsxs(zs,{editor:l,tippyOptions:{duration:100},className:"flex gap-2 bg-white shadow-lg p-2 rounded-lg border border-gray-200",children:[e.jsx(R,{title:"Bold",placement:"top",children:e.jsx("button",{className:"p-2 rounded hover:bg-gray-200 text-gray-600",onClick:()=>{E(()=>{l.chain().focus().toggleBold().run()})},children:e.jsx(at,{className:"w-5 h-5"})})}),e.jsx(R,{title:"Italic",placement:"top",children:e.jsx("button",{className:"p-2 rounded hover:bg-gray-200 text-gray-600",onClick:()=>{E(()=>{l.chain().focus().toggleItalic().run()})},children:e.jsx(ot,{className:"w-5 h-5"})})}),e.jsx(R,{title:"Heading",placement:"top",children:e.jsx("button",{className:"p-2 rounded hover:bg-gray-200 text-gray-600",onClick:()=>{E(()=>{l.chain().focus().toggleHeading({level:2}).run()})},children:e.jsx(At,{className:"w-5 h-5"})})}),e.jsx(R,{title:"Link",placement:"top",children:e.jsx("button",{className:"p-2 rounded hover:bg-gray-200 text-gray-600",onClick:we,children:e.jsx(rt,{className:"w-5 h-5"})})}),e.jsx(R,{title:"Image",placement:"top",children:e.jsx("button",{className:"p-2 rounded hover:bg-gray-200 text-gray-600",onClick:J,children:e.jsx(Je,{className:"w-5 h-5"})})}),!Ce&&e.jsx(R,{title:"Rewrite",placement:"top",children:e.jsx("button",{className:"p-2 rounded hover:bg-gray-200 text-gray-600",onClick:ys,children:e.jsx(Ht,{className:"w-4 h-4"})})})]}),e.jsx(Ds,{editor:l}),C instanceof HTMLElement&&e.jsxs("div",{className:"proof-ui-bubble",ref:$,style:{position:"absolute",top:We.top,left:We.left},children:[e.jsxs("div",{style:{marginBottom:4},children:["Replace with: ",e.jsx("strong",{children:C.dataset.suggestion})]}),e.jsx("button",{onClick:A,children:"✅ Accept"}),e.jsx("button",{onClick:F,style:{marginLeft:6},children:"❌ Reject"})]})]}),s==="Markdown"&&e.jsxs("div",{className:"h-screen",children:[e.jsx("textarea",{ref:X,value:oe,onChange:t=>{d(t.target.value),ce(!0)},onMouseUp:q,onKeyUp:q,className:`w-full h-full p-4 text-sm focus:outline-none resize-none bg-white code-textarea custom-scroll ${Y}`,placeholder:"Enter Markdown here...\\nUse # for headings, **bold**, *italic*, - for lists",style:{whiteSpace:"pre-wrap",lineHeight:"1.5"}}),e.jsx(Lt,{editorRef:X,mode:"Markdown"})]}),s==="HTML"&&e.jsxs("div",{className:"h-screen",children:[e.jsx("textarea",{ref:de,value:qe,onChange:t=>{d(t.target.value),ce(!0)},onMouseUp:q,onKeyUp:q,className:"w-full h-full font-mono text-sm p-4 focus:outline-none resize-none bg-white code-textarea custom-scroll",placeholder:"<h1>HTML Title</h1>\\n<p>Paragraph with <a href='https://example.com'>link</a></p>\\n<img src='image.jpg' alt='description' />",style:{whiteSpace:"pre-wrap",lineHeight:"1.5"}}),e.jsx(Lt,{editorRef:de,mode:"HTML"})]})]})};return e.jsxs(D.div,{className:"flex-1 bg-gray-50",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[(Be||x)&&e.jsx(D.div,{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},children:e.jsx(_t,{})}),j&&e.jsx(D.div,{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Generated Content"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Original Text"}),e.jsx("div",{className:"p-4 bg-gray-100 rounded-md",children:e.jsx(mt,{remarkPlugins:[pt],rehypePlugins:[xt],className:"prose",components:{a:({href:t,children:a})=>e.jsx(R,{title:t,placement:"top",children:e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:a})}),strong:({children:t})=>e.jsx("strong",{className:"font-bold",children:t})},children:_||"No text selected"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Improved Text"}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-md",children:e.jsx(mt,{remarkPlugins:[pt],rehypePlugins:[xt],className:"prose",components:{a:({href:t,children:a})=>e.jsx(R,{title:t,placement:"top",children:e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:a})}),strong:({children:t})=>e.jsx("strong",{className:"font-bold",children:t})},children:$e})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{onClick:ds,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Reject"}),e.jsx("button",{onClick:lt,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Accept"})]})]})}),Ue&&e.jsx(ze,{title:"Unsaved Changes",open:!0,onOk:xs,onCancel:ps,okText:"Continue without Saving",cancelText:"Cancel",centered:!0,children:e.jsx("p",{className:"text-sm text-gray-600",children:"You have unsaved changes. Switching tabs may cause you to lose your work. Are you sure you want to continue?"})}),!Ce&&e.jsx("div",{className:"flex border-b bg-white shadow-sm border-x",children:["Normal","Markdown","HTML"].map(t=>e.jsx("button",{onClick:()=>ms(t),className:`editor-tab ${s===t?"active":""}`,children:t},t))}),bs(),ws(),e.jsxs(ze,{title:"Insert Link",open:je,onOk:Ye,onCancel:()=>he(!1),okText:"Insert Link",cancelText:"Cancel",centered:!0,children:[e.jsx(Xe,{value:re,onChange:t=>fe(t.target.value),placeholder:"https://example.com",className:"w-full mt-4",prefix:e.jsx(rt,{className:"w-4 h-4 text-gray-400"})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Include http:// or https://"})]}),e.jsxs(ze,{title:"Edit Image Alt Text",open:jt,onOk:$t,onCancel:()=>{Re(!1),Ie(null),V("")},okText:"Update Alt Text",cancelText:"Cancel",footer:[e.jsx(xe,{onClick:us,danger:!0,icon:e.jsx(Js,{className:"w-4 h-4"}),children:"Delete Image"},"delete"),e.jsx(xe,{onClick:()=>{Re(!1),Ie(null),V("")},children:"Cancel"},"cancel"),e.jsx(xe,{type:"primary",onClick:$t,children:"Update Alt Text"},"ok")],centered:!0,children:[e.jsx(Xe,{value:Q,onChange:t=>V(t.target.value),placeholder:"Image description",className:"w-full mt-4",prefix:e.jsx(Je,{className:"w-4 h-4 text-gray-400"})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Provide alt text for accessibility"}),G&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:G.src,alt:Q||G.alt,className:"max-w-full h-auto rounded-lg"})})]}),e.jsxs(ze,{title:"Insert Image",open:ve,onOk:z,onCancel:()=>ie(!1),okText:"Insert Image",cancelText:"Cancel",centered:!0,children:[e.jsx(Xe,{value:N,onChange:t=>Ne(t.target.value),placeholder:"https://example.com/image.jpg",className:"w-full mt-4",prefix:e.jsx(Je,{className:"w-4 h-4 text-gray-400"})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Include http:// or https://"}),e.jsx(Xe,{value:Q,onChange:t=>V(t.target.value),placeholder:"Image description",className:"w-full mt-4",prefix:e.jsx(Je,{className:"w-4 h-4 text-gray-400"})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Provide alt text for accessibility"})]})]})},Tn=["Blogging","Technology","Lifestyle","Travel","Food & Drink","Health & Wellness","Fashion","Business","Education","Entertainment","Photography","Fitness","Marketing","Finance","DIY & Crafts"],An=({isCategoryModalOpen:n,setIsCategoryModalOpen:s,onSubmit:o,initialCategory:y="",initialIncludeTableOfContents:d=!1})=>{const[g,w]=r.useState(""),[m,x]=r.useState(y),[v,M]=r.useState(d),[L,P]=r.useState(!1),{categories:O,error:Y}=et(N=>N.wordpress),ne=r.useCallback(N=>{if(m){c.error("Only one category can be selected.");return}x(N),P(!1)},[m]),je=r.useCallback(()=>{x(""),P(!1)},[]),he=r.useCallback(()=>{if(g.trim()){if(m===g.trim()){c.error("Category already selected.");return}x(g.trim()),w(""),P(!1)}},[g,m]);r.useCallback(N=>{N.key==="Enter"&&(N.preventDefault(),he())},[he]);const ve=r.useCallback(N=>{M(N.target.checked)},[]),ie=r.useCallback(()=>{if(!m){P(!0),c.error("Please select a category.");return}o({category:m,includeTableOfContents:v}),s(!1),x(""),M(!1),w(""),P(!1)},[m,v,o,s]),re=r.useCallback(()=>{s(!1),x(""),M(!1),w(""),P(!1)},[s]),fe=r.useCallback(N=>{if(N.length>1){c.error("Only one category can be selected.");return}const Ne=N.length>0?N[0]:"";x(Ne),P(!1)},[]);return e.jsx(ze,{title:"Select Category",open:n,onCancel:re,footer:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(xe,{onClick:re,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-label":"Cancel category selection",children:"Cancel"}),e.jsx(xe,{type:"primary",onClick:ie,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500","aria-label":"Confirm category selection",children:"Confirm"})]}),centered:!0,width:600,children:e.jsxs("div",{className:"p-3 space-y-4",children:[e.jsx(ft,{children:m&&e.jsxs(D.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex items-center gap-2 px-3 py-1.5 bg-blue-500 text-white rounded-full text-sm w-fit",children:[e.jsx("span",{className:"truncate max-w-[150px]",children:m}),e.jsx(D.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:je,className:"text-white hover:text-gray-200","aria-label":`Remove category ${m}`,children:e.jsx(gt,{size:15})})]})}),!Y&&(O==null?void 0:O.length)>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Auto-Generated Categories"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 overflow-y-auto p-3 rounded-md border border-indigo-200 bg-indigo-50 max-h-96",children:O.map(N=>e.jsxs(D.div,{onClick:()=>ne(N.name),whileHover:{scale:1.02,backgroundColor:"#e0e7ff"},className:`flex items-center justify-between p-3 rounded-md bg-white border ${L&&!m?"border-red-500":"border-indigo-200"} text-sm font-medium cursor-pointer transition-all duration-200 ${m===N.name?"bg-indigo-100 border-indigo-400":m?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("span",{className:"truncate",children:N.name}),!m&&e.jsx(D.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"text-indigo-600 hover:text-indigo-700","aria-label":`Add category ${N.name}`,children:e.jsx(yt,{size:16})})]},N.id||N.name))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Select or Add Category"}),e.jsx(Ke,{mode:"tags",placeholder:"Select or type a category",value:m?[m]:[],onChange:fe,className:"w-full",allowClear:!0,showSearch:!0,filterOption:(N,Ne)=>Ne.label.toLowerCase().includes(N.toLowerCase()),options:Tn.map(N=>({value:N,label:N})),dropdownStyle:{borderRadius:"8px"},popupClassName:"rounded-lg","aria-label":"Select or add a category"}),L&&!m&&e.jsx(D.p,{initial:{opacity:0},animate:{opacity:1},className:"mt-2 text-sm text-red-500",children:"Please select a category"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Include Table of Contents",e.jsx("p",{className:"text-xs text-gray-500",children:"Generate a table of contents for each blog."})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"includeTableOfContents",checked:v,onChange:ve,className:"sr-only peer","aria-label":"Toggle table of contents"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})})};var Hn=Object.defineProperty,Bn=Object.defineProperties,Fn=Object.getOwnPropertyDescriptors,Wt=Object.getOwnPropertySymbols,Kn=Object.prototype.hasOwnProperty,zn=Object.prototype.propertyIsEnumerable,Yt=(n,s,o)=>s in n?Hn(n,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[s]=o,Vt=(n,s)=>{for(var o in s||(s={}))Kn.call(s,o)&&Yt(n,o,s[o]);if(Wt)for(var o of Wt(s))zn.call(s,o)&&Yt(n,o,s[o]);return n},Dn=(n,s)=>Bn(n,Fn(s)),dt=(n,s,o)=>new Promise((y,d)=>{var g=x=>{try{m(o.next(x))}catch(v){d(v)}},w=x=>{try{m(o.throw(x))}catch(v){d(v)}},m=x=>x.done?y(x.value):Promise.resolve(x.value).then(g,w);m((o=o.apply(n,s)).next())});const{Panel:Xt}=ls,Un=({blog:n,keywords:s,setKeywords:o,onPost:y,activeTab:d,handleReplace:g,setProofreadingResults:w,proofreadingResults:m,handleSave:x,posted:v,isPosting:M,formData:L,editorContent:P})=>{var O,Y,ne,je,he,ve,ie,re,fe,N,Ne,Q;const[V,le]=r.useState(""),[De,Ee]=r.useState(!1),[ae,Se]=r.useState(null),[ge,Be]=r.useState(!1),[Ae,$e]=r.useState(!1),[u,_]=r.useState(!1),[K,k]=r.useState("overview"),pe=et(i=>i.auth.user),j=(Y=pe==null?void 0:pe.plan)!=null?Y:(O=pe==null?void 0:pe.subscription)==null?void 0:O.plan,Pe=It(),Le=wt(),{handlePopup:ye}=ss(),{loading:be}=et(i=>i.analysis),[ce,Ue]=r.useState(!1),{analysisResult:Ge}=et(i=>i.analysis),qe=n==null?void 0:n._id,_e=Ge==null?void 0:Ge[qe];He.setOptions({gfm:!0,breaks:!0,headerIds:!1,mangle:!1});const de=i=>i?i.trim().split(/\s+/).filter(h=>h.length>0).length:0;r.useEffect(()=>{Le(ks()).unwrap()},[Le]),r.useEffect(()=>{Se(null)},[n==null?void 0:n._id]);const X=r.useCallback(()=>dt(null,null,function*(){if(!n||!n.title||!n.content){c.error("Blog title or content is missing for analysis.");return}const i=s&&s.length>0?s:(n==null?void 0:n.focusKeywords)||n.keywords;try{const h=yield Le(Ss({blogId:n._id,title:n.title,content:n.content,keywords:i})).unwrap();Se(h),k("analysis")}catch(h){c.error("Failed to perform competitive analysis.")}}),[n,s,Le]);r.useEffect(()=>{ge&&(X(),Be(!1))},[ge,X]),r.useEffect(()=>{var i,h;(n!=null&&n.seoScore||(i=n==null?void 0:n.generatedMetadata)!=null&&i.competitorsAnalysis)&&Se(Vt({blogScore:n.seoScore},(h=n==null?void 0:n.generatedMetadata)==null?void 0:h.competitorsAnalysis))},[n]);const tt=r.useCallback(i=>{o(h=>h.filter(l=>l!==i))},[o]),We=r.useCallback(()=>{if(V.trim()){const i=V.split(",").map(h=>h.trim().toLowerCase()).filter(h=>h&&!s.map(l=>l.toLowerCase()).includes(h));i.length>0&&o(h=>[...h,...i]),le("")}},[V,s,o]),nt=r.useCallback(i=>{i.key==="Enter"&&(i.preventDefault(),We())},[We]),Oe=r.useCallback(()=>dt(null,null,function*(){if(!n||!n.content){c.error("Blog content is required for proofreading.");return}if(be){c.error("Please wait for Competitive Analysis to complete before starting Proofreading.");return}Ee(!0);try{const i=yield Le(Ps({id:n._id})).unwrap();w(i),k("suggestions"),c.success("Proofreading suggestions loaded successfully!")}catch(i){c.error("Failed to fetch proofreading suggestions.")}finally{Ee(!1)}}),[n,Le,be,w]),Me=r.useCallback(()=>{if(m.length===0){c.info("No suggestions available to apply.");return}m.forEach(i=>{g(i.original,i.change)}),w([]),c.success("All proofreading suggestions applied successfully!")},[m,g,w]),I=r.useCallback(()=>{var i,h;if(["free","basic"].includes((i=j==null?void 0:j.toLowerCase)==null?void 0:i.call(j)))return ye({title:"Upgrade Required",description:"Competitor Analysis is only available for Pro and Enterprise users.",confirmText:"Buy Now",cancelText:"Cancel",onConfirm:()=>Pe("/pricing")});const l=n==null?void 0:n.seoScore,C=(h=n==null?void 0:n.generatedMetadata)==null?void 0:h.competitors,$=typeof l=="number"&&l>=0,A=Array.isArray(C)&&C.length>0;return ye(!$&&!A&&!!!ae?{title:"Competitive Analysis",description:"Do you really want to run competitive analysis? It will cost 10 credits.",confirmText:"Run",cancelText:"Cancel",onConfirm:()=>X()}:{title:"Run Competitive Analysis Again?",description:"You have already performed a competitive analysis for this blog. Would you like to run it again? This will cost 10 credits.",confirmText:"Run",cancelText:"Cancel",onConfirm:()=>X()})},[j,n,ye,Pe,ae,X]),T=r.useCallback(()=>{var i;["free","basic"].includes((i=j==null?void 0:j.toLowerCase)==null?void 0:i.call(j))?ye({title:"Upgrade Required",description:"AI Proofreading is only available for Pro and Enterprise users.",confirmText:"Buy Now",cancelText:"Cancel",onConfirm:()=>Pe("/pricing")}):ye({title:"AI Proofreading",description:`Do you really want to proofread the blog? 
It will cost ${kn("blog.proofread")} credits.`,onConfirm:Oe})},[j,ye,Pe,Oe]),ue=r.useCallback(()=>{ye({title:"Rewrite Keywords",description:"Do you want to rewrite the entire content with added keywords? You can rewrite only 3 times.",onConfirm:x})},[ye,x]),B=r.useCallback(i=>dt(null,null,function*(){if(!P){c.error("No content to export.");return}const h=(n==null?void 0:n.title)||"Untitled Blog";if(i==="markdown"){const l=new Blob([P],{type:"text/markdown"}),C=URL.createObjectURL(l),$=document.createElement("a");$.href=C,$.download=`${h}.md`,$.click(),URL.revokeObjectURL(C),c.success("Markdown exported successfully!")}else if(i==="html"){const l=He.parse(P,{gfm:!0}),C=new Blob([l],{type:"text/html"}),$=URL.createObjectURL(C),A=document.createElement("a");A.href=$,A.download=`${h}.html`,A.click(),URL.revokeObjectURL($),c.success("HTML exported successfully!")}else if(i==="docx"){const{Document:l,Packer:C,Paragraph:$,HeadingLevel:A,TextRun:F,ImageRun:Fe,ExternalHyperlink:E}=Gs,we=He.lexer(P),J=[],st=b=>dt(null,null,function*(){try{const z=yield fetch(b,{mode:"cors"});if(!z.ok)throw new Error(`Failed to fetch image: ${z.statusText}`);return yield(yield z.blob()).arrayBuffer()}catch(z){return null}});for(const b of we)if(b.type==="heading")J.push(new $({text:b.text,heading:b.depth<=6?`Heading${b.depth}`:A.HEADING_6,spacing:{after:200}}));else if(b.type==="paragraph"){const z=[],q=b.tokens||He.lexer(b.text||b.raw).filter(H=>H.type!=="space");for(const H of q)if(H.type==="text"||H.type==="html")z.push(new F({text:H.text||H.raw}));else if(H.type==="strong")z.push(new F({text:H.text,bold:!0}));else if(H.type==="em")z.push(new F({text:H.text,italics:!0}));else if(H.type==="link")z.push(new E({children:[new F({text:H.text,style:"Hyperlink"})],link:H.href}));else if(H.type==="image"){const W=yield st(H.href);W?J.push(new $({children:[new Fe({data:W,transformation:{width:600,height:400}})],spacing:{after:200}})):J.push(new $({children:[new F({text:`[Image not available: ${H.href}]`,italics:!0})],spacing:{after:200}}))}else z.push(new F({text:H.raw||H.text||""}));z.length>0?J.push(new $({children:z,spacing:{after:200}})):b.text&&J.push(new $({children:[new F({text:b.text})],spacing:{after:200}}))}else if(b.type==="list")for(const z of b.items){const q=[],H=z.tokens||He.lexer(z.text||z.raw).filter(W=>W.type!=="space");for(const W of H)if(W.type==="text"||W.type==="html")q.push(new F({text:W.text||W.raw}));else if(W.type==="strong")q.push(new F({text:W.text,bold:!0}));else if(W.type==="em")q.push(new F({text:W.text,italics:!0}));else if(W.type==="link")q.push(new E({children:[new F({text:W.text,style:"Hyperlink"})],link:W.href}));else if(W.type==="image"){const lt=yield st(W.href);lt?J.push(new $({children:[new Fe({data:lt,transformation:{width:600,height:400}})],bullet:{level:0},spacing:{after:200}})):q.push(new F({text:`[Image not available: ${W.href}]`,italics:!0}))}else q.push(new F({text:W.raw||W.text||""}));q.length>0?J.push(new $({children:q,bullet:{level:0},spacing:{after:200}})):z.text&&J.push(new $({children:[new F({text:z.text})],bullet:{level:0},spacing:{after:200}}))}else b.type==="space"?J.push(new $({children:[new F({text:""})],spacing:{after:200}})):(b.text||b.raw)&&J.push(new $({children:[new F({text:b.text||b.raw})],spacing:{after:200}}));const Ye=new l({sections:[{properties:{},children:[new $({text:h,heading:A.TITLE,spacing:{after:400}}),...J]}]});try{const b=yield C.toBlob(Ye),z=URL.createObjectURL(b),q=document.createElement("a");q.href=z,q.download=`${h}.docx`,q.click(),URL.revokeObjectURL(z),c.success("DOCX exported successfully!")}catch(b){c.error("Failed to export DOCX.")}}}),[P,n]);r.useCallback(()=>{if(!P){c.error("No content to export.");return}const i=(n==null?void 0:n.title)||"Untitled_Blog",h=He(P,{gfm:!0}),l=rs.sanitize(h),C=document.createElement("div");C.innerHTML=l,C.style.padding="20px",C.style.fontFamily="Arial, sans-serif",C.style.lineHeight="1.6",C.style.maxWidth="800px",C.style.color="#000",C.style.backgroundColor="#fff",Array.from(C.querySelectorAll("*")).forEach(A=>{var F,Fe;const E=window.getComputedStyle(A);(F=E.color)!=null&&F.includes("oklch")&&(A.style.color="#000"),(Fe=E.backgroundColor)!=null&&Fe.includes("oklch")&&(A.style.backgroundColor="#fff")}),document.body.appendChild(C);const $={margin:.5,filename:`${i}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}};Us().set($).from(C).save().then(()=>{c.success("PDF exported successfully!"),document.body.removeChild(C)}).catch(A=>{c.error("Failed to export PDF."),document.body.removeChild(C)})},[P,n]);const me=e.jsxs(kt,{children:[e.jsx(kt.Item,{onClick:()=>B("markdown"),children:"Export as Markdown"},"markdown"),e.jsx(kt.Item,{onClick:()=>B("html"),children:"Export as HTML"},"html")]}),Ce=r.useCallback(i=>i>=80?"bg-green-100 text-green-700 border-green-200":i>=60?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-red-100 text-red-700 border-red-200",[]),jt=r.useCallback(({category:i,includeTableOfContents:h})=>{try{y(Dn(Vt({},L),{categories:i,includeTableOfContents:h}))}catch(l){c.error("Failed to post blog. Please try again.")}},[L,y]),Re=r.useCallback(()=>{$e(!0)},[]);if(be)return e.jsx("div",{className:"flex items-center",children:e.jsx(_t,{message:"Running Competitive Analysis"})});const G=({title:i,description:h,isPro:l,isLoading:C,onClick:$,buttonText:A,icon:F})=>e.jsxs(D.div,{whileHover:{scale:1.02},transition:{duration:.2},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 hover:shadow-md transition-all duration-300",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(F,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:i}),l&&e.jsx(Rt,{count:e.jsx(Ft,{size:10}),style:{backgroundColor:"#fbbf24"},size:"small"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:h})]})]}),e.jsx(xe,{onClick:$,loading:C,disabled:C,type:"primary",className:"w-full py-2 text-sm px-4 rounded-lg font-medium transition-all duration-200 bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:shadow-lg",ghost:l,children:C?"Processing...":A})]}),Ie=({title:i,score:h,icon:l})=>e.jsxs("div",{className:`p-3 rounded-lg border ${Ce(h||0)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:i})]}),h>0&&e.jsxs("span",{className:"text-lg font-bold",children:[h,e.jsx("span",{className:"text-xs ml-1",children:"/100"})]})]}),(h||0)===0?e.jsx("p",{className:"text-xs text-gray-500 text-center p-2 bg-gray-50 rounded-lg",children:"Run Competitive Analysis to get score"}):e.jsx("div",{className:"w-full bg-white/50 rounded-full h-2",children:e.jsx("div",{style:{width:`${h}%`,transition:"width 0.5s ease"},className:`h-2 rounded-full ${h>=80?"bg-green-500":h>=60?"bg-yellow-500":"bg-red-500"}`})})]}),vt=({competitors:i})=>{const[h,l]=r.useState(!1),C=h?i:i==null?void 0:i.slice(0,5);return e.jsxs("div",{className:"space-y-2 relative",children:[(i==null?void 0:i.length)>5&&e.jsx("span",{className:"absolute top-0 right-0 text-[10px] bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full",children:i.length}),C==null?void 0:C.map(($,A)=>e.jsxs(D.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:A*.05},className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-blue-600",children:A+1})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-gray-900 truncate",children:$.title}),e.jsxs("a",{href:$.link||$.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[$.score&&e.jsxs(Tt,{color:"blue",children:[($.score*100).toFixed(2),"%"]}),"Visit ",e.jsx(Kt,{className:"w-3 h-3"})]})]})]},A)),(i==null?void 0:i.length)>5&&!h&&e.jsxs("button",{onClick:()=>l(!0),className:"text-xs text-blue-600 hover:text-blue-700 text-center w-full",children:["+",i.length-5," more competitors"]})]})},oe=({insights:i})=>{const[h,l]=r.useState(!1),[C,$]=r.useState(new Set),A=Object.entries(i||{}),F=h?A:A.slice(0,3),Fe=E=>{const we=new Set(C);we.has(E)?we.delete(E):we.add(E),$(we)};return e.jsxs("div",{className:"space-y-3",children:[F.map(([E,we],J)=>{const st=C.has(J),Ye=typeof we=="object"?"Multiple insights available":we==null?void 0:we.toString(),b=(Ye==null?void 0:Ye.length)>120&&!st,z=b?Ye.slice(0,120)+"...":Ye,q=we.match(/\((\d+\/\d+)\)$/),H=q?q[1]:null;return e.jsx(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:J*.05},className:"p-3 bg-blue-50 rounded-lg border border-blue-100",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ct,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"font-medium text-blue-900 text-sm mb-1",children:E.replace(/([A-Z])/g," $1").trim()}),e.jsxs("p",{children:[" ",H&&e.jsx(Tt,{color:"blue",children:H.replace("/"," / ")})]})]}),e.jsxs("p",{className:"text-xs text-blue-700 leading-relaxed cursor-pointer select-none",onClick:()=>Fe(J),children:[z,b&&e.jsx("span",{className:"text-blue-500 ml-1",children:"(more)"})]})]})]})},E)}),A.length>5&&e.jsx("button",{onClick:()=>l(!h),className:"text-xs text-blue-600 hover:text-blue-700 text-center w-full",children:h?"Show less":`+${A.length-5} more insights`})]})},Te=({suggestion:i,index:h,onApply:l})=>e.jsx(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:h*.05},className:"border border-gray-200 rounded-lg p-3 bg-white hover:shadow-sm transition-shadow",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bn,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Original"})]}),e.jsx("div",{className:"p-2 bg-red-50 border border-red-100 rounded text-xs text-gray-700 leading-relaxed",children:i.original})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wn,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Suggested"})]}),e.jsx("div",{className:"p-2 bg-green-50 border border-green-100 rounded text-xs text-gray-700 leading-relaxed",children:i.change})]}),e.jsx(xe,{size:"small",type:"primary",ghost:!0,onClick:()=>{g(i.original,i.change),l(h)},className:"w-full",children:"Apply This Change"})]})});return u?e.jsx(D.div,{initial:{x:"100%"},animate:{x:"calc(100% - 60px)"},className:"fixed top-[17.5rem] right-0 transform -translate-y-1/2 z-50",children:e.jsx(R,{title:"Maximize Sidebar",placement:"left",children:e.jsx(xe,{onClick:()=>_(!1),className:"h-12 rounded-lg",icon:e.jsx(pn,{className:"w-4 h-4"})})})}):e.jsxs(e.Fragment,{children:[e.jsxs(D.div,{initial:{x:"100%"},animate:{x:0},transition:{type:"spring",stiffness:300,damping:30},className:"w-96 bg-white shadow-xl flex flex-col",children:[e.jsxs("div",{className:"p-4 border border-l-0 bg-gradient-to-r rounded-tr-md from-blue-50 to-purple-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:"Content Analysis"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Optimize your content performance"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!["free","basic"].includes((ne=j==null?void 0:j.toLowerCase)==null?void 0:ne.call(j))&&e.jsx(R,{title:"Export Content",placement:"left",children:e.jsx(Xs,{overlay:me,trigger:["click"],children:e.jsx(xe,{size:"small",icon:e.jsx(hn,{className:"w-4 h-4"})})})}),e.jsx(R,{title:"Minimize sidebar",placement:"left",children:e.jsx(xe,{size:"small",icon:e.jsx(fn,{className:"w-4 h-4"}),onClick:()=>_(!0)})}),e.jsx(R,{title:"Content settings",children:e.jsx(xe,{size:"small",icon:e.jsx(as,{className:"w-4 h-4"}),onClick:()=>Ue(!0)})})]})]}),e.jsx("div",{className:"flex justify-between items-center mt-6 px-2",children:[{key:"overview",label:"Overview",icon:Bt},{key:"analysis",label:"Analysis",icon:it},{key:"suggestions",label:"Suggestions",icon:ct,badge:m.length}].map(({key:i,label:h,icon:l,badge:C})=>e.jsxs("button",{onClick:()=>k(i),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-150
        ${K===i?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(l,{className:"w-4 h-4"}),h,C>0&&e.jsx("span",{className:"ml-1 inline-flex items-center justify-center w-5 h-5 text-xs font-semibold text-white bg-red-500 rounded-full",children:C})]},i))})]}),e.jsx("div",{className:"flex-1 max-h-screen overflow-y-auto custom-scroll border-r",children:e.jsxs(ft,{mode:"wait",children:[K==="overview"&&e.jsxs(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"p-4 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gn,{className:"w-4 h-4 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:"Keywords"})]}),s.length>0&&e.jsxs("button",{type:"text",onClick:()=>{var i;["free"].includes((i=j==null?void 0:j.toLowerCase)==null?void 0:i.call(j))?Sn({featureName:"Keyword Optimization",navigate:Pe}):ue()},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-opacity-80 transition-colors text-sm font-medium\r
                    bg-green-50 text-green-600 border-green-300 border hover:bg-green-100`,children:[["free"].includes((je=j==null?void 0:j.toLowerCase)==null?void 0:je.call(j))?e.jsx(Ft,{className:"w-3 h-3"}):e.jsx(os,{className:"w-3 h-3"}),"Optimize"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsx(ft,{children:s.map((i,h)=>e.jsxs(D.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex items-center bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full border border-blue-200",children:[e.jsx("span",{className:"truncate max-w-[120px]",children:i}),e.jsx("button",{onClick:()=>tt(i),className:"ml-1 text-blue-600 hover:text-blue-800",children:e.jsx(gt,{className:"w-3 h-3"})})]},i))})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:V,onChange:i=>le(i.target.value),onKeyDown:nt,placeholder:"Add keywords...",className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx(xe,{size:"small",type:"primary",onClick:We,icon:e.jsx(yt,{className:"w-4 h-4"})})]}),s.length===0&&e.jsx("p",{className:"text-xs text-gray-500 text-center py-2",children:"No keywords added yet"})]}),e.jsxs("div",{className:"space-y-7",children:[e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsx(Bt,{className:"w-4 h-4 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:"Performance Metrics"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:de(P)}),e.jsx("div",{className:"text-xs text-blue-600",children:"Words"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:s==null?void 0:s.length}),e.jsx("div",{className:"text-xs text-purple-600",children:"Keywords"})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsx(Ie,{title:"Content Score",score:n==null?void 0:n.blogScore,icon:ht}),e.jsx(Ie,{title:"SEO Score",score:((he=_e==null?void 0:_e.insights)==null?void 0:he.blogScore)||(n==null?void 0:n.seoScore),icon:it})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(yn,{className:"w-4 h-4 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:"AI Tools"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(G,{title:"Competitive Analysis",description:"Compare with top competitors",isPro:["free","basic"].includes((ve=j==null?void 0:j.toLowerCase)==null?void 0:ve.call(j)),isLoading:be,onClick:I,buttonText:"Run Analysis",icon:it}),d==="Normal"&&e.jsx(G,{title:"AI Proofreading",description:"Grammar and style improvements",isPro:["free","basic"].includes((ie=j==null?void 0:j.toLowerCase)==null?void 0:ie.call(j)),isLoading:De,onClick:T,buttonText:"Proofread Content",icon:ht})]})]})]},"overview"),K==="analysis"&&e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"p-4 space-y-4",children:ae||_e?e.jsxs(ls,{defaultActiveKey:["1"],ghost:!0,expandIconPosition:"end",children:[((fe=(_e==null?void 0:_e.competitors)||((re=n==null?void 0:n.generatedMetadata)==null?void 0:re.competitors))==null?void 0:fe.length)>0&&e.jsx(Xt,{header:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Et,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Top Competitors"})]}),children:e.jsx(vt,{competitors:(_e==null?void 0:_e.competitors)||((N=n==null?void 0:n.generatedMetadata)==null?void 0:N.competitors)})},"1"),(((Ne=ae==null?void 0:ae.insights)==null?void 0:Ne.analysis)||(ae==null?void 0:ae.analysis))&&e.jsx(Xt,{header:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"font-medium",children:"Key Insights"})]}),children:e.jsx(oe,{insights:((Q=ae==null?void 0:ae.insights)==null?void 0:Q.analysis)||(ae==null?void 0:ae.analysis)})},"2")]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(it,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"No analysis results yet"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Run competitive analysis to see insights"})]})},"analysis"),K==="suggestions"&&e.jsx(D.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"p-4 space-y-4",children:De?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Analyzing content..."})]}):m.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4 text-orange-500"}),e.jsx("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:"Suggestions"}),e.jsx(Rt,{count:m.length})]}),e.jsx(xe,{size:"small",type:"primary",onClick:Me,disabled:m.length===0,className:"text-xs",children:"Apply All"})]}),e.jsx("div",{className:"space-y-3 max-h-screen overflow-y-auto",children:m.map((i,h)=>e.jsx(Te,{suggestion:i,index:h,onApply:l=>{const C=m.filter(($,A)=>A!==l);w(C)}},h))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ht,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"No suggestions available"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Run AI proofreading to get suggestions"})]})},"suggestions")]})}),e.jsxs("div",{className:"p-4 border border-l-0 rounded-br-md border-gray-200 bg-gray-50",children:[e.jsx(D.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsx(xe,{type:"primary",size:"large",onClick:Re,loading:M,disabled:M,className:"w-full h-12 text-base font-semibold bg-gradient-to-r from-green-600 to-emerald-600 border-0 hover:shadow-lg",children:M?"Posting...":n!=null&&n.wordpress?"Re-Post":"Post Blog"})}),(v==null?void 0:v.link)&&e.jsx(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"mt-3 text-center",children:e.jsxs("a",{href:v.link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-blue-600 text-sm hover:text-blue-700 font-medium",children:["View Published Post",e.jsx(Kt,{className:"w-4 h-4"})]})})]})]}),e.jsx(ze,{title:"Content Enhancement Summary",open:ce,onCancel:()=>Ue(!1),footer:null,centered:!0,width:480,children:e.jsx(Gn,{features:(n==null?void 0:n.options)||{}})}),e.jsx(An,{isCategoryModalOpen:Ae,setIsCategoryModalOpen:$e,onSubmit:jt,initialCategory:L.category,initialIncludeTableOfContents:L.includeTableOfContents})]})},Gn=({features:n})=>e.jsxs(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-3",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Here are the content enhancement features currently applied to your blog:"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:Object.entries(n||{}).length>0?Object.entries(n).map(([s,o])=>{const y=!!o;return e.jsxs(D.div,{whileHover:{backgroundColor:"#f8fafc"},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-100 transition-colors duration-150",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${y?"bg-green-500":"bg-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:s.replace(/([A-Z])/g," $1").trim()})]}),e.jsx("span",{className:`text-xs font-medium px-2 py-1 rounded-full ${y?"bg-green-100 text-green-700":"bg-gray-100 text-gray-500"}`,children:y?"Enabled":"Disabled"})]},s)}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(as,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No enhancement features configured"})]})})]});var qn=Object.defineProperty,Wn=Object.defineProperties,Yn=Object.getOwnPropertyDescriptors,Zt=Object.getOwnPropertySymbols,Vn=Object.prototype.hasOwnProperty,Xn=Object.prototype.propertyIsEnumerable,Qt=(n,s,o)=>s in n?qn(n,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[s]=o,Z=(n,s)=>{for(var o in s||(s={}))Vn.call(s,o)&&Qt(n,o,s[o]);if(Zt)for(var o of Zt(s))Xn.call(s,o)&&Qt(n,o,s[o]);return n},ee=(n,s)=>Wn(n,Yn(s)),Zn=(n,s,o)=>new Promise((y,d)=>{var g=x=>{try{m(o.next(x))}catch(v){d(v)}},w=x=>{try{m(o.throw(x))}catch(v){d(v)}},m=x=>x.done?y(x.value):Promise.resolve(x.value).then(g,w);m((o=o.apply(n,s)).next())});const Qn=({closeFnc:n,isOpen:s,handleSubmit:o,errors:y,setErrors:d,formData:g,setFormData:w})=>{var m,x,v;const[M,L]=r.useState(0),[P,O]=r.useState(null),[Y,ne]=r.useState(!1),[je,he]=r.useState([]),[ve,ie]=r.useState(!1),[re,fe]=r.useState(!1),N=re?g.keywords:g.keywords.slice(0,18),Ne=wt();r.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[s]);const Q=()=>{if(M===0&&!P){d(u=>ee(Z({},u),{template:!0})),c.error("Please select a template before proceeding.");return}d(u=>ee(Z({},u),{template:!1})),L(1)},V=()=>L(0),le=()=>n(),De=u=>{O(St[u].name),w(_=>ee(Z({},_),{template:St[u].name})),d(_=>ee(Z({},_),{template:!1}))},Ee=(u,_)=>{w(K=>ee(Z({},K),{[_]:u.target.value})),d(K=>ee(Z({},K),{[_]:!1}))},ae=u=>{w(_=>ee(Z({},_),{tone:u})),d(_=>ee(Z({},_),{tone:!1}))},Se=(u,_)=>{const K=_==="keywords"?"keywordInput":"focusKeywordInput";w(k=>ee(Z({},k),{[K]:u.target.value})),d(k=>ee(Z({},k),{[_]:!1}))},ge=u=>{const _=u==="keywords"?"keywordInput":"focusKeywordInput",K=g[_].trim();if(!K){d(j=>ee(Z({},j),{[u]:!0})),c.error("Please enter a keyword.");return}const k=new Set(g[u].map(j=>j.trim().toLowerCase())),pe=K.split(",").map(j=>j.trim()).filter(j=>j&&!k.has(j.toLowerCase()));if(pe.length===0){d(j=>ee(Z({},j),{[u]:!0})),c.error("Please enter valid, non-duplicate keywords separated by commas.");return}if(u==="focusKeywords"&&g[u].length+pe.length>3){d(j=>ee(Z({},j),{[u]:!0})),c.error("You can only add up to 3 focus keywords.");return}w(j=>ee(Z({},j),{[u]:[...j[u],...pe],[_]:""})),d(j=>ee(Z({},j),{[u]:!1}))},Be=(u,_)=>{const K=[...g[_]];K.splice(u,1),w(ee(Z({},g),{[_]:K}))},Ae=(u,_)=>{u.key==="Enter"&&(u.preventDefault(),ge(_))},$e=()=>Zn(null,null,function*(){if(!g.topic.trim()){d(u=>ee(Z({},u),{topic:!0})),c.error("Please enter a topic before generating titles.");return}if(g.focusKeywords.length<1&&g.keywords.length<1){d(u=>ee(Z({},u),{focusKeywords:!0,keywords:!0})),c.error("Please add at least one focus keyword or secondary keyword.");return}ne(!0);try{const u=yield Ne(_s(Z({keywords:g.focusKeywords,focusKeywords:g.keywords,topic:g.topic,template:P},ve&&{oldTitles:je}))).unwrap();he(u),ie(!0),c.success("Titles generated successfully!")}catch(u){c.error((u==null?void 0:u.message)||"Failed to generate titles. Please try again.")}finally{ne(!1)}});return r.useEffect(()=>{ie(!1),he([])},[]),e.jsx(ze,{title:M===0?"Select Template":"Create Simple Blog",open:s,onCancel:le,footer:M===0?[e.jsx("button",{onClick:Q,className:"px-6 py-2 bg-[#1B6FC9] text-white rounded-lg hover:bg-[#1B6FC9]/90","aria-label":"Proceed to next step",children:"Next"},"next")]:[e.jsx("button",{onClick:V,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300","aria-label":"Go to previous step",children:"Previous"},"previous"),e.jsx("button",{onClick:o,className:"px-6 py-2 bg-[#1B6FC9] text-white rounded-lg hover:bg-[#1B6FC9]/90 ml-3","aria-label":"Submit blog",children:"Submit"},"submit")],width:800,centered:!0,children:e.jsxs("div",{className:"p-2",children:[M===0&&e.jsxs("div",{className:"p-3",children:[e.jsx(Pn,{children:St.map((u,_)=>e.jsx("div",{className:`cursor-pointer transition-all duration-200 ${P===u.name?"border-gray-300 border-2 rounded-lg":""}`,onClick:()=>De(_),children:e.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-sm",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:u.imgSrc||"/placeholder.svg",alt:u.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-2 mt-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:u.name}),e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:u.description})]})]})},_))}),y.template&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:"Please select a template."})]}),M===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Topic ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Xe,{value:g.topic,onChange:u=>Ee(u,"topic"),placeholder:"Enter blog topic...",className:`w-full px-3 py-2 border ${y.topic?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Blog topic"}),y.topic&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Topic cannot be empty."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(Ke,{value:g.tone,onChange:ae,className:`w-full ${y.tone?"border-red-500":""}`,"aria-label":"Blog tone",children:[e.jsx(Ke.Option,{value:"Informative",children:"Informative"}),e.jsx(Ke.Option,{value:"Casual",children:"Casual"}),e.jsx(Ke.Option,{value:"Professional",children:"Professional"}),e.jsx(Ke.Option,{value:"Persuasive",children:"Persuasive"}),e.jsx(Ke.Option,{value:"Humorous",children:"Humorous"})]}),y.tone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Tone cannot be empty."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Focus Keywords (max 3) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Xe,{value:g.focusKeywordInput,onChange:u=>Se(u,"focusKeywords"),onKeyDown:u=>Ae(u,"focusKeywords"),placeholder:"Enter focus keywords, separated by commas",className:`flex-1 px-3 py-2 border ${y.focusKeywords?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Focus keywords"}),e.jsx("button",{onClick:()=>ge("focusKeywords"),className:"px-4 py-2 bg-[#1B6FC9] text-white rounded-md text-sm flex items-center","aria-label":"Add focus keyword",children:e.jsx(yt,{size:16})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:g.focusKeywords.map((u,_)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700",children:[u,e.jsx("button",{onClick:()=>Be(_,"focusKeywords"),className:"ml-1 text-blue-400 hover:text-blue-600","aria-label":`Remove focus keyword ${u}`,children:e.jsx(gt,{size:16})})]},_))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Keywords ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Xe,{value:g.keywordInput,onChange:u=>Se(u,"keywords"),onKeyDown:u=>Ae(u,"keywords"),placeholder:"Enter secondary keywords, separated by commas",className:`flex-1 px-3 py-2 border ${y.keywords?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Secondary keywords"}),e.jsx("button",{onClick:()=>ge("keywords"),className:"px-4 py-2 bg-[#1B6FC9] text-white rounded-md text-sm flex items-center","aria-label":"Add keyword",children:e.jsx(yt,{size:16})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[N.map((u,_)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700",children:[u,e.jsx("button",{onClick:()=>Be(_,"keywords"),className:"ml-1 text-blue-400 hover:text-blue-600","aria-label":`Remove keyword ${u}`,children:e.jsx(gt,{size:16})})]},`${u}-${_}`)),g.keywords.length>18&&e.jsx("span",{onClick:()=>fe(u=>!u),className:"text-xs font-medium text-blue-600 self-center cursor-pointer flex items-center gap-1",children:re?e.jsx(e.Fragment,{children:"Show less"}):e.jsxs(e.Fragment,{children:["+",g.keywords.length-18," more"]})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Xe,{value:g.title,onChange:u=>Ee(u,"title"),placeholder:"Enter blog title...",className:`w-full px-3 flex-1 py-2 border ${y.title?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Blog title"}),e.jsx("button",{onClick:$e,disabled:Y,className:`px-4 py-2 bg-gradient-to-r from-[#1B6FC9] to-[#4C9FE8] text-white rounded-lg flex items-center ${Y?"opacity-50 cursor-not-allowed":"hover:from-[#1B6FC9]/90 hover:to-[#4C9FE8]/90"}`,children:Y?e.jsx(Zs,{size:"small"}):ve?e.jsxs(e.Fragment,{children:[e.jsx(jn,{size:16,className:"mr-2"}),"Generate More"]}):e.jsxs(e.Fragment,{children:[e.jsx(os,{size:16,className:"mr-2"}),"Generate Titles"]})})]}),je.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:je.map((u,_)=>{const K=u===g.title;return e.jsx("div",{className:"relative group",children:e.jsx("button",{type:"button",onClick:()=>{w(k=>ee(Z({},k),{title:u})),d(k=>ee(Z({},k),{title:!1}))},className:`px-3 py-1 rounded-full text-sm border transition truncate max-w-[200px] sm:max-w-[300px] ${K?"bg-[#1B6FC9] text-white border-[#1B6FC9]":"bg-gray-100 text-gray-700 border-gray-300 opacity-60 hover:opacity-100 hover:bg-gray-200"}`,"aria-label":`Select title: ${u}`,children:u})},_)})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Choose length of Blog ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"range",min:"500",max:"5000",value:(m=g.userDefinedLength)!=null?m:1e3,onChange:u=>Ee(u,"userDefinedLength"),placeholder:"Enter desired word count...",className:"w-full h-1 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-[#1B6FC9]",style:{background:`linear-gradient(to right, #1B6FC9 ${(((x=g==null?void 0:g.userDefinedLength)!=null?x:1e3)-500)/45}%, #e5e7eb 0%)`},"aria-label":"Desired word count"}),e.jsxs("span",{className:"mt-2 text-sm text-gray-600 block",children:[(v=g==null?void 0:g.userDefinedLength)!=null?v:1e3," words"]})]})]})]})})};var Jn=Object.defineProperty,er=Object.defineProperties,tr=Object.getOwnPropertyDescriptors,Jt=Object.getOwnPropertySymbols,sr=Object.prototype.hasOwnProperty,nr=Object.prototype.propertyIsEnumerable,es=(n,s,o)=>s in n?Jn(n,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[s]=o,Pt=(n,s)=>{for(var o in s||(s={}))sr.call(s,o)&&es(n,o,s[o]);if(Jt)for(var o of Jt(s))nr.call(s,o)&&es(n,o,s[o]);return n},rr=(n,s)=>er(n,tr(s)),ut=(n,s,o)=>new Promise((y,d)=>{var g=x=>{try{m(o.next(x))}catch(v){d(v)}},w=x=>{try{m(o.throw(x))}catch(v){d(v)}},m=x=>x.done?y(x.value):Promise.resolve(x.value).then(g,w);m((o=o.apply(n,s)).next())});const yr=()=>{var n,s;const{id:o}=vs(),y=wt(),d=et(I=>I.blog.selectedBlog),[g,w]=r.useState("Normal"),[m,x]=r.useState(!0),[v,M]=r.useState([]),[L,P]=r.useState(""),[O,Y]=r.useState(""),[ne,je]=r.useState([]),[he,ve]=r.useState(!1),[ie,re]=r.useState(null),[fe,N]=r.useState(!1),[Ne,Q]=r.useState(null),[V,le]=r.useState(!1),[De,Ee]=r.useState({category:"",includeTableOfContents:!1}),[ae,Se]=r.useState(!o),ge=et(I=>I.auth.user),Be=(s=ge==null?void 0:ge.plan)!=null?s:(n=ge==null?void 0:ge.subscription)==null?void 0:n.plan,Ae=It(),u=ts().pathname===`/blog-editor/${d==null?void 0:d._id}`,[_,K]=r.useState(!1),[k,pe]=r.useState({title:"",topic:"",tone:"Informative",focusKeywords:[],keywords:[],userDefinedLength:1200,focusKeywordInput:"",keywordInput:"",template:""}),[j,Pe]=r.useState({title:!1,topic:!1,tone:!1,focusKeywords:!1,keywords:!1,userDefinedLength:!1,template:!1});r.useEffect(()=>{o&&(x(!0),y(Ot(o)).unwrap().catch(()=>c.error("Failed to load blog.")).finally(()=>x(!1)))},[o,y]),r.useEffect(()=>{d&&(M(d.keywords||[]),Y(d.title||""),P(d.content?Ys(d.content,{wordwrap:!1,selectors:[{selector:"a",options:{baseUrl:""}},{selector:"img",format:"skip"}]}):""),Q(d.wordpress||null),Ee({category:d.category||"",includeTableOfContents:d.includeTableOfContents||!1,title:d.title||""}))},[d]);const Le=(I,T)=>{if(typeof I!="string"||typeof T!="string"){c.error("Invalid suggestion format.");return}const ue=new RegExp(I.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g");P(B=>B.replace(ue,T)),je(B=>B.filter(me=>me.original!==I))},ye=I=>ut(null,null,function*(){var T,ue;if(le(!0),!O){c.error("Blog title is missing."),le(!1);return}if(!L.trim()){c.error("Blog content is empty."),le(!1);return}if(!I.categories){c.error("Please select a category."),le(!1);return}try{const B=yield Is.post("/wordpress/post",{blogId:d._id,title:O,content:L,categories:I.categories,includeTableOfContents:I.includeTableOfContents});Q(B==null?void 0:B.data),c.success("Blog posted successfully!")}catch(B){c.error(((ue=(T=B.response)==null?void 0:T.data)==null?void 0:ue.message)||"Failed to post to WordPress.")}finally{le(!1)}}),be=I=>I.trim().split(/\s+/).filter(T=>T.length>0).length,ce=()=>ut(null,null,function*(){if(Be==="free"||Be==="basic"){showUpgradePopup();return}if(!O.trim()){c.error("Blog title is required.");return}N(!0);try{const I=yield y(Mt({id:d._id,title:O,content:L,published:d==null?void 0:d.published,focusKeywords:d==null?void 0:d.focusKeywords,keywords:v})).unwrap();return c.success("Blog updated successfully"),x(!0),setTimeout(()=>{y(Ot(o)).unwrap().finally(()=>x(!1))},2e3),I}catch(I){c.error("Failed to save blog.")}finally{N(!1)}}),Ue=()=>ut(null,null,function*(){N(!0);try{yield y(Mt({id:d._id,title:O,content:L,published:d==null?void 0:d.published,focusKeywords:d==null?void 0:d.focusKeywords,keywords:v})).unwrap();const I=yield ns(d._id);I.data?(re(I.data),ve(!0),c.success("Review the suggested content.")):c.error("No content received from retry.")}catch(I){c.error("Failed to save blog.")}finally{N(!1)}}),{Title:Ge}=Qs,qe=()=>{ie&&(P(ie),c.success("Content updated successfully!")),ve(!1),re(null)},_e=()=>{ve(!1),re(null),c.info("Changes discarded.")},de={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},X=()=>{var I,T,ue;(!((I=k.title)!=null&&I.trim())||!((T=k.topic)!=null&&T.trim())||!((ue=k.tone)!=null&&ue.trim())||!k.template||!k.userDefinedLength||k.userDefinedLength<=0||!k.focusKeywords||k.focusKeywords.length===0||!k.keywords||k.keywords.length===0)&&!o&&Ae("/blogs"),Se(!1)},tt=()=>ut(null,null,function*(){var I,T,ue;const B={title:(I=k.title)==null?void 0:I.trim(),topic:(T=k.topic)==null?void 0:T.trim(),tone:(ue=k.tone)==null?void 0:ue.trim(),focusKeywords:k.focusKeywords,keywords:k.keywords,userDefinedLength:Number(k.userDefinedLength),template:k.template},me={};if(B.title||(me.title=!0),B.topic||(me.topic=!0),B.tone||(me.tone=!0),B.template||(me.template=!0),(!B.userDefinedLength||B.userDefinedLength<=0)&&(me.userDefinedLength=!0),(!B.focusKeywords||B.focusKeywords.length===0)&&(me.focusKeywords=!0),(!B.keywords||B.keywords.length===0)&&(me.keywords=!0),Object.keys(me).length>0){Pe(Ce=>Pt(Pt({},Ce),me)),c.error("Please fill all required fields correctly.");return}try{const Ce=yield y(Es(B)).unwrap();Se(!1),Ae(`/blog-editor/${Ce._id}`)}catch(Ce){c.error((Ce==null?void 0:Ce.message)||"Failed to create blog")}}),We=I=>{const T=I.target.value;be(T)<=60?(Y(T),Ee(ue=>rr(Pt({},ue),{title:T}))):c.error("Title exceeds 60 words.")},nt=()=>{if(!L.trim()){c.error("Please write some content to preview.");return}K(!0)},Oe=()=>K(!1),Me=()=>L.trim()?`<div class="prose prose-lg"><h1>${O||topic||"Your Blog Title"}</h1>${L}</div>`:`<h1>${O||"Preview Title"}</h1><p>No content available for preview.</p>`;return e.jsxs(e.Fragment,{children:[e.jsx(Ns,{children:e.jsx("title",{children:"Blog Editor | GenWrite"})}),e.jsxs("div",{className:`h-screen flex flex-col ${ae?"blur-sm":""}`,children:[e.jsxs(ze,{open:he,centered:!0,footer:[e.jsx(xe,{onClick:_e,style:{background:"#f5f5f5",color:"#595959"},children:"Reject"},"reject"),e.jsx(xe,{type:"primary",onClick:qe,children:"Accept"},"accept")],onCancel:_e,width:700,className:"rounded-lg",children:[e.jsx(Ge,{level:3,style:{marginBottom:"16px"},children:"Suggested Content"}),e.jsx("div",{style:{padding:"16px",background:"#f5f5f5",borderRadius:"4px",marginBottom:"16px"},children:e.jsx(mt,{remarkPlugins:[pt],rehypePlugins:[xt],className:"prose",components:{a:({href:I,children:T})=>e.jsx("a",{href:I,target:"_blank",rel:"noopener noreferrer",style:{color:"#1890ff"},children:T}),strong:({children:I})=>e.jsx("strong",{style:{fontWeight:"bold"},children:I})},children:ie})})]}),e.jsx(ze,{title:"Blog Preview",open:_,onCancel:Oe,footer:[e.jsx("button",{onClick:Oe,className:"px-4 py-2 bg-gray-400 text-white rounded-md hover:bg-gray-500 focus:outline-none focus:bg-gray-500","aria-label":"Close preview",children:"Close"},"close")],width:800,centered:!0,children:e.jsx("div",{className:"prose prose-lg max-w-none p-4",dangerouslySetInnerHTML:{__html:Me()}})}),e.jsxs("div",{className:"flex mt-5 pb-5",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("header",{className:"bg-white shadow-lg border rounded-tl-lg border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:e.jsx(ht,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:o?"Edit Blog":"Create New Blog"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Write and optimize your content"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[u&&e.jsxs("button",{onClick:nt,className:"px-4 py-2 bg-gradient-to-r from-[#1B6FC9] to-[#4C9FE8] text-white rounded-lg hover:from-[#1B6FC9]/90 hover:to-[#4C9FE8]/90 flex items-center","aria-label":"Preview blog",children:[e.jsx(Et,{size:16,className:"mr-2"}),"Preview"]}),e.jsx("button",{onClick:ce,className:`px-4 py-2 rounded-lg font-semibold flex items-center gap-2 transition-all duration-300 ${fe||!O.trim()||!L.trim()||be(O)>60?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:shadow-lg hover:scale-105"}`,disabled:fe||!O.trim()||!L.trim()||be(O)>60,"aria-label":"Save blog",children:fe?e.jsxs(e.Fragment,{children:[e.jsx(vn,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Nn,{className:"w-4 h-4"}),"Save Blog"]})})]})]}),u&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex gap-2 flex-col sm:flex-row",children:e.jsx("input",{type:"text",value:O,onChange:We,placeholder:"Enter your blog title...",className:`flex-1 text-2xl sm:text-3xl font-bold text-gray-900 placeholder-gray-400 border-none outline-none resize-none ${be(O)>60?"text-red-600":""}`,"aria-label":"Blog title"})}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[be(O),"/60 words (optimal for SEO)",be(O)>60&&e.jsx("span",{className:"text-red-600 ml-2",children:"Title exceeds 60 words"})]})]})]}),e.jsx(ft,{children:e.jsx(D.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:de,transition:{duration:.3},className:"flex-grow",children:m?e.jsx("div",{className:"flex justify-center items-center h-[calc(100vh-120px)]",children:e.jsx(Cn,{className:"animate-spin h-8 w-8 text-blue-600"})}):e.jsx(Rn,{keywords:v,setKeywords:M,blog:d,activeTab:g,setActiveTab:w,proofreadingResults:ne,handleReplace:Le,content:L,setContent:P,title:O,setTitle:Y,isSavingKeyword:fe})},g)})]}),e.jsx(Un,{blog:d,keywords:v,setKeywords:M,onPost:ye,activeTab:g,handleReplace:Le,proofreadingResults:ne,setProofreadingResults:je,handleSave:Ue,posted:Ne,isPosting:V,formData:De,title:O,editorContent:L})]})]}),e.jsx(Qn,{closeFnc:X,isOpen:ae,handleSubmit:tt,errors:j,setErrors:Pe,formData:k,setFormData:pe})]})};export{yr as default};
