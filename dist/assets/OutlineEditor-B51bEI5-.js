var le=Object.defineProperty,ae=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var Y=(m,i,l)=>i in m?le(m,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[i]=l,a=(m,i)=>{for(var l in i||(i={}))ne.call(i,l)&&Y(m,l,i[l]);if(W)for(var l of W(i))de.call(i,l)&&Y(m,l,i[l]);return m},d=(m,i)=>ae(m,oe(i));var O=(m,i,l)=>new Promise((j,v)=>{var B=p=>{try{N(l.next(p))}catch(y){v(y)}},S=p=>{try{N(l.throw(p))}catch(y){v(y)}},N=p=>p.done?j(p.value):Promise.resolve(p.value).then(B,S);N((l=l.apply(m,i)).next())});import{u as ie,z as ce,r as g,j as e,V as me,cN as ue,Z as xe}from"./index-D-KN41Wk.js";import{C as he,p as R}from"./templates-Dt4w_ceg.js";import{u as pe}from"./useQuery-B6oHDDMc.js";import{I as C}from"./index-ClkeLI0C.js";import{S as Q}from"./index-C9VK4-Fq.js";import{P as T}from"./plus-BpiE6cGh.js";import{X as _}from"./x-aXIjzBCM.js";import{E as be}from"./index-D6NNYjuG.js";import"./Input-D6zra8aW.js";import"./SearchOutlined-h_yG84Zi.js";import"./Overflow-y6eyopoO.js";import"./createLucideIcon-CHaMu4_v.js";const{Option:K}=Q,Fe=()=>{var q,H,G;const m=ie(),i=ce(),[l,j]=g.useState(0),[v,B]=g.useState(null),[S,N]=g.useState(!1),[p,y]=g.useState(!0),[D,I]=g.useState(!1),[r,f]=g.useState({title:"",topic:"",tone:"Informative",focusKeywords:[],keywords:[],userDefinedLength:1200,focusKeywordInput:"",keywordInput:"",template:"",brandId:null,resources:[],resourceInput:""}),[x,u]=g.useState({title:!1,topic:!1,tone:!1,focusKeywords:!1,keywords:!1,template:!1,resources:!1}),[w,M]=g.useState(null),{data:k=[],isLoading:ge,error:fe}=pe({queryKey:["brands"],queryFn:()=>O(null,null,function*(){return yield m(xe()).unwrap()}),enabled:r.isCheckedBrand}),U=()=>{y(!1),i("/toolbox")},z=()=>{j(s=>s-1)},A=()=>{let s={};if(l===0&&!v){s.template=!0,u(t=>a(a({},t),s));return}if(l===1&&(s={title:!r.title.trim(),topic:!r.topic.trim(),tone:!r.tone,focusKeywords:r.focusKeywords.length===0,keywords:r.keywords.length===0},Object.values(s).some(t=>t))){u(t=>a(a({},t),s));return}u(t=>d(a(a({},t),s),{template:!1})),j(t=>t+1)},X=s=>{B(R[s].name),f(t=>d(a({},t),{template:R[s].name})),u(t=>d(a({},t),{template:!1}))},E=(s,t)=>{f(n=>d(a({},n),{[t]:s.target.value})),u(n=>d(a({},n),{[t]:!1}))},Z=s=>{f(t=>d(a({},t),{tone:s})),u(t=>d(a({},t),{tone:!1}))},L=(s,t)=>{const n=t==="keywords"?"keywordInput":t==="focusKeywords"?"focusKeywordInput":"resourceInput";f(h=>d(a({},h),{[n]:s.target.value})),u(h=>d(a({},h),{[t]:!1}))},$=s=>{const t=s==="keywords"?"keywordInput":s==="focusKeywords"?"focusKeywordInput":"resourceInput",n=r[t].trim();if(!n){u(o=>d(a({},o),{[s]:!0}));return}const h=new Set(r[s].map(o=>o.trim().toLowerCase())),b=n.split(",").map(o=>o.trim()).filter(o=>o&&!h.has(o.toLowerCase()));if(b.length===0){u(o=>d(a({},o),{[s]:!0}));return}if(s==="focusKeywords"&&r[s].length+b.length>3){u(o=>d(a({},o),{[s]:!0}));return}if(s==="resources"&&r[s].length+b.length>4){u(o=>d(a({},o),{[s]:!0}));return}if(s==="resources"&&b.filter(c=>{try{return new URL(c),!1}catch(we){return!0}}).length>0){u(c=>d(a({},c),{[s]:!0}));return}f(o=>d(a({},o),{[s]:[...o[s],...b],[t]:""})),u(o=>d(a({},o),{[s]:!1}))},F=(s,t)=>{const n=[...r[t]];n.splice(s,1),f(d(a({},r),{[t]:n}))},P=(s,t)=>{s.key==="Enter"&&(s.preventDefault(),$(t))},J=s=>{f(t=>d(a({},t),{brandId:s}))},ee=()=>O(null,null,function*(){var h,b,o;I(!0);const s=k.find(c=>c._id===r.brandId),t={title:(h=r.title)==null?void 0:h.trim(),topic:(b=r.topic)==null?void 0:b.trim(),tone:(o=r.tone)==null?void 0:o.trim(),focusKeywords:r.focusKeywords,keywords:r.keywords,wordsLimit:Number(r.userDefinedLength),template:r.template,brandData:s?{name:s.nameOfVoice,audience:s.describeBrand,values:s.keywords}:void 0,resources:(r==null?void 0:r.resources)||void 0},n={title:!t.title,topic:!t.topic,tone:!t.tone,template:!t.template,focusKeywords:!t.focusKeywords||t.focusKeywords.length===0,keywords:!t.keywords||t.keywords.length===0};if(Object.values(n).some(c=>c)){u(c=>a(a({},c),n)),j(1),I(!1);return}try{const c=yield m(ue(t)).unwrap();M(c),y(!1)}catch(c){console.error("Failed to create blog:",c),message.error((c==null?void 0:c.message)||"Failed to create blog")}finally{I(!1)}}),V=()=>{if(!w)return;const s=new Blob([w],{type:"text/markdown"}),t=URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download=`${r.title||"blog-outline"}.md`,n.click(),URL.revokeObjectURL(t)},se=s=>{M(s.target.value)},te=s=>{const t=[".png",".jpg",".jpeg",".gif",".webp"];try{const n=new URL(s);return t.some(h=>n.pathname.toLowerCase().endsWith(h))}catch(n){return!1}},re=S?r.keywords:r.keywords.slice(0,18);return e.jsxs("div",{children:[e.jsx(me,{title:l===0?"Select Template":l===1?"Tell us about your blog, we'll outline it for you!":"Brand Voice & Resources",open:p,onCancel:U,footer:l===0?[e.jsx("button",{onClick:A,className:"px-6 py-2 bg-[#1B6FC9] text-white rounded-lg hover:bg-[#1B6FC9]/90","aria-label":"Proceed to next step",children:"Next"},"next")]:l===1?[e.jsx("button",{onClick:z,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300","aria-label":"Go to previous step",children:"Previous"},"previous"),e.jsx("button",{onClick:A,className:"px-6 py-2 bg-[#1B6FC9] text-white rounded-lg hover:bg-[#1B6FC9]/90 ml-3","aria-label":"Proceed to brand and resources",children:"Next"},"next")]:l===2?[e.jsx("button",{onClick:z,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300","aria-label":"Go to previous step",children:"Previous"},"previous"),e.jsx("button",{onClick:ee,className:"px-6 py-2 bg-[#1B6FC9] text-white rounded-lg hover:bg-[#1B6FC9]/90 ml-3 disabled:opacity-50 disabled:cursor-not-allowed",disabled:D,"aria-label":"Submit blog",children:D?"Submitting...":"Submit"},"submit")]:[e.jsx("button",{onClick:V,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700","aria-label":"Export as Markdown",children:"Export as Markdown"},"export"),e.jsx("button",{onClick:U,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 ml-3","aria-label":"Close modal",children:"Close"},"close")],width:800,centered:!0,bodyStyle:{background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(8px)"},maskStyle:{background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(4px)"},children:e.jsxs("div",{className:"p-2",children:[l===0&&e.jsxs("div",{className:"p-3",children:[e.jsx(he,{children:R.map((s,t)=>e.jsx("div",{className:`cursor-pointer transition-all duration-200 ${v===s.name?"border-blue-600 border-2 rounded-lg":""}`,onClick:()=>X(t),children:e.jsxs("div",{className:"bg-white rounded-lg overflow-hidden shadow-sm",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:s.imgSrc||"/placeholder.svg",alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-2 mt-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 line-clamp-2",children:s.description})]})]})},t))}),x.template&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:"Please select a template."})]}),l===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Topic ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{value:r.topic,onChange:s=>E(s,"topic"),placeholder:"Enter blog topic...",className:`w-full px-3 py-2 border ${x.topic?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Blog topic"}),x.topic&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Topic cannot be empty."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(Q,{value:r.tone,onChange:Z,className:`w-full ${x.tone?"border-red-500":""}`,"aria-label":"Blog tone",placeholder:"Select tone",children:[e.jsx(K,{value:"Informative",children:"Informative"}),e.jsx(K,{value:"Casual",children:"Casual"}),e.jsx(K,{value:"Professional",children:"Professional"}),e.jsx(K,{value:"Persuasive",children:"Persuasive"}),e.jsx(K,{value:"Humorous",children:"Humorous"})]}),x.tone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Please select a tone."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Focus Keywords (max 3) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{value:r.focusKeywordInput,onChange:s=>L(s,"focusKeywords"),onKeyDown:s=>P(s,"focusKeywords"),placeholder:"Enter focus keywords, separated by commas",className:`flex-1 px-3 py-2 border ${x.focusKeywords?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Focus keywords"}),e.jsx("button",{onClick:()=>$("focusKeywords"),className:"px-4 py-2 bg-[#1B6FC9] text-white rounded-md text-sm flex items-center","aria-label":"Add focus keyword",children:e.jsx(T,{size:16})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.focusKeywords.map((s,t)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700",children:[s,e.jsx("button",{onClick:()=>F(t,"focusKeywords"),className:"ml-1 text-blue-400 hover:text-blue-600","aria-label":`Remove focus keyword ${s}`,children:e.jsx(_,{size:16})})]},t))}),x.focusKeywords&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"At least one focus keyword is required (max 3)."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Keywords ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{value:r.keywordInput,onChange:s=>L(s,"keywords"),onKeyDown:s=>P(s,"keywords"),placeholder:"Enter secondary keywords, separated by commas",className:`flex-1 px-3 py-2 border ${x.keywords?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Secondary keywords"}),e.jsx("button",{onClick:()=>$("keywords"),className:"px-4 py-2 bg-[#1B6FC9] text-white rounded-md text-sm flex items-center","aria-label":"Add keyword",children:e.jsx(T,{size:16})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[re.map((s,t)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700",children:[s,e.jsx("button",{onClick:()=>F(t,"keywords"),className:"ml-1 text-blue-400 hover:text-blue-600","aria-label":`Remove keyword ${s}`,children:e.jsx(_,{size:16})})]},`${s}-${t}`)),r.keywords.length>18&&e.jsx("span",{onClick:()=>N(s=>!s),className:"text-xs font-medium text-blue-600 self-center cursor-pointer flex items-center gap-1",children:S?e.jsx(e.Fragment,{children:"Show less"}):e.jsxs(e.Fragment,{children:["+",r.keywords.length-18," more"]})})]}),x.keywords&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"At least one keyword is required."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(C,{value:r.title,onChange:s=>E(s,"title"),placeholder:"Enter blog title...",className:`w-full px-3 flex-1 py-2 border ${x.title?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Blog title"})}),x.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Title cannot be empty."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Choose length of Blog ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"range",min:"500",max:"5000",value:(q=r.userDefinedLength)!=null?q:1e3,onChange:s=>E(s,"userDefinedLength"),placeholder:"Enter desired word count...",className:"w-full h-1 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-[#1B6FC9]",style:{background:`linear-gradient(to right, #1B6FC9 ${(((H=r==null?void 0:r.userDefinedLength)!=null?H:1e3)-500)/45}%, #e5e7eb 0%)`},"aria-label":"Desired word count"}),e.jsxs("span",{className:"mt-2 text-sm text-gray-600 block",children:[(G=r==null?void 0:r.userDefinedLength)!=null?G:1e3," words"]})]})]}),l===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Brand Voice"}),e.jsx("div",{className:"mt-3 p-4 rounded-md border border-gray-200 bg-gray-50",children:(k==null?void 0:k.length)>0?e.jsx("div",{className:"max-h-48 overflow-y-auto pr-1",children:e.jsx("div",{className:"grid gap-3",children:k.map(s=>e.jsxs("label",{className:`flex items-start gap-2 p-3 rounded-md cursor-pointer ${r.brandId===s._id?"bg-blue-100 border-blue-300":"bg-white border border-gray-200"}`,children:[e.jsx("input",{type:"radio",name:"selectedBrandVoice",value:s._id,checked:r.brandId===s._id,onChange:()=>J(s._id),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-700",children:s.nameOfVoice}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.describeBrand})]})]},s._id))})}):e.jsxs("div",{className:"text-gray-500 text-sm italic",children:[e.jsx(be,{})," No brand voices available. Create one to get started."]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Resource Links (max 4)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{value:r.resourceInput,onChange:s=>L(s,"resources"),onKeyDown:s=>P(s,"resources"),placeholder:"Enter resource links (YouTube or others), separated by commas",className:`flex-1 px-3 py-2 border ${x.resources?"border-red-500":"border-gray-200"} rounded-md text-sm focus:ring-2 focus:ring-blue-600`,"aria-label":"Resource links"}),e.jsx("button",{onClick:()=>$("resources"),className:"px-4 py-2 bg-[#1B6FC9] text-white rounded-md text-sm flex items-center","aria-label":"Add resource link",children:e.jsx(T,{size:16})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.resources.map((s,t)=>e.jsxs("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-50 text-blue-700",children:[te(s)?e.jsx("img",{src:s,alt:`Resource ${t+1}`,className:"h-16 w-auto object-contain rounded mr-2 hover:opacity-80 transition-opacity"}):e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-700 hover:underline mr-2 truncate max-w-[150px]",children:s}),e.jsx("button",{onClick:()=>F(t,"resources"),className:"ml-1 text-blue-400 hover:text-blue-600","aria-label":`Remove resource ${s}`,children:e.jsx(_,{size:16})})]},t))}),x.resources&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Please enter valid resource links (max 4)."})]})]}),l===3&&e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Generated Blog Outline"}),w?e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:w.replace(/^#+\s+/gm,s=>`<h${s.length}>`).replace(/\n/gm,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^- (.*)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/g,"<ul>$1</ul>")}}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No content available to display."})]})]})}),e.jsxs("div",{className:"rounded-lg p-6 min-h-[600px] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r mb-2 from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Blog Outline Editor"}),e.jsxs("button",{onClick:V,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium flex items-center gap-2","aria-label":"Export as Markdown",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export as Markdown"]})]}),w?e.jsxs("div",{className:"flex-1 flex space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3 px-3 tracking-wide",children:"Preview"}),e.jsx("div",{className:"w-full h-screen p-4 border border-gray-200 rounded-lg bg-white overflow-y-auto prose prose-sm max-w-none text-gray-700 shadow-sm",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:w.replace(/^#+\s+/gm,s=>`<h${s.length}>`).replace(/\n/gm,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^- (.*)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/g,"<ul>$1</ul>").replace(/^(<h[1-6]>.*<\/h[1-6]>)$/gm,'<div class="mt-4">$1</div>').replace(/^(<ul>.*<\/ul>)$/gm,'<div class="mt-2">$1</div>')}})})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3 px-3 tracking-wide",children:"Edit Your Blog Outline"}),e.jsx("textarea",{id:"outline-editor",value:w,onChange:se,className:"w-full h-screen p-4 border border-gray-200 rounded-lg text-sm font-mono bg-white focus:ring-2 focus:ring-blue-600 resize-none shadow-sm","aria-label":"Edit blog outline",placeholder:"Edit your blog outline here..."})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"No content available to display."})})]})]})};export{Fe as default};
