import{c as R,u as z,a as U,b as H,r as M,l as B,f as E,j as t,H as G,m as l,T as J,C as Y}from"./index-CdvKsoWL.js";import{Z as L}from"./zap-BWliqTYE.js";import{T as n}from"./index-DU8gBZtG.js";import{C as q}from"./calendar-DuqQUBjS.js";import{A as O}from"./arrow-right-DEw2oS-L.js";import{R as V}from"./ReloadOutlined-DAnzfM9n.js";import{F as Z}from"./Table-BtK-hly2.js";import"./addEventListener-DnQkdEcL.js";import"./index-Bx0DkFRj.js";import"./index-DEhZmtAc.js";import"./move-z9us6IY5.js";import"./useIcons-CUMdrazp.js";import"./SearchOutlined-Dw8wsIF4.js";import"./index-CuPYC4fN.js";import"./useForm-BKthYrdQ.js";import"./index-DKr0mJdo.js";import"./LeftOutlined-DPamsJIP.js";import"./RightOutlined-CTq7ZbF_.js";import"./collapse-BbEVqHco.js";import"./index-Dy2kfasd.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-Bep9zDwe.js";import"./useForceUpdate-C0HbZGSd.js";import"./Pagination-82MNUT87.js";import"./Input-BfZIjPcH.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Q=R("credit-card",K);/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],X=R("dollar-sign",W),{Meta:De}=Y,Se=()=>{var m,x,p,h,b,g,u,y,f,j,w,N,v,C,k,D,S,T,P,A,I;const i=z(),{user:e,integration:ee}=U(s=>({user:s.auth.user,integration:s.auth.integration||null})),{transactions:_,loading:$}=U(s=>s.user),o=H(),d=((m=e==null?void 0:e.subscription)==null?void 0:m.plan)==="free"&&((x=e==null?void 0:e.subscription)==null?void 0:x.status)==="unpaid";M.useEffect(()=>{i(B())},[i]),M.useEffect(()=>{i(E())},[i]);const F=[{title:"Date",dataIndex:"createdAt",key:"createdAt",render:s=>new Date(s).toLocaleString("en-US",{dateStyle:"medium",timeStyle:"short"}),sorter:(s,a)=>new Date(s.createdAt)-new Date(a.createdAt),defaultSortOrder:"descend",width:140},{title:"Type",dataIndex:"type",key:"type",render:s=>t.jsx(n,{color:s==="subscription"?"blue":"gold",className:"text-xs",children:s.replace(/_/g," ").toUpperCase()}),width:100},{title:"Plan",dataIndex:"plan",key:"plan",render:s=>s?t.jsx(n,{color:"purple",className:"text-xs",children:s.toUpperCase()}):"-",width:80},{title:"Credits",dataIndex:"creditsAdded",key:"creditsAdded",render:s=>t.jsx("span",{className:"text-sm font-medium",children:s||0}),width:80},{title:"Amount",dataIndex:"amount",key:"amount",render:(s,a)=>{var r;return t.jsxs("span",{className:"text-sm font-semibold text-green-600",children:["$",((s||0)/100).toFixed(2)," ",((r=a.currency)==null?void 0:r.toUpperCase())||"USD"]})},width:100},{title:"Payment Method",dataIndex:"paymentMethod",key:"paymentMethod",responsive:["md"],render:s=>t.jsx("span",{className:"text-sm",children:(s==null?void 0:s.toUpperCase())||"-"}),width:120},{title:"Status",dataIndex:"status",key:"status",render:s=>{const r={success:"green",failed:"red",pending:"orange",default:"default"}[s]||"default";return t.jsx(n,{color:r,className:"text-xs font-medium",children:s.toUpperCase()})},filters:[{text:"Success",value:"success"},{text:"Pending",value:"pending"},{text:"Failed",value:"failed"}],onFilter:(s,a)=>a.status===s,width:100},{title:"Invoice",dataIndex:"invoiceUrl",key:"invoiceUrl",responsive:["md"],render:s=>s?t.jsx("a",{href:s,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm underline",children:"View"}):"-",width:80}],c=((p=e==null?void 0:e.subscription)==null?void 0:p.plan)==="pro";return e!=null&&e.totalCredits,(h=e==null?void 0:e.usage)!=null&&h.createdJobs,(b=e==null?void 0:e.usage)!=null&&b.aiImages,(g=e==null?void 0:e.usageLimits)!=null&&g.createdJobs,(u=e==null?void 0:e.usageLimits)!=null&&u.aiImages,t.jsxs("div",{className:"min-h-screen p-6 lg:p-8",children:[t.jsx(G,{children:t.jsx("title",{children:"Subscription & Transactions | GenWrite"})}),t.jsxs("div",{class:"flex-1 mt-5 mb-10 p-2 md:mt-0 md:p-0",children:[t.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Subscription & Transactions"}),t.jsx("p",{className:"text-gray-500 text-sm mt-2 max-w-md",children:"Manage your active subscription, update billing details, and track your past transactions all in one place."})]}),t.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"p-3 md:p-6 bg-white mb-10 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 border border-gray-100",children:[t.jsx("div",{className:"flex items-center space-x-3 mb-6",children:t.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Your Current Plan"})}),t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 border-b pb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4 md:mb-0",children:[t.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center bg-${c?"blue":"green"}-100`,children:t.jsx(L,{className:`w-6 h-6 text-${c?"blue":"green"}-600`})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[t.jsx("span",{className:"capitalize",children:(y=e==null?void 0:e.subscription)==null?void 0:y.plan})," Tier"]}),t.jsx(n,{color:((f=e==null?void 0:e.subscription)==null?void 0:f.status)==="active"?"green":"default",className:"mt-1",children:((w=(j=e==null?void 0:e.subscription)==null?void 0:j.status)==null?void 0:w.toUpperCase())||"INACTIVE"})]})]}),t.jsxs("div",{className:"text-left md:text-right",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Started on:"}),t.jsx("p",{className:"font-semibold text-gray-900",children:(N=e==null?void 0:e.subscription)!=null&&N.startDate?new Date(e.subscription.startDate).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}):"—"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-6 mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3 text-gray-600",children:[t.jsx(q,{className:"w-5 h-5 text-purple-500"}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium block",children:(v=e==null?void 0:e.subscription)!=null&&v.cancelAt?"Cancel At:":"Renews on:"}),t.jsx("span",{className:"text-gray-800 font-semibold text-sm",children:(C=e==null?void 0:e.subscription)!=null&&C.renewalDate?new Date((k=e==null?void 0:e.subscription)!=null&&k.cancelAt?e.subscription.cancelAt:e.subscription.renewalDate).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}):"Free Plan"})]})]}),t.jsxs("div",{className:"flex items-center space-x-3 text-gray-600",children:[t.jsx(X,{className:"w-5 h-5 text-green-500"}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium block",children:"Total Credits:"}),t.jsx("span",{className:"text-gray-800 font-semibold text-sm",children:(e==null?void 0:e.totalCredits)||0})]})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 pt-4 border-t",children:[t.jsxs("button",{className:"flex-1 px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-150 transform hover:scale-[1.01] flex items-center justify-center space-x-2",onClick:()=>o("/pricing"),children:[t.jsx("span",{children:"Upgrade Plan"}),t.jsx(O,{className:"w-4 h-4"})]}),t.jsx("button",{disabled:d,onClick:()=>o("/cancel-subscription"),className:`flex-1 px-4 py-2 font-semibold rounded-lg shadow-sm transition duration-150 
    ${d?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-gray-600 border border-gray-300 hover:bg-gray-50"}`,children:"Cancel Subscription"})]})]}),Object.keys(((D=e==null?void 0:e.subscription)==null?void 0:D.scheduledPlanChange)||{}).length===3&&t.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"p-3 md:p-6 bg-white mb-10 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 border border-gray-100",children:[t.jsx("div",{className:"flex items-center space-x-3 mb-6",children:t.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Your Upcoming Plan"})}),t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 border-b pb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4 md:mb-0",children:[t.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center bg-${c?"blue":"green"}-100`,children:t.jsx(L,{className:`w-6 h-6 text-${e.subscription.scheduledPlanChange.newPlan=="pro"?"blue":"green"}-600`})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-2xl font-bold text-gray-900",children:[t.jsx("span",{className:"capitalize",children:e.subscription.scheduledPlanChange.newPlan})," ","Tier"]}),t.jsx(n,{color:((S=e==null?void 0:e.subscription)==null?void 0:S.status)==="active"?"green":"default",className:"mt-1",children:(P=(T=e==null?void 0:e.subscription)==null?void 0:T.scheduledPlanChange)==null?void 0:P.newBillingPeriod})]})]}),t.jsxs("div",{className:"text-left md:text-right",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Effective on:"}),t.jsx("p",{className:"font-semibold text-gray-900",children:(A=e==null?void 0:e.subscription)!=null&&A.startDate?new Date(((I=e.subscription.scheduledPlanChange)==null?void 0:I.effectiveDate)||e.subscription.renewalDate).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"}):"—"})]})]})]}),t.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.3},className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[t.jsxs("div",{className:"flex flex-row justify-between items-center p-6 border-b",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Q,{className:"w-5 h-5 text-gray-500"}),t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Recent Transactions"})]}),t.jsx(J,{title:"Refresh",children:t.jsx(l.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>i(E()),className:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition text-sm flex items-center justify-center",children:t.jsx(V,{className:"w-4 h-4"})})})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsx(Z,{rowKey:"_id",loading:$,dataSource:_,columns:F,pagination:{pageSize:10,showSizeChanger:!1,showQuickJumper:!1},className:"border-none",rowClassName:(s,a)=>a%2===0?"bg-gray-50 hover:bg-gray-100":"hover:bg-gray-50",locale:{emptyText:"No transactions yet. Your purchase history will appear here."}})})]})]})};export{Se as default};
