import{u as w,a as L,j as r,A as I,H as A,m as E,l as k,s as U,T as z}from"./index-BBfc4_gj.js";import{b as o}from"./chunk-tiptap-BtN4qVNk.js";import{D as F}from"./index-BUsPY3oQ.js";import{I as R}from"./index-HzhWpVZ4.js";import{R as $}from"./SearchOutlined-C_mMV8j8.js";import{S as O}from"./Pagination-BY7XLToj.js";import{F as M}from"./Table-D3vgSLMH.js";import{T as f}from"./index-B5e01JZ4.js";import"./ClockCircleOutlined-CELcQ7Uv.js";import"./Overflow-Cjq-Bl_0.js";import"./useIcons-iC34yILH.js";import"./SearchOutlined-B1D6QA16.js";import"./Input-D-z5y0Ar.js";import"./RightOutlined-BlRDyNon.js";import"./index-ChrYfuU7.js";import"./EllipsisOutlined-C3sVwtaX.js";import"./collapse-BbEVqHco.js";const ae=()=>{const[m,h]=o.useState([]),[y,g]=o.useState([]),[b,j]=o.useState(!0),[l,S]=o.useState(""),[s,D]=o.useState([]),[n,N]=o.useState(null),d=w(),{RangePicker:T}=F,p=L(),[c,x]=o.useState({current:1,pageSize:10}),v=[10,20,50,100];o.useEffect(()=>{(async()=>{try{const t=await k(d);p(N(t==null?void 0:t.user))}catch(t){console.error("User load failed:",t)}})()},[p,d]),o.useEffect(()=>{(async()=>{try{h(n==null?void 0:n.creditLogs),g(n==null?void 0:n.creditLogs)}catch(t){U.error("Failed to load credit logs"),console.error("Failed to load credit logs",t)}finally{j(!1)}})()},[n]),o.useEffect(()=>{let e=m;if(l&&(e=e==null?void 0:e.filter(t=>{var a,i;return(i=(a=t.meta)==null?void 0:a.blogTitle)==null?void 0:i.toLowerCase().includes(l.toLowerCase())})),s&&s.length===2&&s[0]&&s[1]){const t=s[0].startOf("day").toDate(),a=s[1].endOf("day").toDate();e=e.filter(i=>{const u=new Date(i.createdAt);return u>=t&&u<=a})}g(e)},[l,s,m]);const C=[{title:"Date",dataIndex:"createdAt",key:"createdAt",sorter:(e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime(),render:e=>r.jsx("span",{className:"text-sm text-gray-600",children:new Date(e).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"})})},{title:"Type",dataIndex:"type",key:"type",filters:[{text:"Deduction",value:"DEDUCTION"},{text:"Adjustment",value:"ADJUSTMENT"}],onFilter:(e,t)=>t.type===e,render:e=>r.jsx(f,{color:e==="DEDUCTION"?"red":"green",className:"font-medium px-2 py-0.5 rounded-full",children:e})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:(e,t)=>e.amount-t.amount,render:e=>r.jsx("span",{className:`font-semibold ${e<0?"text-red-500":"text-green-600"}`,children:e>0?`+${e}`:e})},{title:"Description",dataIndex:"description",key:"description",render:(e,t)=>{var a;return r.jsxs("div",{className:"text-sm text-gray-800 flex items-center",children:[e,((a=t.meta)==null?void 0:a.error)&&r.jsx(z,{title:t.meta.error,children:r.jsx(f,{color:"volcano",className:"ml-2 cursor-pointer px-2 py-0.5 rounded-full",children:"Error"})})]})}},{title:"Blog",dataIndex:["meta","blogTitle"],key:"blogTitle",render:(e,t)=>{var a,i;return(a=t.meta)!=null&&a.error?"-":r.jsx("span",{onClick:()=>d(`/toolbox/${t.meta.blogId}`),className:"text-blue-500 cursor-pointer hover:underline",children:(i=t.meta)==null?void 0:i.blogTitle})}}];return r.jsxs(I,{children:[r.jsx(A,{children:r.jsx("title",{children:"Credit Logs | GenWrite"})}),r.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.3},className:"p-6 bg-white rounded-2xl shadow-lg border border-gray-100",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Credit Logs"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(R,{prefix:r.jsx($,{className:"text-gray-400"}),placeholder:"Search by blog title",value:l,onChange:e=>S(e.target.value),className:"w-64 rounded-lg border-gray-200 hover:border-blue-300"}),r.jsx(T,{onChange:e=>D(e||[]),className:"rounded-lg border-gray-200 hover:border-blue-300",format:"YYYY-MM-DD"}),r.jsx(O,{value:c.pageSize,onChange:e=>x({...c,pageSize:e}),options:v.map(e=>({label:`${e} / page`,value:e})),style:{width:120}})]})]}),r.jsx(M,{dataSource:y,columns:C,loading:b,rowKey:(e,t)=>`${e.createdAt}-${t}`,pagination:{current:c.current,pageSize:c.pageSize,showSizeChanger:!1,onChange:(e,t)=>{x({current:e,pageSize:t})}},className:"rounded-xl overflow-hidden",rowClassName:"hover:bg-gray-50 transition-colors",bordered:!1,scroll:{x:"max-content"}})]})]})};export{ae as default};
