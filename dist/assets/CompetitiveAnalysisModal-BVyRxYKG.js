var Be=Object.defineProperty,Oe=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var we=(r,l,s)=>l in r?Be(r,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[l]=s,Ne=(r,l)=>{for(var s in l||(l={}))Ke.call(l,s)&&we(r,s,l[s]);if(fe)for(var s of fe(l))We.call(l,s)&&we(r,s,l[s]);return r},ve=(r,l)=>Oe(r,ze(l));var ke=(r,l,s)=>new Promise((c,i)=>{var j=h=>{try{f(s.next(h))}catch(u){i(u)}},k=h=>{try{f(s.throw(h))}catch(u){i(u)}},f=h=>h.done?c(h.value):Promise.resolve(h.value).then(j,k);f((s=s.apply(r,l)).next())});import{r as x,u as Ue,b as Re,a as K,z as $e,M as He,V as Fe,av as Ve,j as e,L as qe,P as Ye,m as p,aB as Ge,C as W,B as Ce,T as U,W as Je,af as Qe}from"./index-BOjYwTQ9.js";import{S as R}from"./index-WfLJFMKX.js";import{I as Xe}from"./index-D46neESn.js";import{T as _}from"./index-Cv4bwi9X.js";import{E as Ze}from"./index-BHYdUTwY.js";import{P as De}from"./progress-DyW103j8.js";import{A as $}from"./activity-DgcI2fgS.js";import{R as es}from"./LoadingOutlined-C0PQZCOI.js";import{C as M,E as Le,L as ss}from"./link-DUL6DIQX.js";const ts=1,as=1.5,ns=2,Me=Object.freeze({analysis:{competitors:10,keywords:1},blog:{quick:10,proofread:5,single:10,regenerate:15},tools:{humanize:10,outline:5,boost:10,metadata:5,rewrite:5},aiImages:10});function Se(r,l="gemini"){const s=r.split(".");let c=s.length===1?Me[r]:Me[s[0]][s[1]];if(!c)throw new Error("Unknown Operation: No cost available");switch(l.toLowerCase()){case"openai":case"chatgpt":c=Math.ceil(as*c);break;case"claude":c=Math.ceil(ns*c);break;case"gemini":default:c=Math.ceil(ts*c)}return c}const{Panel:L}=M,is=({closeFnc:r,open:l})=>{var X,Z,D,ee,se,te,ae,ne,ie,le,re,de,oe,ce,me,xe,he,ge,ue,pe,ye,be;const[s,c]=x.useState({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),[i,j]=x.useState(null),[k,f]=x.useState(null),[h,u]=x.useState(!1),[Ae,b]=x.useState(null),[E,T]=x.useState(0),S=Ue(),Ie=Re(),w=K($e),{handlePopup:_e}=He(),{analysis:P,loading:N}=K(t=>t.analysis),{allBlogs:v,loading:A}=K(t=>t.blog);x.useEffect(()=>{!N&&P&&j(P)},[P,N]),x.useEffect(()=>{l?S(Fe()):(c({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),j(null),f(null),u(!1),b(null),T(0))},[l]),x.useEffect(()=>(l?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[l]),x.useEffect(()=>{k&&(u(!0),S(Ve(k)).unwrap().then(t=>{t!=null&&t._id&&c(a=>ve(Ne({},a),{title:t.title,content:t.content||"",keywords:t.keywords||[],focusKeywords:t.focusKeywords||[],selectedProject:t,contentType:"markdown",generatedMetadata:t.generatedMetadata||null}))}).catch(t=>{console.error("Failed to fetch blog by ID:",t)}).finally(()=>u(!1)))},[k,S]),x.useEffect(()=>{var g,y,C,z,I;const t=O.length>0,a=((y=(g=s==null?void 0:s.generatedMetadata)==null?void 0:g.outboundLinks)==null?void 0:y.length)>0,n=((z=(C=s==null?void 0:s.generatedMetadata)==null?void 0:C.internalLinks)==null?void 0:z.length)>0,o=!!i,d=!!((I=s==null?void 0:s.generatedMetadata)!=null&&I.competitorsAnalysis);b(o?"results":t?"competitors":a||n?"links":d?"initial-analysis":null)},[i,(X=s==null?void 0:s.generatedMetadata)==null?void 0:X.competitors,(Z=s==null?void 0:s.generatedMetadata)==null?void 0:Z.outboundLinks,(D=s==null?void 0:s.generatedMetadata)==null?void 0:D.internalLinks,(ee=s==null?void 0:s.generatedMetadata)==null?void 0:ee.competitorsAnalysis]);const Ee=t=>{const a=v==null?void 0:v.find(n=>n._id===t);a&&(f(a._id),j(null),T(n=>n+1))},Te=()=>ke(null,null,function*(){var n,o,d;if(!s.title.trim()||!s.content.trim()||s.keywords.length===0&&s.focusKeywords.length===0)return;if(s.content.length<500){Je.warning("Your content is too short. This may affect competitive analysis accuracy.");return}const t=Se("analysis.competitors"),a=(((n=w==null?void 0:w.credits)==null?void 0:n.base)||0)+(((o=w==null?void 0:w.credits)==null?void 0:o.extra)||0);if(a<t){_e({title:"Insufficient Credits",description:e.jsxs("div",{children:[e.jsx("p",{children:"You don't have enough credits to run this competitive analysis."}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Required:"})," ",t," credits"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Available:"})," ",a," credits"]})]}),okText:"Buy Credits",onConfirm:()=>{Ie("/pricing"),r()}});return}u(!0);try{const g=yield S(Qe({title:s.title,content:s.content,keywords:[...new Set([...s.keywords,...s.focusKeywords])],contentType:s.contentType,blogId:(d=s==null?void 0:s.selectedProject)==null?void 0:d._id})).unwrap();j(g)}catch(g){console.error("Error fetching analysis:",g)}finally{u(!1)}}),m=t=>t?t.replace(/#{1,3}\s/g,"").replace(/[\*_~`]/g,"").replace(/\n+/g,`
`).trim():"",B=t=>t?m(t).split(`
`).filter(a=>a.trim()!=="").map((a,n)=>e.jsx("p",{className:"mb-2 text-sm md:text-base",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:a.trim().replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},n)):[],Pe=t=>!t||t.length===0?null:e.jsx(M,{accordion:!0,className:"bg-white border border-gray-200 rounded-lg",children:t.map((a,n)=>{var o;return e.jsx(L,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800 truncate max-w-[80%] sm:max-w-[60%] text-sm md:text-base",children:m(a.title)}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0",children:[e.jsx(U,{title:"Relatable Score",children:a.score&&e.jsxs(_,{color:"blue",children:[(a.score*100).toFixed(2),"%"]})}),e.jsxs("a",{href:(o=a==null?void 0:a.link)!=null?o:a==null?void 0:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:d=>d.stopPropagation(),children:["Visit ",e.jsx(Le,{className:"w-4 h-4"})]})]})]}),className:"text-sm md:text-base text-gray-700 leading-relaxed",children:a!=null&&a.content?e.jsx("div",{children:B(a.content)}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-2 font-medium",children:m(a.snippet||a.content)}),e.jsx("div",{children:B(a.summary)})]})},n)})},E),H=(t,a)=>!t||t.length===0?null:e.jsx(W,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded text-blue-500",children:e.jsx(ss,{size:20,strokeWidth:2})}),e.jsx("span",{className:"text-base md:text-lg font-semibold text-gray-800",children:a})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsx(M,{accordion:!0,children:t.map((n,o)=>e.jsxs(L,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center w-full",children:[e.jsx("span",{className:"text-sm md:text-base font-medium text-gray-800",children:m(n.title)}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0",children:[e.jsx(U,{title:"Relatable Score",children:n.score&&e.jsxs(_,{color:"blue",children:[(n.score*100).toFixed(2),"%"]})}),e.jsxs("a",{href:n.link||n.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:d=>d.stopPropagation(),children:["Visit ",e.jsx(Le,{className:"w-4 h-4"})]})]})]}),className:"text-sm md:text-base text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"text-gray-600",children:m(n.snippet||n.content)}),n.summary&&e.jsx("div",{children:B(n.summary)})]},o))},E)}),F=t=>{if(!t)return null;const{analysis:a,suggestions:n}=t;return e.jsx(W,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded text-purple-500",children:e.jsx($,{size:20,strokeWidth:2})}),e.jsx("span",{className:"text-base md:text-lg font-semibold text-gray-800",children:"Competitors Analysis"})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsxs(M,{accordion:!0,expandIconPosition:"right",children:[e.jsx(L,{header:e.jsx("span",{className:"font-semibold text-gray-800 text-sm md:text-base",children:"Analysis"}),children:e.jsx(M,{accordion:!0,children:Object.entries(a).map(([o,d],g)=>{var je;const{score:y,maxScore:C,feedback:z}=d,I=m((je=d==null?void 0:d.feedback)==null?void 0:je.replace(/\s*\(\d+\/\d+\)$/,"").trim());return e.jsx(L,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800 text-sm md:text-base",children:m(o)}),e.jsx(U,{title:"Relatable Score",children:y&&C&&e.jsxs(_,{color:"blue",children:[y,"/",C]})})]}),className:"text-sm md:text-base text-gray-700 leading-relaxed",children:e.jsx("p",{children:I})},o)})})},"analysis"),e.jsx(L,{header:e.jsx("span",{className:"font-semibold text-gray-800 text-sm md:text-base",children:"Suggestions"}),children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm md:text-base text-gray-700",children:(Array.isArray(n)?n:n.split(/(?:\d+\.\s)/)).filter(Boolean).map((o,d)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:m(o.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},d))})},"suggestions")]},E)})},O=x.useMemo(()=>{var d;const t=((d=s==null?void 0:s.generatedMetadata)==null?void 0:d.competitors)||[],a=(i==null?void 0:i.competitors)||[],n=[],o=new Set;return[...t,...a].forEach(g=>{const y=g.url||g.link;o.has(y)||(o.add(y),n.push(g))}),n},[(se=s==null?void 0:s.generatedMetadata)==null?void 0:se.competitors,i==null?void 0:i.competitors]),V=x.useMemo(()=>[...new Set([...s.keywords,...s.focusKeywords])],[s.keywords,s.focusKeywords]),q=O.length>0,Y=((ae=(te=s==null?void 0:s.generatedMetadata)==null?void 0:te.outboundLinks)==null?void 0:ae.length)>0,G=((ie=(ne=s==null?void 0:s.generatedMetadata)==null?void 0:ne.internalLinks)==null?void 0:ie.length)>0,J=!!i,Q=!!((le=s==null?void 0:s.generatedMetadata)!=null&&le.competitorsAnalysis);return h||A||N?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:e.jsx(qe,{})}):e.jsx(Ye,{open:l,title:e.jsxs(p.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-900",children:"Competitive Analysis Dashboard"})]}),onCancel:r,footer:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Estimated Cost:"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[Se("analysis.competitors")," credits"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(Ce,{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition w-full sm:w-auto",children:"Close"}),e.jsx(Ce,{onClick:Te,className:`px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition w-full sm:w-auto ${h||A||N?"opacity-50 cursor-not-allowed":""}`,disabled:h||A||N,children:h||A||N?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(es,{}),i?"Re-Analyzing...":"Analyzing..."]}):i?"Re-Run Analysis":"Run Competitive Analysis"})]})]},"footer")],width:"100%",className:"w-full max-w-[90vw] md:max-w-3xl lg:max-w-4xl",centered:!0,closable:!0,transitionName:"",maskTransitionName:"",styles:{body:{maxHeight:"80vh",overflowY:"auto",padding:"12px sm:16px"}},children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-5",children:[e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("label",{className:"block text-sm md:text-base font-medium text-gray-700 mb-2",children:"Select Blog Post"}),e.jsxs(R,{showSearch:!0,filterOption:(t,a)=>{var n;return(n=a==null?void 0:a.children)==null?void 0:n.toLowerCase().includes(t.toLowerCase())},className:"w-full rounded-md text-sm md:text-base",onChange:Ee,value:((re=s.selectedProject)==null?void 0:re._id)||"",placeholder:"Select a blog",children:[e.jsx(R.Option,{value:"",children:"Select a blog"}),v==null?void 0:v.map(t=>e.jsx(R.Option,{value:t._id,children:t.title.charAt(0).toUpperCase()+t.title.slice(1)},t._id))]})]}),s.selectedProject&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-700",children:"Blog Details"})}),e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("label",{className:"block text-sm md:text-base font-medium text-gray-600 mb-1",children:"Title"}),e.jsx(Xe,{name:"title",value:s.title,readOnly:!0,className:"w-full bg-gray-100 cursor-not-allowed text-sm md:text-base"})]}),V.length>0&&e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("label",{className:"block text-sm md:text-base font-medium text-gray-600 mb-1",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:V.map((t,a)=>e.jsx(_,{className:"flex items-center gap-1 bg-blue-50 text-blue-700 border-blue-100 text-sm",children:m(t)},t))})]}),s.content?e.jsx("div",{className:"text-gray-700 max-h-40 overflow-y-auto whitespace-pre-wrap leading-relaxed p-3 sm:p-4 bg-gray-50 rounded-md text-sm md:text-base",children:m(s.content).split(`
`).map((t,a)=>e.jsx("p",{className:"mt-2",children:t.trim()},a))}):e.jsx(Ze,{description:"No content available for this blog"})]})]}),((de=s.generatedMetadata)==null?void 0:de.seo_meta)&&e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-700",children:"SEO Metadata"})}),e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("p",{className:"text-sm md:text-base text-gray-600",children:[e.jsx("strong",{children:"Title:"})," ",m(s.generatedMetadata.seo_meta.title)]}),e.jsxs("p",{className:"text-sm md:text-base text-gray-600 mt-2",children:[e.jsx("strong",{children:"Description:"})," ",m(s.generatedMetadata.seo_meta.description)]})]})]})]}),!s.selectedProject&&e.jsx(p.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8 sm:py-10 bg-gray-50 rounded-xl border border-gray-200 shadow-sm",children:e.jsx("p",{className:"text-gray-600 text-sm md:text-lg",children:"Select a blog to view details and analysis"})}),(q||Y||G||J||Q)&&e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(Ge,{activeKey:Ae,onChange:t=>{b(t),T(a=>a+1)},type:"card",className:"w-full",children:[J&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"m19 9-5 5-4-4-3 3"})]}),"Analysis Results"]}),children:e.jsxs(p.div,{animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"space-y-4 sm:space-y-6",children:[e.jsxs(p.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},className:"flex flex-col items-center my-10",children:[e.jsx(De,{type:"dashboard",percent:Number((ce=(oe=i.insights)==null?void 0:oe.blogScore)!=null?ce:0),width:120,format:t=>`${t} / 100`,strokeColor:{"0%":"#1B6FC9","100%":"#4C9FE8"},trailColor:"#e5e7eb"}),e.jsx("div",{className:"text-gray-800 text-base md:text-lg font-semibold mt-3",children:"Blog SEO Score"})]}),e.jsx(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.4},children:e.jsx(W,{title:"Suggestions to Beat Competitors",className:"bg-white border border-gray-200 rounded-lg shadow-sm",headStyle:{background:"#f9fafb",fontWeight:600,fontSize:"0.9rem sm:1.1rem"},children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm md:text-base text-gray-700",children:(ue=Array.isArray((me=i==null?void 0:i.insights)==null?void 0:me.suggestions)?(xe=i==null?void 0:i.insights)==null?void 0:xe.suggestions:(ge=(he=i==null?void 0:i.insights)==null?void 0:he.suggestions)==null?void 0:ge.split(/(?:\d+\.\s)/))==null?void 0:ue.filter(Boolean).map((t,a)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:m(t.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},a))})})}),F(i==null?void 0:i.insights)]})},"results"),q&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),"Competitors"]}),children:Pe(O)},"competitors"),(Y||G)&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsx($,{size:20,strokeWidth:2}),"Links"]}),children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[H((pe=s==null?void 0:s.generatedMetadata)==null?void 0:pe.outboundLinks,"Outbound Links"),H((ye=s==null?void 0:s.generatedMetadata)==null?void 0:ye.internalLinks,"Internal Links")]})},"links"),Q&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsx($,{size:20,strokeWidth:2}),"Initial Analysis"]}),children:F((be=s==null?void 0:s.generatedMetadata)==null?void 0:be.competitorsAnalysis)},"initial-analysis")]})})]})})},ps=Object.freeze(Object.defineProperty({__proto__:null,default:is},Symbol.toStringTag,{value:"Module"}));export{is as C,ps as a,Se as g};
