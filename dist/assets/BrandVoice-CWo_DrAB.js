import{aG as H,aN as E,aK as I,j as e,aL as i,aJ as u}from"./index-D86GYfJ-.js";import{b as p}from"./chunk-tiptap-JX9QK0Ia.js";import{b as K,c as T}from"./index-B5x-4YyG.js";import"./iconBase-XDJ6T7v5.js";const q=()=>{H(),E();const g=I(a=>a.auth.user),[t,o]=p.useState({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null}),[m,x]=p.useState(""),[w,d]=p.useState(!1),[v,j]=p.useState([]),y=async()=>{try{const a=await u.get("/brand");let s=Array.isArray(a.data)?a.data:a.data?[a.data]:[];console.log("Fetched brands:",s),j(s),s.length>0&&!t.selectedVoice&&o(l=>({...l,selectedVoice:s[0]}))}catch{j([])}};p.useEffect(()=>{y()},[]);const B=a=>{o({nameOfVoice:a.nameOfVoice,postLink:a.postLink,keywords:Array.isArray(a.keywords)?a.keywords:[],describeBrand:a.describeBrand,selectedVoice:a,uploadedFile:null,_id:a._id})},F=async()=>{var a,s,l,c,f,h,n,N,k;try{d(!0);const r={nameOfVoice:(a=t.nameOfVoice)==null?void 0:a.trim(),postLink:(s=t.postLink)==null?void 0:s.trim(),keywords:Array.isArray(t.keywords)?t.keywords.map(D=>String(D).trim()).filter(Boolean):[],describeBrand:(l=t.describeBrand)==null?void 0:l.trim(),userId:g==null?void 0:g._id};if(!r.nameOfVoice||!r.postLink||!r.describeBrand||r.keywords.length===0){d(!1),alert("All fields are required and at least one keyword must be provided.");return}try{new URL(r.postLink)}catch{d(!1),alert("Please enter a valid URL for the post link.");return}let V;t._id?V=await u.put(`/brand/${t._id}`,r):V=await u.post("/brand/addBrand",r),d(!1),y(),o({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null,_id:void 0})}catch(r){d(!1),alert(((f=(c=r==null?void 0:r.response)==null?void 0:c.data)==null?void 0:f.message)||((k=(N=(n=(h=r==null?void 0:r.response)==null?void 0:h.data)==null?void 0:n.errors)==null?void 0:N[0])==null?void 0:k.msg)||"Failed to save brand voice. Please check your input.")}},L=async a=>{try{await u.delete(`/brand/${a._id}`),y(),t.selectedVoice&&t.selectedVoice._id===a._id&&o(s=>({...s,selectedVoice:null}))}catch{alert("Failed to delete brand voice.")}},b=a=>{const{name:s,value:l}=a.target;o({...t,[s]:l})},C=a=>{o(s=>({...s,selectedVoice:a}))},S=a=>{const s=a.target.files[0];if(s&&s.type==="text/csv"){const l=new FileReader;l.onload=c=>{let h=c.target.result.split(/,|\n|;/).map(n=>n.trim()).filter(n=>n.length>0);o(n=>({...n,uploadedFile:s.name,keywords:Array.from(new Set([...n.keywords,...h]))}))},l.readAsText(s)}},_=a=>{a.key==="Enter"&&m.trim()&&(o({...t,keywords:[...t.keywords,m.trim()]}),x(""))},O=a=>{o({...t,keywords:t.keywords.filter(s=>s!==a)})},A=()=>{const a=t.keywords.slice(-3),s=t.keywords.length-a.length;return e.jsxs(e.Fragment,{children:[s>0&&e.jsx(i.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{scale:.8},animate:{scale:1},children:e.jsx("span",{className:"text-sm",children:`+${s}`})}),a.map((l,c)=>e.jsxs(i.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},whileHover:{scale:1.05},children:[e.jsx("span",{className:"text-sm",children:l}),e.jsx(K,{className:"ml-1 cursor-pointer text-indigo-500 hover:text-indigo-700 transition-colors",onClick:()=>O(l)})]},c))]})};return e.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-8 justify-around p-6",children:[e.jsxs(i.div,{className:"w-[60%] bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:-20},animate:{x:0},children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Letâ€™s create your Brand Voice"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Prototype group pixel duplicate ellipse hand draft style rotate. Layout follower scale comment flows draft select."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Name of Voice"}),e.jsx(i.input,{type:"text",name:"nameOfVoice",value:t.nameOfVoice,onChange:b,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Paste link of your post or blog *"}),e.jsx(i.input,{type:"text",name:"postLink",value:t.postLink,onChange:b,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{className:"text-center my-4 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-4 text-gray-500",children:"OR"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Keywords*"}),e.jsxs(i.div,{className:"flex items-center bg-white border border-gray-300 rounded-lg p-2 flex-wrap gap-2",whileHover:{boxShadow:"0 0 0 3px rgba(99, 102, 241, 0.2)"},children:[A(),e.jsx("input",{type:"text",value:m,onChange:a=>x(a.target.value),onKeyDown:_,className:"flex-grow p-2 bg-white border-none outline-none rounded-l-md",placeholder:"e.g., Fun"}),e.jsx("label",{htmlFor:"file-upload",className:"flex items-center cursor-pointer",children:e.jsx(i.div,{className:"bg-indigo-100 p-2 rounded-lg",whileHover:{scale:1.1},whileTap:{scale:.95},children:e.jsx("img",{src:"./Images/upload.png",alt:"Upload",className:"w-6 h-6"})})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:S,accept:".csv"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Describe your Brand"}),e.jsx(i.textarea,{name:"describeBrand",value:t.describeBrand,onChange:b,placeholder:"Write a blog on how to cook pasta",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:"4",whileFocus:{scale:1.01}})]}),e.jsx("div",{className:"text-right",children:e.jsx(i.button,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-3 rounded-lg font-medium shadow-md hover:shadow-lg transition-all",onClick:F,whileHover:{scale:1.03,y:-2},whileTap:{scale:.98},children:"Save Brand Voice"})})]})]}),e.jsx("div",{className:"h-auto w-px bg-gray-200 mx-2"}),e.jsxs(i.div,{className:"flex-1 bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:20},animate:{x:0},children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-4",children:"Your Brand Voices"}),e.jsx("div",{className:"mb-8 space-y-4 overflow-y-auto p-2",children:v.length>0?v.map(a=>{var s;return e.jsx(R,{id:a._id,brandName:a.nameOfVoice,brandVoice:a.describeBrand,onSelect:()=>C(a),isSelected:((s=t.selectedVoice)==null?void 0:s._id)===a._id,onEdit:()=>B(a),onDelete:()=>L(a)},a._id)}):e.jsx("div",{className:"p-6 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center text-gray-500",children:"No brand voices created yet."})})]})]})},R=({id:g,brandName:t,brandVoice:o,onSelect:m,isSelected:x,onEdit:w,onDelete:d})=>e.jsxs(i.div,{className:`p-4 rounded-xl cursor-pointer transition-all ${x?"bg-gradient-to-r from-indigo-100 to-purple-100 border-2 border-indigo-300 shadow-md":"bg-white border border-gray-200 hover:border-indigo-300"}`,onClick:m,whileHover:{y:-3,boxShadow:"0 4px 12px rgba(99, 102, 241, 0.1)"},whileTap:{scale:.98},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:`font-medium ${x?"text-indigo-700":"text-gray-700"}`,children:t}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(i.button,{className:"text-indigo-500 hover:text-indigo-700",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:w,children:e.jsx(T,{})}),e.jsx(i.button,{className:"text-gray-500 hover:text-red-500",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:d,children:e.jsx("img",{src:"/Images/trash.png",alt:"Delete",className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:o.length>100?`${o.substring(0,100)}...`:o})]});export{q as default};
