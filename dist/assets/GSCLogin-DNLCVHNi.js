var f=(s,a,t)=>new Promise((l,i)=>{var d=e=>{try{n(t.next(e))}catch(c){i(c)}},r=e=>{try{n(t.throw(e))}catch(c){i(c)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(d,r);n((t=t.apply(s,a)).next())});import{j as o}from"./tiptap-BabmW22p.js";import{u as x}from"./SearchConsole-CBi4zBgx.js";import{b as g}from"./vendor-CcjAMWu8.js";import{F as w}from"./index-CuimNUuV.js";import{s as h,p as C,B as b}from"./antd-8WQTeuab.js";import{c as v}from"./index-CHEUOGl9.js";import"./useAuthStore-CU2rUJjR.js";import"./DataLayer-DALerVhB.js";import"./react-wNxFir7h.js";import"./useQuery-CEoF32mJ.js";import"./fuse-CLoWdkAE.js";import"./download-DHTy5sqT.js";import"./refresh-cw-C9vuQMbq.js";import"./search-Csb6xL5U.js";import"./iconBase-jLLagxb6.js";import"./utils-DIb0lvMo.js";const y=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],j=v("log-in",y),O=()=>{const[s,a]=g.useState(!1),[t,l]=g.useState(null),{fetchGscAuthUrl:i}=x(),d=g.useCallback(()=>f(null,null,function*(){try{a(!0);const r=yield i(),n=window.open(r,"GSC Connect","width=600,height=600");if(!n)throw new Error("Popup blocked. Please allow popups and try again.");const e=setInterval(()=>{n.closed&&(clearInterval(e),window.removeEventListener("message",m),a(!1))},1e3),c=new URL("http://localhost:8000").origin,m=u=>{if(u.origin!==c)return;const p=u.data||{};p==="GSC Connected"?(h.success("Google Search Console connected!"),clearInterval(e),window.location.reload()):(h.error(p||"Authentication failed"),l(p||"Authentication failed")),window.removeEventListener("message",m)};window.addEventListener("message",m)}catch(r){h.error(r.message||"Failed to connect to Google Search Console"),l(r.message||"Connection failed"),a(!1)}}),[i]);return o.jsx(C,{align:"center",justify:"center",className:"h-[80vh] p-6",children:o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center border border-gray-200",children:[o.jsx(w,{size:48,className:"mx-auto mb-4"}),o.jsx("h2",{className:"text-2xl font-bold mb-4 text-gray-900",children:"Connect Google Search Console"}),o.jsx("p",{className:"text-gray-600 mb-6",children:"Link your Google Search Console account to view performance data."}),t&&o.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg mb-4 text-sm",children:t}),o.jsx(b,{onClick:d,disabled:s,icon:o.jsx(j,{className:"!size-5 mr-2"}),type:"primary",loading:s,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:!bg-gradient-to-l rounded-lg h-12 text-lg font-medium tracking-wider",children:s?"Connecting...":"Connect GSC"})]})})};export{O as default};
