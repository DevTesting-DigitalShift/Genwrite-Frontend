import{r as o,I as ve,ak as Me,al as Oe,W as Pe,u as Se,a as he,Z as Ae,j as e,M as Ie,Q as Ee,m as g,E as xe,ae as Te}from"./index-aYFSkxCW.js";import{C as k,g as Be}from"./getEstimatedCost-CYSFKpQM.js";import{S as W,E as Ke}from"./index-ChoG752t.js";import{I as Re}from"./index-BUi2m1PB.js";import{T as H}from"./index-D7qzkbYs.js";import{T as be,C as F}from"./index-CWPAISNR.js";import{P as $e}from"./progress-CIkg_n8f.js";import{E as ge}from"./external-link-B3qc1un9.js";function V(){return V=Object.assign?Object.assign.bind():function(i){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(i[h]=r[h])}return i},V.apply(this,arguments)}const ze=(i,a)=>o.createElement(ve,V({},i,{ref:a,icon:Me})),at=o.forwardRef(ze);function q(){return q=Object.assign?Object.assign.bind():function(i){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var h in r)Object.prototype.hasOwnProperty.call(r,h)&&(i[h]=r[h])}return i},q.apply(this,arguments)}const De=(i,a)=>o.createElement(ve,q({},i,{ref:a,icon:Oe})),We=o.forwardRef(De);var He=Object.defineProperty,Fe=Object.defineProperties,Ve=Object.getOwnPropertyDescriptors,pe=Object.getOwnPropertySymbols,qe=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable,ye=(i,a,r)=>a in i?He(i,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[a]=r,fe=(i,a)=>{for(var r in a||(a={}))qe.call(a,r)&&ye(i,r,a[r]);if(pe)for(var r of pe(a))Ue.call(a,r)&&ye(i,r,a[r]);return i},je=(i,a)=>Fe(i,Ve(a)),Ye=(i,a,r)=>new Promise((h,w)=>{var C=x=>{try{f(r.next(x))}catch(j){w(j)}},L=x=>{try{f(r.throw(x))}catch(j){w(j)}},f=x=>x.done?h(x.value):Promise.resolve(x.value).then(C,L);f((r=r.apply(i,a)).next())});const{Panel:_}=k,{TabPane:A}=be,lt=({closeFnc:i,open:a,blogs:r})=>{var h,w,C,L,f,x,j,U,Y,Q,Z,G,J,X,ee,te,se,ne;const[s,I]=o.useState({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),[c,M]=o.useState(null),[E,ae]=o.useState(null),[O,N]=o.useState(!1),[we,p]=o.useState(null),[T,B]=o.useState(0),{handlePopup:Ne}=Pe(),K=Se(),{analysis:R,loading:v}=he(t=>t.analysis),{blog:Qe,loading:P}=he(t=>t.blog);o.useEffect(()=>{!v&&R&&M(R)},[R,v]),o.useEffect(()=>{a||(I({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),M(null),ae(null),N(!1),p(null),B(0))},[a]),o.useEffect(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[a]),o.useEffect(()=>{E&&(N(!0),K(Ae(E)).unwrap().then(t=>{t!=null&&t._id&&I(n=>je(fe({},n),{title:t.title,content:t.content||"",keywords:t.keywords||[],focusKeywords:t.focusKeywords||[],selectedProject:t,contentType:"markdown",generatedMetadata:t.generatedMetadata||null}))}).catch(t=>{}).finally(()=>N(!1)))},[E,K]),o.useEffect(()=>{var t,n,l,d,u;const b=z.length>0,y=((n=(t=s==null?void 0:s.generatedMetadata)==null?void 0:t.outboundLinks)==null?void 0:n.length)>0,S=((d=(l=s==null?void 0:s.generatedMetadata)==null?void 0:l.internalLinks)==null?void 0:d.length)>0,D=!!c,Le=!!((u=s==null?void 0:s.generatedMetadata)!=null&&u.competitorsAnalysis);p(D?"results":b?"competitors":y||S?"links":Le?"initial-analysis":null)},[c,(h=s==null?void 0:s.generatedMetadata)==null?void 0:h.competitors,(w=s==null?void 0:s.generatedMetadata)==null?void 0:w.outboundLinks,(C=s==null?void 0:s.generatedMetadata)==null?void 0:C.internalLinks,(L=s==null?void 0:s.generatedMetadata)==null?void 0:L.competitorsAnalysis]);const _e=t=>{const n=r.find(l=>l._id===t);n&&(ae(n._id),I(l=>je(fe({},l),{title:n.title,content:n.content||"",keywords:n.keywords||[],focusKeywords:n.focusKeywords||[],selectedProject:n,contentType:"markdown",generatedMetadata:null})),M(null),B(l=>l+1))},ke=()=>{s.title.trim()&&s.content.trim()&&(s.keywords.length===0&&s.focusKeywords.length===0||Ne({title:"Analyze Competitors",description:e.jsxs("p",{children:["Competitive Analysis cost: ",e.jsxs("b",{children:[Be("analysis.competitors")," credits"]}),e.jsx("br",{}),"Do you wish to proceed?"]}),onConfirm:()=>Ye(null,null,function*(){var t;N(!0);try{const n=yield K(Te({title:s.title,content:s.content,keywords:[...new Set([...s.keywords,...s.focusKeywords])],contentType:s.contentType,blogId:(t=s==null?void 0:s.selectedProject)==null?void 0:t._id})).unwrap();M(n)}catch(n){}finally{N(!1)}})}))},m=t=>t?t.replace(/#{1,3}\s/g,"").replace(/[\*_~`]/g,"").replace(/\n+/g,`
`).trim():"",$=t=>t?m(t).split(`
`).filter(n=>n.trim()!=="").map((n,l)=>e.jsx("p",{className:"mb-2",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:n.trim().replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},l)):[],Ce=t=>!t||t.length===0?null:e.jsx(k,{accordion:!0,className:"bg-white border border-gray-200 rounded-lg",children:t.map((n,l)=>{var d;return e.jsx(_,{header:e.jsxs("div",{className:"flex justify-between items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800 truncate max-w-[60%]",children:m(n.title)}),e.jsxs("div",{className:"flex items-center gap-2",children:[n.score&&e.jsxs(H,{color:"blue",children:[(n.score*100).toFixed(2),"%"]}),e.jsxs("a",{href:(d=n==null?void 0:n.link)!=null?d:n==null?void 0:n.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:u=>u.stopPropagation(),children:["Visit ",e.jsx(ge,{className:"w-4 h-4"})]})]})]}),className:"text-sm text-gray-700 leading-relaxed",children:n!=null&&n.content?e.jsx("div",{children:$(n.content)}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-2 font-medium",children:m(n.snippet||n.content)}),e.jsx("div",{children:$(n.summary)})]})},l)})},T),le=(t,n)=>!t||t.length===0?null:e.jsx(F,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded text-blue-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]})}),e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:n})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsx(k,{accordion:!0,children:t.map((l,d)=>e.jsxs(_,{header:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("span",{className:"text-sm font-medium text-gray-800",children:m(l.title)}),e.jsxs("a",{href:l.link||l.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:u=>u.stopPropagation(),children:["Visit ",e.jsx(ge,{className:"w-4 h-4"})]})]}),className:"text-sm text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"text-gray-600",children:m(l.snippet||l.content)}),l.summary&&e.jsx("div",{children:$(l.summary)})]},d))},T)}),re=t=>{if(!t)return null;const{analysis:n,suggestions:l}=t;return e.jsx(F,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded text-purple-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]})}),e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"Competitors Analysis"})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsxs(k,{accordion:!0,expandIconPosition:"right",children:[e.jsx(_,{header:e.jsx("span",{className:"font-semibold text-gray-800",children:"Analysis"}),children:e.jsx(k,{accordion:!0,children:Object.entries(n).map(([d,u],b)=>{const y=u.match(/\((\d+\/\d+)\)$/),S=y?y[1]:null,D=m(u.replace(/\s*\(\d+\/\d+\)$/,"").trim());return e.jsx(_,{header:e.jsxs("div",{className:"flex justify-between items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800",children:m(d)}),S&&e.jsx(H,{color:"blue",children:S.replace("/"," / ")})]}),className:"text-sm text-gray-700 leading-relaxed",children:e.jsx("p",{children:D})},d)})})},"analysis"),e.jsx(_,{header:e.jsx("span",{className:"font-semibold text-gray-800",children:"Suggestions"}),children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm text-gray-700",children:l.split(/(?:\d+\.\s)/).filter(Boolean).map((d,u)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:m(d.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},u))})},"suggestions")]},T)})},z=o.useMemo(()=>{var t;const n=((t=s==null?void 0:s.generatedMetadata)==null?void 0:t.competitors)||[],l=(c==null?void 0:c.competitors)||[],d=[],u=new Set;return[...n,...l].forEach(b=>{const y=b.url||b.link;u.has(y)||(u.add(y),d.push(b))}),d},[(f=s==null?void 0:s.generatedMetadata)==null?void 0:f.competitors,c==null?void 0:c.competitors]),ie=o.useMemo(()=>[...new Set([...s.keywords,...s.focusKeywords])],[s.keywords,s.focusKeywords]),oe=z.length>0,de=((j=(x=s==null?void 0:s.generatedMetadata)==null?void 0:x.outboundLinks)==null?void 0:j.length)>0,ce=((Y=(U=s==null?void 0:s.generatedMetadata)==null?void 0:U.internalLinks)==null?void 0:Y.length)>0,ue=!!c,me=!!((Q=s==null?void 0:s.generatedMetadata)!=null&&Q.competitorsAnalysis);return O||P||v?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:e.jsx(Ie,{})}):e.jsx(Ee,{open:a,title:e.jsxs(g.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Competitive Analysis Dashboard"})]}),onCancel:i,footer:[e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(xe,{onClick:i,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition",children:"Close"}),e.jsx(xe,{onClick:ke,className:`px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition ${O||P||v?"opacity-50 cursor-not-allowed":""}`,disabled:O||P||v,children:O||P||v?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(We,{}),c?"Re-Analyzing...":"Analyzing..."]}):c?"Re-Run Analysis":"Run Competitive Analysis"})]},"footer")],width:1e3,centered:!0,closable:!0,transitionName:"",maskTransitionName:"",bodyStyle:{maxHeight:"85vh",overflowY:"auto",padding:"16px"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Blog Post"}),e.jsxs(W,{showSearch:!0,filterOption:(t,n)=>{var l;return(l=n==null?void 0:n.children)==null?void 0:l.toLowerCase().includes(t.toLowerCase())},className:"w-full rounded-md text-sm",onChange:_e,value:((Z=s.selectedProject)==null?void 0:Z._id)||"",dropdownStyle:{maxHeight:200,overflowY:"auto"},placeholder:"Select a blog",children:[e.jsx(W.Option,{value:"",children:"Select a blog"}),r.map(t=>e.jsx(W.Option,{value:t._id,children:t.title.charAt(0).toUpperCase()+t.title.slice(1)},t._id))]})]}),s.selectedProject&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Blog Details"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Title"}),e.jsx(Re,{name:"title",value:s.title,readOnly:!0,className:"w-full bg-gray-100 cursor-not-allowed"})]}),ie.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ie.map((t,n)=>e.jsx(H,{className:"flex items-center gap-1 bg-blue-50 text-blue-700 border-blue-100",children:m(t)},t))})]}),s.content?e.jsx("div",{className:"text-gray-700 max-h-40 overflow-y-auto whitespace-pre-wrap leading-relaxed p-4 bg-gray-50 rounded-md",children:m(s.content).split(`
`).map((t,n)=>e.jsx("p",{className:"text-base mt-2",children:t.trim()},n))}):e.jsx(Ke,{description:"No content available for this blog"})]})]}),((G=s.generatedMetadata)==null?void 0:G.seo_meta)&&e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"SEO Metadata"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Title:"})," ",m(s.generatedMetadata.seo_meta.title)]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[e.jsx("strong",{children:"Description:"})," ",m(s.generatedMetadata.seo_meta.description)]})]})]})]}),!s.selectedProject&&e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-10 bg-gray-50 rounded-xl border border-gray-200 shadow-sm",children:e.jsx("p",{className:"text-gray-600 text-lg",children:"Select a blog to view details and analysis"})}),(oe||de||ce||ue||me)&&e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(be,{activeKey:we,onChange:t=>{p(t),B(n=>n+1)},type:"card",children:[ue&&e.jsx(A,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"m19 9-5 5-4-4-3 3"})]}),"Analysis Results"]}),children:e.jsxs(g.div,{animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"space-y-6",children:[e.jsxs(g.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},className:"flex flex-col items-center",children:[e.jsx($e,{type:"dashboard",percent:parseInt(((J=c.insights)==null?void 0:J.blogScore)||0),format:t=>`${t} / 100`,strokeColor:{"0%":"#1B6FC9","100%":"#4C9FE8"},trailColor:"#e5e7eb",size:"large"}),e.jsx("div",{className:"text-gray-800 text-lg font-semibold mt-3",children:"Blog SEO Score"})]}),e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.4},children:e.jsx(F,{title:"Suggestions to Beat Competitors",className:"bg-white border border-gray-200 rounded-lg shadow-sm",headStyle:{background:"#f9fafb",fontWeight:600,fontSize:"1.1rem"},children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm text-gray-700",children:(ee=(X=c==null?void 0:c.insights)==null?void 0:X.suggestions)==null?void 0:ee.split(/(?:\d+\.\s)/).filter(Boolean).map((t,n)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:m(t.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},n))})})}),re(c==null?void 0:c.insights)]})},"results"),oe&&e.jsx(A,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),"Competitors"]}),children:Ce(z)},"competitors"),(de||ce)&&e.jsx(A,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),"Links"]}),children:e.jsxs("div",{className:"space-y-6",children:[le((te=s==null?void 0:s.generatedMetadata)==null?void 0:te.outboundLinks,"Outbound Links"),le((se=s==null?void 0:s.generatedMetadata)==null?void 0:se.internalLinks,"Internal Links")]})},"links"),me&&e.jsx(A,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]}),"Initial Analysis"]}),children:re((ne=s==null?void 0:s.generatedMetadata)==null?void 0:ne.competitorsAnalysis)},"initial-analysis")]})})]})})};export{lt as C,We as R,at as a};
