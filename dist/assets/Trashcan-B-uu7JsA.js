var G=(d,n,r)=>new Promise((T,x)=>{var C=a=>{try{p(r.next(a))}catch(j){x(j)}},m=a=>{try{p(r.throw(a))}catch(j){x(j)}},p=a=>a.done?T(a.value):Promise.resolve(a.value).then(C,m);p((r=r.apply(d,n)).next())});import{r as c,a6 as te,u as se,J as ae,aM as le,j as e,H as re,m as o,E as $,T as ie,a3 as g,b3 as oe,b4 as ne,b5 as ce}from"./index-BE9YYjUk.js";import{b as de}from"./SkeletonLoader-QFGOkre7.js";import{l as me}from"./lodash-D_JTEKKo.js";import{h as O}from"./moment-DUzS6KbO.js";import{u as he}from"./useQuery-V_tnKTjJ.js";import{u as H}from"./useMutation-BvK1CkU_.js";import{R as ue}from"./refresh-ccw-Mm4rkNgk.js";import{T as ge,B as xe}from"./index-CXM3o_-h.js";import{I as pe}from"./index-CtF3hR5O.js";import{S as fe}from"./search-Cud2ta0-.js";import{S as L}from"./index-iDS2nlFK.js";import{P as be}from"./index-CxGRsmJy.js";import{R as ye}from"./QuestionCircleOutlined-C3nXcd3-.js";import{P as je}from"./Pagination-93am7vPg.js";import"./createLucideIcon-Bh0P6Kq2.js";import"./Input-M35Z_RO-.js";import"./useIcons-CNE7EQQu.js";import"./Overflow-CNVITfVQ.js";import"./index-COvitVBY.js";import"./LeftOutlined-dn2M7zA5.js";const{Search:we}=pe,{Option:S}=L,ze=()=>{const[d,n]=c.useState(1),[r,T]=c.useState(15),[x,C]=c.useState(""),[m,p]=c.useState("all"),[a,j]=c.useState([null,null]),{handlePopup:_}=te(),P=se(),D=ae(),B=le(),z=85,q=[10,15,20,50],Q=c.useCallback(me.debounce(t=>{C(t),n(1)},500),[]),{data:h,isLoading:u}=he({queryKey:["trashedBlogs",m,x,a,d,r],queryFn:()=>G(null,null,function*(){const t={isArchived:!0,status:m!=="all"?m:void 0,q:x||void 0,start:a[0]?O(a[0]).toISOString():void 0,end:a[1]?O(a[1]).toISOString():void 0,page:d,limit:r},s=yield ce(t);return{trashedBlogs:s.data||[],totalBlogs:s.totalItems||0}}),keepPreviousData:!0,staleTime:300*1e3,cacheTime:600*1e3}),k=(h==null?void 0:h.trashedBlogs)||[],E=(h==null?void 0:h.totalBlogs)||0,U=H({mutationFn:t=>P(ne(t)).unwrap(),onSuccess:()=>{B.invalidateQueries(["trashedBlogs"]),g.success("Blog restored successfully")},onError:t=>{console.error("Failed to restore blog:",t),g.error("Failed to restore blog. Please try again.")}}),K=H({mutationFn:()=>P(oe()).unwrap(),onSuccess:()=>{B.invalidateQueries(["trashedBlogs"]),n(1),g.success("All trashed blogs deleted successfully")},onError:t=>{console.error("Failed to delete all blogs:",t),g.error("Failed to delete all blogs. Please try again.")}});c.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[d]);const R=(t,s=z)=>t?t.length>s?t.substring(0,s)+"...":t:"",F=t=>{var s,f,i;return(i=(f=(s=t==null?void 0:t.replace(/<[^>]*>/g,""))==null?void 0:s.replace(/[\\*#=_~`>\-]+/g,""))==null?void 0:f.replace(/\s{2,}/g," "))==null?void 0:i.trim()},V=t=>{U.mutate(t)},W=()=>{K.mutate()},Y=()=>{B.invalidateQueries(["trashedBlogs"]),g.info("Blog list refreshed")},I=t=>{g.info(`Clicked on blog: ${t.title}`)},Z=t=>{D(`/blog-editor/${t._id}`)};return e.jsxs("div",{className:"p-5",children:[e.jsx(re,{children:e.jsx("title",{children:"Trashcan | GenWrite"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mb-6",children:[e.jsx(o.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4},className:"text-3xl sm:text-4xl font-extrabold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Trashcan"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx($,{type:"default",icon:e.jsx(ue,{className:"w-4 h-4"}),onClick:Y,disabled:u,children:"Refresh"})}),k.length>0&&e.jsx(o.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx($,{type:"default",icon:e.jsx(ge,{className:"w-4 h-4"}),onClick:()=>_({title:"Delete All Trashed Blogs",description:e.jsxs("span",{className:"my-2",children:["All trashed blogs will be ",e.jsx("b",{children:"permanently deleted"}),". This action cannot be undone."]}),confirmText:"Delete All",onConfirm:W,confirmProps:{className:"border-red-500 hover:bg-red-500 hover:text-white"},cancelProps:{danger:!1}}),disabled:u,children:"Delete All"})})]})]}),e.jsx(o.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"text-gray-600 text-sm sm:text-base max-w-xl mb-6",children:"Restore valuable work or permanently delete clutter. Trashed items are deleted after 7 days."}),e.jsx(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},className:"bg-white/90 backdrop-blur-md rounded-xl shadow-sm border border-gray-100 p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(we,{placeholder:"Search by title or keywords...",onChange:t=>Q(t.target.value),prefix:e.jsx(fe,{className:"w-5 h-5 text-gray-400 mr-2"}),allowClear:!0,className:"w-full rounded-lg",disabled:u}),e.jsxs(L,{value:m,onChange:t=>{p(t),n(1)},className:"w-full sm:w-1/4 rounded-lg",placeholder:"Filter by status",disabled:u,children:[e.jsx(S,{value:"all",children:"All Statuses"}),e.jsx(S,{value:"complete",children:"Complete"}),e.jsx(S,{value:"failed",children:"Failed"}),e.jsx(S,{value:"pending",children:"Pending"})]})]})}),u?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:[...Array(r)].map((t,s)=>e.jsx("div",{className:"bg-white shadow-md rounded-xl p-4",children:e.jsx(de,{})},s))}):k.length===0?e.jsxs(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4},className:"flex flex-col justify-center items-center",style:{minHeight:"calc(100vh - 250px)"},children:[e.jsx("img",{src:"Images/trash-can.png",alt:"Trash",style:{width:"8rem"}}),e.jsx("p",{className:"text-xl mt-5 text-gray-600",children:"No trashed blogs available."})]}):e.jsxs(e.Fragment,{children:[e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 p-2",children:k.map(t=>{const s=t.isManuallyEdited===!0,{_id:f,title:i,status:l,createdAt:J,content:M,aiModel:b,focusKeywords:A,wordpress:w,archiveDate:X,agendaJob:v}=t,N=/gemini/gi.test(b);return e.jsx(xe.Ribbon,{text:e.jsx("span",{className:"flex items-center justify-center gap-1 py-1 font-medium tracking-wide",children:s?e.jsx(e.Fragment,{children:"Manually Generated"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`./Images/${N?"gemini":b==="claude"?"claude":"chatgpt"}.png`,alt:N?"Gemini":b==="claude"?"Claude":"ChatGPT",width:20,height:20,loading:"lazy",className:"bg-white"}),N?"Gemini 2.0 flash":b==="claude"?"Claude 4 sonnet":"Gpt 4.1 nano"]})}),className:"absolute top-0",color:s?"#9CA3AF":N?"#4796E3":b==="claude"?"#9368F8":"#74AA9C",children:e.jsxs("div",{className:`bg-white shadow-md hover:shadow-xl transition-all duration-300 rounded-xl p-4 min-h-[180px] min-w-[390px] relative ${s?"border-gray-500":l==="failed"?"border-red-500":l==="pending"||l==="in-progress"?"border-yellow-500":"border-green-500"} border-2`,title:i,children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 -mt-2",children:new Date(J).toLocaleDateString("en-US",{dateStyle:"medium"})}),s?e.jsx("div",{className:"cursor-pointer",onClick:()=>Z(t),role:"button",tabIndex:0,onKeyDown:y=>y.key==="Enter"&&D("/blog-editor"),"aria-label":`View blog ${i}`,children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg capitalize font-semibold text-gray-900 !text-left max-w-76",children:i}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:R(F(M))||""})]})}):e.jsx(ie,{title:l==="complete"?i:l==="failed"?"Blog generation failed":l==="pending"?`Pending Blog will be generated ${v!=null&&v.nextRunAt?"at "+new Date(v.nextRunAt).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"shortly"}`:`Blog generation is ${l}`,color:l==="complete"?"green":l==="failed"?"red":"#eab308",children:e.jsx("div",{className:"cursor-pointer",onClick:()=>{(l==="complete"||l==="failed")&&I(t)},role:"button",tabIndex:0,onKeyDown:y=>y.key==="Enter"&&(l==="complete"||l==="failed")&&I(t),"aria-label":`View blog ${i}`,children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg capitalize font-semibold text-gray-900 !text-left max-w-76",children:i}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:R(F(M))||""})]})})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:A==null?void 0:A.map((y,ee)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:y},ee))}),e.jsx(be,{title:"Restore Blog",description:"Are you sure to restore this blog?",icon:e.jsx(ye,{style:{color:"red"}}),okText:"Yes",cancelText:"No",onConfirm:()=>V(f),children:e.jsx(o.div,{whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx("img",{src:"Images/restore.svg",alt:"Restore",width:"20",height:"20",className:"cursor-pointer restore-icon"})})})]}),e.jsxs("div",{className:"mt-3 mb-2 flex justify-end text-xs text-right text-gray-500 font-medium",children:[(w==null?void 0:w.postedOn)&&e.jsxs("span",{children:["Posted on:",new Date(w.postedOn).toLocaleDateString("en-US",{dateStyle:"medium"})]}),e.jsxs("span",{className:"block -mb-2 text-sm text-right",children:["Archive Date:"," ",new Date(X).toLocaleDateString("en-US",{dateStyle:"medium"})]})]})]})},f)})}),E>15&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4,delay:.3},className:"flex justify-center mt-6",children:e.jsx(je,{current:d,pageSize:r,total:E,pageSizeOptions:q.filter(t=>t<=100),onChange:(t,s)=>{n(t),s!==r&&(T(s),n(1))},showSizeChanger:!1,showTotal:t=>`Total ${t} blogs`,responsive:!0,disabled:u})})]})]})]})};export{ze as default};
//# sourceMappingURL=Trashcan-B-uu7JsA.js.map
