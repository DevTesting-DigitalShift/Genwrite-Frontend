var R=Object.defineProperty,z=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var I=(s,r,o)=>r in s?R(s,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[r]=o,l=(s,r)=>{for(var o in r||(r={}))M.call(r,o)&&I(s,o,r[o]);if(O)for(var o of O(r))_.call(r,o)&&I(s,o,r[o]);return s},m=(s,r)=>z(s,k(r));import{u as P,a as F,r as n,g as h,j as a,A as G,H as U,m as Y,b as B}from"./index-DR-bw6kg.js";import{d as j}from"./dayjs.min-HE1P10q2.js";import{F as H}from"./fuse-CLoWdkAE.js";import{T as $}from"./index-BppV3Ol6.js";import{S as K}from"./search-RQT585G1.js";import{S as y}from"./index-BY1X2JjI.js";import{F as Q}from"./Table-N-IxT5qU.js";import{S as J}from"./index-DdW0_f3i.js";import{E as W}from"./index-DkforPaY.js";import"./createLucideIcon-BlEv2sML.js";import"./Overflow-DQ2dbEZa.js";import"./move-lQIzoAiY.js";import"./useIcons-DSXaljwQ.js";import"./SearchOutlined-CaD_frxI.js";import"./addEventListener-C1Oz5RTu.js";import"./index-CXrRM188.js";import"./index-C6E5hk9b.js";import"./LeftOutlined-CoVQ2ruT.js";import"./RightOutlined-DMdhSb12.js";import"./EllipsisOutlined-CLQfW9UY.js";import"./collapse-BbEVqHco.js";import"./index-C0Vkt9Ud.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-Cc9wTpMU.js";import"./useForceUpdate-C3On-3Q1.js";import"./Pagination-CFgCNUlM.js";import"./Input-BmJ2hQK9.js";const{Option:f}=y,je=()=>{const s=P(),{logs:r,loading:o}=F(e=>e.creditLogs),[d,C]=n.useState(""),[c,T]=n.useState("24h"),[x,E]=n.useState([]),[i,p]=n.useState({current:1,pageSize:10}),b=[10,20,50,100],A=["BLOG_GENERATION","QUICK_BLOG_GENERATION","AI_PROOFREADING","COMPETITOR_ANALYSIS","SUBSCRIPTION_PAYMENT","OTHER"],S=n.useMemo(()=>new H(r,{keys:["metadata.title"],threshold:.4,ignoreLocation:!0,minMatchCharLength:2}),[r]),u=n.useMemo(()=>{let e=r;return d&&(e=S.search(d).map(({item:t})=>t)),x.length>0&&(e=e.filter(t=>x.includes(t.purpose))),e},[r,d,x,S]),g=e=>{const t=j();switch(e){case"24h":return{start:t.subtract(24,"hours").startOf("hour").toISOString(),end:t.endOf("hour").toISOString()};case"7d":return{start:t.subtract(7,"days").startOf("day").toISOString(),end:t.endOf("day").toISOString()};case"30d":return{start:t.subtract(30,"days").startOf("day").toISOString(),end:t.endOf("day").toISOString()};default:return{}}};n.useEffect(()=>{const e=l({page:1,limit:-1},g(c));s(h(e))},[s,c]);const N={BLOG_GENERATION:"bg-blue-100 text-blue-700",QUICK_BLOG_GENERATION:"bg-indigo-100 text-indigo-700",AI_PROOFREADING:"bg-green-100 text-green-700",COMPETITOR_ANALYSIS:"bg-yellow-100 text-yellow-800",SUBSCRIPTION_PAYMENT:"bg-purple-100 text-purple-700",OTHER:"bg-gray-100 text-gray-700"},v=n.useMemo(()=>[{title:"Blog Topic",dataIndex:["metadata","title"],key:"blogTitle",render:e=>a.jsx("div",{children:a.jsx("span",{className:"text-xs sm:text-sm text-gray-700 capitalize",children:e||"-"})})},{title:"Date",dataIndex:"createdAt",key:"createdAt",sorter:(e,t)=>new Date(e.createdAt)-new Date(t.createdAt),render:e=>a.jsx("span",{className:"text-xs sm:text-sm text-gray-600",children:j(e).format("DD MMM YYYY, hh:mm A")})},{title:"Type",dataIndex:"category",key:"category",filters:[{text:"Deduction",value:"DEDUCTION"},{text:"Adjustment",value:"ADJUSTMENT"}],onFilter:(e,t)=>t.category===e,render:e=>a.jsx($,{color:e==="DEDUCTION"?"red":"green",className:"font-medium px-2 sm:px-3 py-1 rounded-full text-xs",children:e})},{title:"Purpose",dataIndex:"purpose",key:"purpose",filters:A.map(e=>({text:e.toLowerCase().replace(/_/g," "),value:e})),filterMultiple:!0,onFilter:(e,t)=>t.purpose===e,render:e=>{const t=N[e]||"bg-gray-100 text-gray-700",w=(e==null?void 0:e.toLowerCase().replace(/_/g," "))||"-";return a.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-semibold capitalize ${t}`,children:w})}},{title:"Amount",dataIndex:"amount",key:"amount",sorter:(e,t)=>e.amount-t.amount,render:e=>a.jsx("span",{className:`font-semibold text-xs sm:text-sm ${e<0?"text-red-500":"text-green-600"}`,children:e>0?`+${e}`:e})},{title:"Remaining Credits",dataIndex:"remainingCredits",key:"remainingCredits",responsive:["md"],render:e=>a.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-800",children:e})}],[N]);n.useEffect(()=>{const e=B();if(!e)return;const t=()=>{s(h(l({page:1,limit:-1},g(c))))};return e.on("credit-log",t),()=>{e.off("credit-log",t)}},[s,c]);const L=n.useMemo(()=>{const e=(i.current-1)*i.pageSize,t=e+i.pageSize;return u.slice(e,t)},[u,i.current,i.pageSize]);return a.jsxs(G,{children:[a.jsx(U,{children:a.jsx("title",{children:"Credit Logs | GenWrite"})}),a.jsxs(Y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.3},className:"p-8 bg-white rounded-2xl w-full max-w-full",children:[a.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Credit Logs"}),a.jsx("p",{className:"text-gray-500 text-sm max-w-lg",style:{opacity:1},children:"All your credits, all in one spot. Check your activity, track your transactions, and never miss a beat."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[a.jsxs("div",{className:"relative w-full",children:[a.jsx("input",{placeholder:"Search by blog title",value:d,onChange:e=>{C(e.target.value),p(t=>m(l({},t),{current:1}))},className:"w-full rounded-lg border border-gray-300 px-10 py-[5px] text-sm focus:outline-none focus:ring-2 focus:ring-blue-300","aria-label":"Search credit logs by blog title"}),a.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"})]}),a.jsxs(y,{value:c,onChange:e=>{T(e),p(t=>m(l({},t),{current:1})),s(h(l({page:1,limit:-1},g(e))))},className:"w-full sm:w-48 rounded-lg text-xs sm:text-sm",popupClassName:"rounded-lg","aria-label":"Select date range",children:[a.jsx(f,{value:"24h",children:"Last 24 Hours"}),a.jsx(f,{value:"7d",children:"Last 7 Days"}),a.jsx(f,{value:"30d",children:"Last 30 Days"})]}),a.jsx(y,{value:i.pageSize,onChange:e=>{p(t=>m(l({},t),{pageSize:e,current:1}))},options:b.map(e=>({label:`${e} / page`,value:e})),className:"w-full sm:w-32 rounded-lg text-xs sm:text-sm",popupClassName:"rounded-lg","aria-label":"Select page size"})]})]}),a.jsx("style",{children:`
            .ant-table-container {
              overflow-x: auto;
              -webkit-overflow: auto;
            }
            .ant-table-thead {
              position: sticky;
              top: 0;
              z-index: 10;
              background: #fafafa;
            }
            .ant-table-thead > tr > th {
              background: #fafafa !important;
              white-space: nowrap;
            }
            .ant-table-cell {
              white-space: nowrap;
            }
            @media (max-width: 640px) {
              .ant-table-tbody > tr > td {
                padding: 8px !important;
                font-size: 12px !important;
              }
              .ant-table-thead > tr > th {
                padding: 8px !important;
                font-size: 12px !important;
              }
            }
            @media (max-width: 768px) {
              .ant-table-tbody > tr > td {
                padding: 10px !important;
              }
              .ant-table-thead > tr > th {
                padding: 10px !important;
              }
            }
          `}),a.jsx(Q,{dataSource:L,columns:v,loading:o,rowKey:"_id",pagination:{current:i.current,pageSize:i.pageSize,total:u.length,showSizeChanger:!1,showTotal:e=>`Total ${e} logs`,onChange:e=>{p(t=>m(l({},t),{current:e}))},responsive:!0,pageSizeOptions:b,className:"text-xs sm:text-sm"},className:"rounded-xl overflow-hidden w-full",rowClassName:"hover:bg-gray-50 transition-colors duration-200",bordered:!1,locale:{emptyText:o?a.jsx(J,{tip:"Loading logs..."}):a.jsx(W,{description:d||x.length>0?"No logs match the filters":"No Logs Found"})},onChange:(e,t,w,q)=>{const D=t.purpose||[];E(D),p({current:e.current,pageSize:e.pageSize})},scroll:{x:"max-content"}})]})]})};export{je as default};
