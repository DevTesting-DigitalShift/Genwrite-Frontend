import{I,J as E,a as R,u as T,j as e,m as o,b as u}from"./index-IEu-g-tg.js";import{b as x}from"./chunk-tiptap-Bpe5wDXG.js";import{a as $,b as K}from"./index-CHxLp2nb.js";import"./iconBase-CbItCYMl.js";var U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function w(){return w=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var d in r)Object.prototype.hasOwnProperty.call(r,d)&&(n[d]=r[d])}return n},w.apply(this,arguments)}const P=(n,t)=>x.createElement(I,w({},n,{ref:t,icon:U})),z=x.forwardRef(P),G=()=>{E(),R();const n=T(a=>a.auth.user),[t,r]=x.useState({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null}),[d,p]=x.useState(""),[v,m]=x.useState(!1),[j,N]=x.useState([]),y=async()=>{try{const a=await u.get("/brand");let s=Array.isArray(a.data)?a.data:a.data?[a.data]:[];console.log("Fetched brands:",s),N(s),s.length>0&&!t.selectedVoice&&r(l=>({...l,selectedVoice:s[0]}))}catch{N([])}};x.useEffect(()=>{y()},[]);const F=a=>{r({nameOfVoice:a.nameOfVoice,postLink:a.postLink,keywords:Array.isArray(a.keywords)?a.keywords:[],describeBrand:a.describeBrand,selectedVoice:a,uploadedFile:null,_id:a._id})},O=async()=>{var a,s,l,h,f,g,c,k,V;try{m(!0);const i={nameOfVoice:(a=t.nameOfVoice)==null?void 0:a.trim(),postLink:(s=t.postLink)==null?void 0:s.trim(),keywords:Array.isArray(t.keywords)?t.keywords.map(D=>String(D).trim()).filter(Boolean):[],describeBrand:(l=t.describeBrand)==null?void 0:l.trim(),userId:n==null?void 0:n._id};if(!i.nameOfVoice||!i.postLink||!i.describeBrand||i.keywords.length===0){m(!1),alert("All fields are required and at least one keyword must be provided.");return}try{new URL(i.postLink)}catch{m(!1),alert("Please enter a valid URL for the post link.");return}let B;t._id?B=await u.put(`/brand/${t._id}`,i):B=await u.post("/brand/addBrand",i),m(!1),y(),r({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null,_id:void 0})}catch(i){m(!1),alert(((f=(h=i==null?void 0:i.response)==null?void 0:h.data)==null?void 0:f.message)||((V=(k=(c=(g=i==null?void 0:i.response)==null?void 0:g.data)==null?void 0:c.errors)==null?void 0:k[0])==null?void 0:V.msg)||"Failed to save brand voice. Please check your input.")}},L=async a=>{try{await u.delete(`/brand/${a._id}`),y(),t.selectedVoice&&t.selectedVoice._id===a._id&&r(s=>({...s,selectedVoice:null}))}catch{alert("Failed to delete brand voice.")}},b=a=>{const{name:s,value:l}=a.target;r({...t,[s]:l})},C=a=>{r(s=>({...s,selectedVoice:a}))},_=a=>{const s=a.target.files[0];if(s&&s.type==="text/csv"){const l=new FileReader;l.onload=h=>{let g=h.target.result.split(/,|\n|;/).map(c=>c.trim()).filter(c=>c.length>0);r(c=>({...c,uploadedFile:s.name,keywords:Array.from(new Set([...c.keywords,...g]))}))},l.readAsText(s)}},S=a=>{a.key==="Enter"&&d.trim()&&(r({...t,keywords:[...t.keywords,d.trim()]}),p(""))},H=a=>{r({...t,keywords:t.keywords.filter(s=>s!==a)})},A=()=>{const a=t.keywords.slice(-3),s=t.keywords.length-a.length;return e.jsxs(e.Fragment,{children:[s>0&&e.jsx(o.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{scale:.8},animate:{scale:1},children:e.jsx("span",{className:"text-sm",children:`+${s}`})}),a.map((l,h)=>e.jsxs(o.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},whileHover:{scale:1.05},children:[e.jsx("span",{className:"text-sm",children:l}),e.jsx($,{className:"ml-1 cursor-pointer text-indigo-500 hover:text-indigo-700 transition-colors",onClick:()=>H(l)})]},h))]})};return e.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-8 justify-around p-6",children:[e.jsxs(o.div,{className:"w-[60%] bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:-20},animate:{x:0},children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Letâ€™s create your Brand Voice"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Prototype group pixel duplicate ellipse hand draft style rotate. Layout follower scale comment flows draft select."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Name of Voice"}),e.jsx(o.input,{type:"text",name:"nameOfVoice",value:t.nameOfVoice,onChange:b,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:["Paste link of your post or blog ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o.input,{type:"text",name:"postLink",value:t.postLink,onChange:b,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{className:"text-center my-4 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-4 text-gray-500",children:"OR"})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:["Keywords ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(o.div,{className:"flex items-center bg-white border border-gray-300 rounded-lg p-2 flex-wrap gap-2",whileHover:{boxShadow:"0 0 0 3px rgba(99, 102, 241, 0.2)"},children:[A(),e.jsx("input",{type:"text",value:d,onChange:a=>p(a.target.value),onKeyDown:S,className:"flex-grow p-2 bg-white border-none outline-none rounded-l-md",placeholder:"e.g., Fun"}),e.jsx("label",{htmlFor:"file-upload",className:"flex items-center cursor-pointer",children:e.jsx(o.div,{className:"bg-indigo-100 p-2 rounded-lg",whileHover:{scale:1.1},whileTap:{scale:.95},children:e.jsx(z,{})})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:_,accept:".csv"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Describe your Brand"}),e.jsx(o.textarea,{name:"describeBrand",value:t.describeBrand,onChange:b,placeholder:"Write a blog on how to cook pasta",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:"4",whileFocus:{scale:1.01}})]}),e.jsx("div",{className:"text-right",children:e.jsx(o.button,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-3 rounded-lg font-medium shadow-md hover:shadow-lg transition-all",onClick:O,whileHover:{scale:1.03,y:-2},whileTap:{scale:.98},children:"Save Brand Voice"})})]})]}),e.jsx("div",{className:"h-auto w-px bg-gray-200 mx-2"}),e.jsxs(o.div,{className:"flex-1 bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:20},animate:{x:0},children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-4",children:"Your Brand Voices"}),e.jsx("div",{className:"mb-8 space-y-4 overflow-y-auto p-2",children:j.length>0?j.map(a=>{var s;return e.jsx(M,{id:a._id,brandName:a.nameOfVoice,brandVoice:a.describeBrand,onSelect:()=>C(a),isSelected:((s=t.selectedVoice)==null?void 0:s._id)===a._id,onEdit:()=>F(a),onDelete:()=>L(a)},a._id)}):e.jsx("div",{className:"p-6 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center text-gray-500",children:"No brand voices created yet."})})]})]})},M=({id:n,brandName:t,brandVoice:r,onSelect:d,isSelected:p,onEdit:v,onDelete:m})=>e.jsxs(o.div,{className:`p-4 rounded-xl cursor-pointer transition-all ${p?"bg-gradient-to-r from-indigo-100 to-purple-100 border-2 border-indigo-300 shadow-md":"bg-white border border-gray-200 hover:border-indigo-300"}`,onClick:d,whileHover:{y:-3,boxShadow:"0 4px 12px rgba(99, 102, 241, 0.1)"},whileTap:{scale:.98},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:`font-medium ${p?"text-indigo-700":"text-gray-700"}`,children:t}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(o.button,{className:"text-indigo-500 hover:text-indigo-700",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:v,children:e.jsx(K,{})}),e.jsx(o.button,{className:"text-gray-500 hover:text-red-500",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:m,children:e.jsx("img",{src:"/Images/trash.png",alt:"Delete",className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:r.length>100?`${r.substring(0,100)}...`:r})]});export{G as default};
