var Oe=Object.defineProperty,Te=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var ye=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var je=(l,a,i)=>a in l?Oe(l,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[a]=i,K=(l,a)=>{for(var i in a||(a={}))Pe.call(a,i)&&je(l,i,a[i]);if(ye)for(var i of ye(a))_e.call(a,i)&&je(l,i,a[i]);return l},$=(l,a)=>Te(l,Ie(a));var be=(l,a,i)=>new Promise((s,f)=>{var o=g=>{try{y(i.next(g))}catch(u){f(u)}},w=g=>{try{y(i.throw(g))}catch(u){f(u)}},y=g=>g.done?s(g.value):Promise.resolve(g.value).then(o,w);y((i=i.apply(l,a)).next())});import{r as d,I as Ne,av as Ee,aw as Be,a6 as Ke,u as $e,a as fe,a9 as Re,j as e,M as ze,a2 as We,m,E as we,T as R,a3 as He,ap as Fe}from"./index-BE9YYjUk.js";import{C as L,E as ve,g as Ve}from"./getEstimatedCost-DjHSTkuc.js";import{S as z,E as Ye}from"./index-iDS2nlFK.js";import{I as Ue}from"./index-CtF3hR5O.js";import{T as A}from"./index-DOzAtAXK.js";import{T as ke,C as W}from"./index-DhOXBDyj.js";import{P as qe}from"./progress-B-ujFbmH.js";function H(){return H=Object.assign?Object.assign.bind():function(l){for(var a=1;a<arguments.length;a++){var i=arguments[a];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(l[s]=i[s])}return l},H.apply(this,arguments)}const Ge=(l,a)=>d.createElement(Ne,H({},l,{ref:a,icon:Ee})),is=d.forwardRef(Ge);function F(){return F=Object.assign?Object.assign.bind():function(l){for(var a=1;a<arguments.length;a++){var i=arguments[a];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(l[s]=i[s])}return l},F.apply(this,arguments)}const Je=(l,a)=>d.createElement(Ne,F({},l,{ref:a,icon:Be})),Qe=d.forwardRef(Je),{Panel:C}=L,{TabPane:O}=ke,ls=({closeFnc:l,open:a,blogs:i})=>{var Z,D,ee,se,te,ne,ae,re,ie,le,oe,de,ce,xe,he,ge,me,ue;const[s,f]=d.useState({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),[o,w]=d.useState(null),[y,g]=d.useState(null),[u,N]=d.useState(!1),[Ce,j]=d.useState(null),[T,I]=d.useState(0),{handlePopup:Le}=Ke(),P=$e(),{analysis:_,loading:v}=fe(t=>t.analysis),{blog:Xe,loading:M}=fe(t=>t.blog);d.useEffect(()=>{!v&&_&&w(_)},[_,v]),d.useEffect(()=>{a||(f({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),w(null),g(null),N(!1),j(null),I(0))},[a]),d.useEffect(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[a]),d.useEffect(()=>{y&&(N(!0),P(Re(y)).unwrap().then(t=>{t!=null&&t._id&&f(n=>$(K({},n),{title:t.title,content:t.content||"",keywords:t.keywords||[],focusKeywords:t.focusKeywords||[],selectedProject:t,contentType:"markdown",generatedMetadata:t.generatedMetadata||null}))}).catch(t=>{console.error("Failed to fetch blog by ID:",t)}).finally(()=>N(!1)))},[y,P]),d.useEffect(()=>{var b,p,k,S,pe;const t=B.length>0,n=((p=(b=s==null?void 0:s.generatedMetadata)==null?void 0:b.outboundLinks)==null?void 0:p.length)>0,r=((S=(k=s==null?void 0:s.generatedMetadata)==null?void 0:k.internalLinks)==null?void 0:S.length)>0,c=!!o,h=!!((pe=s==null?void 0:s.generatedMetadata)!=null&&pe.competitorsAnalysis);j(c?"results":t?"competitors":n||r?"links":h?"initial-analysis":null)},[o,(Z=s==null?void 0:s.generatedMetadata)==null?void 0:Z.competitors,(D=s==null?void 0:s.generatedMetadata)==null?void 0:D.outboundLinks,(ee=s==null?void 0:s.generatedMetadata)==null?void 0:ee.internalLinks,(se=s==null?void 0:s.generatedMetadata)==null?void 0:se.competitorsAnalysis]);const Me=t=>{const n=i.find(r=>r._id===t);n&&(g(n._id),f(r=>$(K({},r),{title:n.title,content:n.content||"",keywords:n.keywords||[],focusKeywords:n.focusKeywords||[],selectedProject:n,contentType:"markdown",generatedMetadata:null})),w(null),I(r=>r+1))},Se=()=>{if(s.title.trim()&&s.content.trim()&&!(s.keywords.length===0&&s.focusKeywords.length===0)){if(s.content.length<500){He.warning("Your content is too short. This may affect competitive analysis accuracy.");return}Le({title:"Analyze Competitors",description:e.jsxs("p",{children:["Competitive Analysis cost: ",e.jsxs("b",{children:[Ve("analysis.competitors")," credits"]}),e.jsx("br",{}),"Do you wish to proceed?"]}),onConfirm:()=>be(null,null,function*(){var t;N(!0);try{const n=yield P(Fe({title:s.title,content:s.content,keywords:[...new Set([...s.keywords,...s.focusKeywords])],contentType:s.contentType,blogId:(t=s==null?void 0:s.selectedProject)==null?void 0:t._id})).unwrap();w(n)}catch(n){console.error("Error fetching analysis:",n)}finally{N(!1)}})})}},x=t=>t?t.replace(/#{1,3}\s/g,"").replace(/[\*_~`]/g,"").replace(/\n+/g,`
`).trim():"",E=t=>t?x(t).split(`
`).filter(n=>n.trim()!=="").map((n,r)=>e.jsx("p",{className:"mb-2",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:n.trim().replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},r)):[],Ae=t=>!t||t.length===0?null:e.jsx(L,{accordion:!0,className:"bg-white border border-gray-200 rounded-lg",children:t.map((n,r)=>{var c;return e.jsx(C,{header:e.jsxs("div",{className:"flex justify-between items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800 truncate max-w-[60%]",children:x(n.title)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{title:"Relatable Score",children:n.score&&e.jsxs(A,{color:"blue",children:[(n.score*100).toFixed(2),"%"]})}),e.jsxs("a",{href:(c=n==null?void 0:n.link)!=null?c:n==null?void 0:n.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:h=>h.stopPropagation(),children:["Visit ",e.jsx(ve,{className:"w-4 h-4"})]})]})]}),className:"text-sm text-gray-700 leading-relaxed",children:n!=null&&n.content?e.jsx("div",{children:E(n.content)}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-2 font-medium",children:x(n.snippet||n.content)}),e.jsx("div",{children:E(n.summary)})]})},r)})},T),V=(t,n)=>!t||t.length===0?null:e.jsx(W,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded text-blue-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]})}),e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:n})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsx(L,{accordion:!0,children:t.map((r,c)=>e.jsxs(C,{header:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("span",{className:"text-sm font-medium text-gray-800",children:x(r.title)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{title:"Relatable Score",children:r.score&&e.jsxs(A,{color:"blue",children:[(r.score*100).toFixed(2),"%"]})}),e.jsxs("a",{href:r.link||r.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:h=>h.stopPropagation(),children:["Visit ",e.jsx(ve,{className:"w-4 h-4"})]})]})]}),className:"text-sm text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"text-gray-600",children:x(r.snippet||r.content)}),r.summary&&e.jsx("div",{children:E(r.summary)})]},c))},T)}),Y=t=>{if(!t)return null;const{analysis:n,suggestions:r}=t;return e.jsx(W,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded text-purple-500",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]})}),e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"Competitors Analysis"})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsxs(L,{accordion:!0,expandIconPosition:"right",children:[e.jsx(C,{header:e.jsx("span",{className:"font-semibold text-gray-800",children:"Analysis"}),children:e.jsx(L,{accordion:!0,children:Object.entries(n).map(([c,h],b)=>{const p=h.match(/\((\d+\/\d+)\)$/),k=p?p[1]:null,S=x(h.replace(/\s*\(\d+\/\d+\)$/,"").trim());return e.jsx(C,{header:e.jsxs("div",{className:"flex justify-between items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800",children:x(c)}),e.jsx(R,{title:"Relatable Score",children:k&&e.jsx(A,{color:"blue",children:k.replace("/"," / ")})})]}),className:"text-sm text-gray-700 leading-relaxed",children:e.jsx("p",{children:S})},c)})})},"analysis"),e.jsx(C,{header:e.jsx("span",{className:"font-semibold text-gray-800",children:"Suggestions"}),children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm text-gray-700",children:r.split(/(?:\d+\.\s)/).filter(Boolean).map((c,h)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:x(c.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},h))})},"suggestions")]},T)})},B=d.useMemo(()=>{var h;const t=((h=s==null?void 0:s.generatedMetadata)==null?void 0:h.competitors)||[],n=(o==null?void 0:o.competitors)||[],r=[],c=new Set;return[...t,...n].forEach(b=>{const p=b.url||b.link;c.has(p)||(c.add(p),r.push(b))}),r},[(te=s==null?void 0:s.generatedMetadata)==null?void 0:te.competitors,o==null?void 0:o.competitors]),U=d.useMemo(()=>[...new Set([...s.keywords,...s.focusKeywords])],[s.keywords,s.focusKeywords]),q=B.length>0,G=((ae=(ne=s==null?void 0:s.generatedMetadata)==null?void 0:ne.outboundLinks)==null?void 0:ae.length)>0,J=((ie=(re=s==null?void 0:s.generatedMetadata)==null?void 0:re.internalLinks)==null?void 0:ie.length)>0,Q=!!o,X=!!((le=s==null?void 0:s.generatedMetadata)!=null&&le.competitorsAnalysis);return u||M||v?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:e.jsx(ze,{})}):e.jsx(We,{open:a,title:e.jsxs(m.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Competitive Analysis Dashboard"})]}),onCancel:l,footer:[e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(we,{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition",children:"Close"}),e.jsx(we,{onClick:Se,className:`px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition ${u||M||v?"opacity-50 cursor-not-allowed":""}`,disabled:u||M||v,children:u||M||v?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Qe,{}),o?"Re-Analyzing...":"Analyzing..."]}):o?"Re-Run Analysis":"Run Competitive Analysis"})]},"footer")],width:1e3,centered:!0,closable:!0,transitionName:"",maskTransitionName:"",bodyStyle:{maxHeight:"85vh",overflowY:"auto",padding:"16px"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Blog Post"}),e.jsxs(z,{showSearch:!0,filterOption:(t,n)=>{var r;return(r=n==null?void 0:n.children)==null?void 0:r.toLowerCase().includes(t.toLowerCase())},className:"w-full rounded-md text-sm",onChange:Me,value:((oe=s.selectedProject)==null?void 0:oe._id)||"",dropdownStyle:{maxHeight:200,overflowY:"auto"},placeholder:"Select a blog",children:[e.jsx(z.Option,{value:"",children:"Select a blog"}),i.map(t=>e.jsx(z.Option,{value:t._id,children:t.title.charAt(0).toUpperCase()+t.title.slice(1)},t._id))]})]}),s.selectedProject&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"Blog Details"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Title"}),e.jsx(Ue,{name:"title",value:s.title,readOnly:!0,className:"w-full bg-gray-100 cursor-not-allowed"})]}),U.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:U.map((t,n)=>e.jsx(A,{className:"flex items-center gap-1 bg-blue-50 text-blue-700 border-blue-100",children:x(t)},t))})]}),s.content?e.jsx("div",{className:"text-gray-700 max-h-40 overflow-y-auto whitespace-pre-wrap leading-relaxed p-4 bg-gray-50 rounded-md",children:x(s.content).split(`
`).map((t,n)=>e.jsx("p",{className:"text-base mt-2",children:t.trim()},n))}):e.jsx(Ye,{description:"No content available for this blog"})]})]}),((de=s.generatedMetadata)==null?void 0:de.seo_meta)&&e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:"SEO Metadata"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Title:"})," ",x(s.generatedMetadata.seo_meta.title)]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[e.jsx("strong",{children:"Description:"})," ",x(s.generatedMetadata.seo_meta.description)]})]})]})]}),!s.selectedProject&&e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-10 bg-gray-50 rounded-xl border border-gray-200 shadow-sm",children:e.jsx("p",{className:"text-gray-600 text-lg",children:"Select a blog to view details and analysis"})}),(q||G||J||Q||X)&&e.jsx(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(ke,{activeKey:Ce,onChange:t=>{j(t),I(n=>n+1)},type:"card",children:[Q&&e.jsx(O,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"m19 9-5 5-4-4-3 3"})]}),"Analysis Results"]}),children:e.jsxs(m.div,{animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"space-y-6",children:[e.jsxs(m.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},className:"flex flex-col items-center",children:[e.jsx(qe,{type:"dashboard",percent:parseInt(((ce=o.insights)==null?void 0:ce.blogScore)||0),format:t=>`${t} / 100`,strokeColor:{"0%":"#1B6FC9","100%":"#4C9FE8"},trailColor:"#e5e7eb",size:"large"}),e.jsx("div",{className:"text-gray-800 text-lg font-semibold mt-3",children:"Blog SEO Score"})]}),e.jsx(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.4},children:e.jsx(W,{title:"Suggestions to Beat Competitors",className:"bg-white border border-gray-200 rounded-lg shadow-sm",headStyle:{background:"#f9fafb",fontWeight:600,fontSize:"1.1rem"},children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm text-gray-700",children:(he=(xe=o==null?void 0:o.insights)==null?void 0:xe.suggestions)==null?void 0:he.split(/(?:\d+\.\s)/).filter(Boolean).map((t,n)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:x(t.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},n))})})}),Y(o==null?void 0:o.insights)]})},"results"),q&&e.jsx(O,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),"Competitors"]}),children:Ae(B)},"competitors"),(G||J)&&e.jsx(O,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),e.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),"Links"]}),children:e.jsxs("div",{className:"space-y-6",children:[V((ge=s==null?void 0:s.generatedMetadata)==null?void 0:ge.outboundLinks,"Outbound Links"),V((me=s==null?void 0:s.generatedMetadata)==null?void 0:me.internalLinks,"Internal Links")]})},"links"),X&&e.jsx(O,{tab:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),e.jsx("path",{d:"M12 17h.01"})]}),"Initial Analysis"]}),children:Y((ue=s==null?void 0:s.generatedMetadata)==null?void 0:ue.competitorsAnalysis)},"initial-analysis")]})})]})})};export{ls as C,Qe as R,is as a};
//# sourceMappingURL=CompetitiveAnalysisModal-DAONhb4M.js.map
