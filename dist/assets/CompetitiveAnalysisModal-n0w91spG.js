import{b as c,R as w}from"./chunk-tiptap-JX9QK0Ia.js";import{E as Ne,G as ge,F as Ee,bs as ke,_ as Pe,bt as Ie,J as he,b as I,bu as Re,K as Ae,H as pe,$ as _e,bv as ve,h as Fe,R as Be,bw as Oe,bp as Ke,aW as $e,k as ze,S as De,Q as Te,bx as Ve,aX as Le,P as Me,aY as ye,b3 as be,a$ as Ue,aF as We,j as t,q as M,aG as L}from"./index-OSlQBlIK.js";import{X as Ce,g as He}from"./getEstimatedCost-Cocvpxr8.js";var qe=["autoComplete","onChange","onFocus","onBlur","onPressEnter","onKeyDown","onKeyUp","prefixCls","disabled","htmlSize","className","maxLength","suffix","showCount","count","type","classes","classNames","styles","onCompositionStart","onCompositionEnd"],Ge=c.forwardRef(function(e,o){var x=e.autoComplete,u=e.onChange,d=e.onFocus,v=e.onBlur,p=e.onPressEnter,h=e.onKeyDown,j=e.onKeyUp,b=e.prefixCls,y=b===void 0?"rc-input":b,N=e.disabled,_=e.htmlSize,U=e.className,W=e.maxLength,R=e.suffix,z=e.showCount,F=e.count,E=e.type,D=E===void 0?"text":E,s=e.classes,n=e.classNames,r=e.styles,C=e.onCompositionStart,H=e.onCompositionEnd,ae=Ne(e,qe),oe=c.useState(!1),q=ge(oe,2),re=q[0],l=q[1],T=c.useRef(!1),S=c.useRef(!1),m=c.useRef(null),B=c.useRef(null),G=function(a){m.current&&Re(m.current,a)},le=Ee(e.defaultValue,{value:e.value}),Z=ge(le,2),X=Z[0],k=Z[1],J=X==null?"":String(X),ie=c.useState(null),ee=ge(ie,2),A=ee[0],ce=ee[1],g=ke(F,z),O=g.max||W,K=g.strategy(J),ue=!!O&&K>O;c.useImperativeHandle(o,function(){var i;return{focus:G,blur:function(){var f;(f=m.current)===null||f===void 0||f.blur()},setSelectionRange:function(f,Y,V){var $;($=m.current)===null||$===void 0||$.setSelectionRange(f,Y,V)},select:function(){var f;(f=m.current)===null||f===void 0||f.select()},input:m.current,nativeElement:((i=B.current)===null||i===void 0?void 0:i.nativeElement)||m.current}}),c.useEffect(function(){S.current&&(S.current=!1),l(function(i){return i&&N?!1:i})},[N]);var te=function(a,f,Y){var V=f;if(!T.current&&g.exceedFormatter&&g.max&&g.strategy(f)>g.max){if(V=g.exceedFormatter(f,{max:g.max}),f!==V){var $,xe;ce([(($=m.current)===null||$===void 0?void 0:$.selectionStart)||0,((xe=m.current)===null||xe===void 0?void 0:xe.selectionEnd)||0])}}else if(Y.source==="compositionEnd")return;k(V),m.current&&ve(m.current,a,u,V)};c.useEffect(function(){if(A){var i;(i=m.current)===null||i===void 0||i.setSelectionRange.apply(i,Pe(A))}},[A]);var de=function(a){te(a,a.target.value,{source:"change"})},me=function(a){T.current=!1,te(a,a.currentTarget.value,{source:"compositionEnd"}),H==null||H(a)},fe=function(a){p&&a.key==="Enter"&&!S.current&&(S.current=!0,p(a)),h==null||h(a)},se=function(a){a.key==="Enter"&&(S.current=!1),j==null||j(a)},ne=function(a){l(!0),d==null||d(a)},P=function(a){S.current&&(S.current=!1),l(!1),v==null||v(a)},Q=function(a){k(""),G(),m.current&&ve(m.current,a,u)},we=ue&&"".concat(y,"-out-of-range"),je=function(){var a=_e(e,["prefixCls","onPressEnter","addonBefore","addonAfter","prefix","suffix","allowClear","defaultValue","showCount","count","classes","htmlSize","styles","classNames","onClear"]);return w.createElement("input",he({autoComplete:x},a,{onChange:de,onFocus:ne,onBlur:P,onKeyDown:fe,onKeyUp:se,className:I(y,pe({},"".concat(y,"-disabled"),N),n==null?void 0:n.input),style:r==null?void 0:r.input,ref:m,size:_,type:D,onCompositionStart:function(Y){T.current=!0,C==null||C(Y)},onCompositionEnd:me}))},Se=function(){var a=Number(O)>0;if(R||g.show){var f=g.showFormatter?g.showFormatter({value:J,count:K,maxLength:O}):"".concat(K).concat(a?" / ".concat(O):"");return w.createElement(w.Fragment,null,g.show&&w.createElement("span",{className:I("".concat(y,"-show-count-suffix"),pe({},"".concat(y,"-show-count-has-suffix"),!!R),n==null?void 0:n.count),style:Ae({},r==null?void 0:r.count)},f),R)}return null};return w.createElement(Ie,he({},ae,{prefixCls:y,className:I(U,we),handleReset:Q,value:J,focused:re,triggerFocus:G,suffix:Se(),disabled:N,classes:s,classNames:n,styles:r,ref:B}),je())});function Xe(e,o){const x=c.useRef([]),u=()=>{x.current.push(setTimeout(()=>{var d,v,p,h;!((d=e.current)===null||d===void 0)&&d.input&&((v=e.current)===null||v===void 0?void 0:v.input.getAttribute("type"))==="password"&&(!((p=e.current)===null||p===void 0)&&p.input.hasAttribute("value"))&&((h=e.current)===null||h===void 0||h.input.removeAttribute("value"))}))};return c.useEffect(()=>(o&&u(),()=>x.current.forEach(d=>{d&&clearTimeout(d)})),[]),u}function Je(e){return!!(e.prefix||e.suffix||e.allowClear||e.showCount)}var Qe=function(e,o){var x={};for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&o.indexOf(u)<0&&(x[u]=e[u]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,u=Object.getOwnPropertySymbols(e);d<u.length;d++)o.indexOf(u[d])<0&&Object.prototype.propertyIsEnumerable.call(e,u[d])&&(x[u[d]]=e[u[d]]);return x};const tt=c.forwardRef((e,o)=>{const{prefixCls:x,bordered:u=!0,status:d,size:v,disabled:p,onBlur:h,onFocus:j,suffix:b,allowClear:y,addonAfter:N,addonBefore:_,className:U,style:W,styles:R,rootClassName:z,onChange:F,classNames:E,variant:D}=e,s=Qe(e,["prefixCls","bordered","status","size","disabled","onBlur","onFocus","suffix","allowClear","addonAfter","addonBefore","className","style","styles","rootClassName","onChange","classNames","variant"]),{getPrefixCls:n,direction:r,allowClear:C,autoComplete:H,className:ae,style:oe,classNames:q,styles:re}=Fe("input"),l=n("input",x),T=c.useRef(null),S=Be(l),[m,B,G]=Oe(l,z),[le]=Ke(l,S),{compactSize:Z,compactItemClassnames:X}=$e(l,r),k=ze(P=>{var Q;return(Q=v??Z)!==null&&Q!==void 0?Q:P}),J=w.useContext(De),ie=p??J,{status:ee,hasFeedback:A,feedbackIcon:ce}=c.useContext(Te),g=Ue(ee,d),O=Je(e)||!!A;c.useRef(O);const K=Xe(T,!0),ue=P=>{K(),h==null||h(P)},te=P=>{K(),j==null||j(P)},de=P=>{K(),F==null||F(P)},me=(A||b)&&w.createElement(w.Fragment,null,b,A&&ce),fe=Ve(y??C),[se,ne]=Le("input",D,u);return m(le(w.createElement(Ge,Object.assign({ref:Me(o,T),prefixCls:l,autoComplete:H},s,{disabled:ie,onBlur:ue,onFocus:te,style:Object.assign(Object.assign({},oe),W),styles:Object.assign(Object.assign({},re),R),suffix:me,allowClear:fe,className:I(U,z,G,S,X,ae),onChange:de,addonBefore:_&&w.createElement(be,{form:!0,space:!0},_),addonAfter:N&&w.createElement(be,{form:!0,space:!0},N),classNames:Object.assign(Object.assign(Object.assign({},E),q),{input:I({[`${l}-sm`]:k==="small",[`${l}-lg`]:k==="large",[`${l}-rtl`]:r==="rtl"},E==null?void 0:E.input,q.input,B),variant:I({[`${l}-${se}`]:ne},ye(l,g)),affixWrapper:I({[`${l}-affix-wrapper-sm`]:k==="small",[`${l}-affix-wrapper-lg`]:k==="large",[`${l}-affix-wrapper-rtl`]:r==="rtl"},B),wrapper:I({[`${l}-group-rtl`]:r==="rtl"},B),groupWrapper:I({[`${l}-group-wrapper-sm`]:k==="small",[`${l}-group-wrapper-lg`]:k==="large",[`${l}-group-wrapper-rtl`]:r==="rtl",[`${l}-group-wrapper-${se}`]:ne},ye(`${l}-group-wrapper`,g,A),B)})}))))});typeof window<"u"&&M&&!M._authInterceptorSet&&(M.interceptors.request.use(e=>{const o=localStorage.getItem("token");return o&&(e.headers=e.headers||{},e.headers.Authorization=`Bearer ${o}`),e},e=>Promise.reject(e)),M._authInterceptorSet=!0);const st=({closefnc:e})=>{var D;const[o,x]=c.useState({title:"",content:"",keywords:[],keywordInput:"",contentType:"text",selectedProject:null}),[u,d]=c.useState([]),[v,p]=c.useState(!0),[h,j]=c.useState(!1),[b,y]=c.useState(null),{handlePopup:N}=We();c.useEffect(()=>{(async()=>{try{const C=(await M.get("/blogs")).data.slice(-10).reverse();d(C),p(!1)}catch(n){console.error("Error fetching recent projects:",n),L.error("Failed to load recent projects"),p(!1)}})()},[]);const _=s=>{const{name:n,value:r}=s.target;x(C=>({...C,[n]:r}))},U=s=>{x(n=>({...n,title:s.title,content:s.content,keywords:s.focusKeywords||[],selectedProject:s,contentType:"markdown"}))},W=s=>{x(n=>({...n,keywordInput:s.target.value}))},R=()=>{const s=o.keywordInput;if(s.trim()!==""){const n=s.split(",").map(r=>r.trim()).filter(r=>r!==""&&!o.keywords.includes(r));n.length>0&&x(r=>({...r,keywords:[...r.keywords,...n],keywordInput:""}))}},z=s=>{x(n=>({...n,keywords:n.keywords.filter((r,C)=>C!==s)}))},F=s=>{s.key==="Enter"&&(s.preventDefault(),R())},E=async()=>{if(!o.title.trim()){L.error("Please enter a blog title");return}if(!o.content.trim()){L.error("Please enter blog content");return}if(o.keywords.length===0){L.error("Please add at least one keyword");return}N({title:"Analyse the competitors",description:t.jsxs("p",{children:["Competitors Analysis cost: ",t.jsxs("b",{children:[He("analysis.competitors")," credits"]}),t.jsx("br",{}),"Do you wish to proceed ?"]}),onConfirm:async()=>{j(!0);try{const s=await M.post("/analysis/run",{title:o.title,content:o.content,keywords:o.keywords,contentType:o.contentType});s.data&&(y(s.data),L.success("Analysis completed successfully!"))}catch(s){console.error("Error performing competitive analysis:",s),L.error("Failed to perform competitive analysis")}finally{j(!1)}}})};return t.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:t.jsxs("div",{className:"w-[800px] bg-white rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Competitive Analysis"}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:t.jsx(Ce,{className:"h-6 w-6"})})]}),t.jsx("div",{className:"px-6 py-4 overflow-y-auto",children:t.jsx("div",{className:"space-y-6",children:b?t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Analysis Results"}),t.jsxs("div",{className:"bg-gray-100 p-4 rounded-md",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:[t.jsx("strong",{children:"Analysis:"}),t.jsx("ul",{className:"list-disc ml-5 mt-1",children:Object.entries(b.analysis).map(([s,n])=>t.jsxs("li",{className:"mb-1",children:[t.jsxs("strong",{children:[s.replace(/([A-Z])/g," $1"),": "]}),n]},s))})]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-4",children:[t.jsx("strong",{children:"Suggestions:"})," ",b.suggestions]}),t.jsxs("div",{className:"text-sm text-gray-600 mt-4",children:[t.jsx("strong",{children:"Blog Score:"})," ",b.blogScore," / 100"]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Recent Project"}),t.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500 max-h-[200px] overflow-y-auto",onChange:s=>{const n=u.find(r=>r._id===s.target.value);n&&U(n)},value:((D=o.selectedProject)==null?void 0:D._id)||"",children:[t.jsx("option",{value:"",children:"Select a project"}),u.map(s=>t.jsx("option",{value:s._id,children:s.title},s._id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blog Title"}),t.jsx("input",{type:"text",name:"title",value:o.title,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your blog title"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blog Content"}),t.jsx("textarea",{name:"content",value:o.content,onChange:_,className:"w-full h-40 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter your blog content in ${o.contentType} format`})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keywords"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:o.keywordInput,onChange:W,onKeyDown:F,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Add keywords (comma-separated)"}),t.jsx("button",{onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"Add"})]}),t.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:o.keywords.map((s,n)=>t.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[s,t.jsx("button",{type:"button",onClick:()=>z(n),className:"ml-1.5 flex-shrink-0 text-indigo-400 hover:text-indigo-600",children:t.jsx(Ce,{className:"w-3 h-3"})})]},n))})]})]})})}),t.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t",children:[t.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"}),!b&&t.jsx("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",disabled:h,children:h?"Analyzing...":"Analyze"})]})]})})};export{st as C,tt as I,Xe as u};
