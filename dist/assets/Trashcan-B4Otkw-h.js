import{J,u as X,aW as Z,y as h,j as e,H as Q,m as l,D as P,T as V,aX as K,aY as ee}from"./index-DdPlgZhE.js";import{b as s}from"./chunk-tiptap-Diw-eXXG.js";import{b as te}from"./SkeletonLoader-Cn6112CS.js";import{l as ae}from"./lodash-Bq_SkVDy.js";import{h as r}from"./moment-C5S46NFB.js";import{R as se}from"./refresh-ccw-BHj60Jgi.js";import{T as le,B as re}from"./index-DAxqrybe.js";import{I as ie}from"./index-Twz2vrbY.js";import{S as oe}from"./search-D9LAgYQh.js";import{S as D}from"./index-YWUs7BwF.js";import{P as ne}from"./index-D060ZBgT.js";import{R as ce}from"./QuestionCircleOutlined-70c6UYRj.js";import{P as de}from"./Pagination-Cx6FTOpK.js";import{D as me}from"./index-BjIogZD7.js";import"./createLucideIcon-C5jW9RxN.js";import"./Input-V-YjmxW0.js";import"./useIcons-sTolp5WZ.js";import"./Overflow-Cy8QrjPz.js";import"./index-DrzCl1CU.js";import"./LeftOutlined-CLYiaUum.js";import"./dayjs.min-BeGhjYCo.js";const{Search:he}=ie,{Option:b}=D,{RangePicker:Ee}=me,Le=()=>{const[y,w]=s.useState([]),[p,o]=s.useState(1),[c,A]=s.useState(15),[N,S]=s.useState(0),[T,B]=s.useState(""),[x,R]=s.useState("all"),[d,pe]=s.useState([null,null]),[n,C]=s.useState(!1),{handlePopup:F}=J(),k=X(),I=85,E=[10,15,20,50];r().subtract(7,"days"),r(),r().subtract(30,"days"),r(),r().subtract(3,"months"),r(),r().startOf("year"),r();const L=s.useCallback(ae.debounce(t=>{B(t),o(1)},500),[]),g=s.useCallback(async()=>{C(!0);try{const t={isArchived:!0,status:x!=="all"?x:void 0,q:T||void 0,start:d[0]?r(d[0]).toISOString():void 0,end:d[1]?r(d[1]).toISOString():void 0,page:p,limit:c},a=await Z(t);w(a.data||[]),S(a.totalItems||0)}catch(t){console.error("Failed to fetch trashed blogs:",t),h.error("Failed to load trashed blogs. Please try again.")}finally{C(!1)}},[x,T,d,p,c]);s.useEffect(()=>{g()},[g]),s.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[p]);const O=(t,a=I)=>t?t.length>a?t.substring(0,a)+"...":t:"",H=t=>{var a,m;return((m=(a=t==null?void 0:t.replace(/[#=~`*_\-]+/g,""))==null?void 0:a.replace(/\s{2,}/g," "))==null?void 0:m.trim())||""},G=async t=>{try{await k(ee(t)).unwrap(),g()}catch(a){console.error("Failed to restore blog:",a),h.error("Failed to restore blog. Please try again.")}},_=async()=>{try{await k(K()).unwrap(),w([]),o(1),S(0)}catch(t){console.error("Failed to delete all blogs:",t),h.error("Failed to delete all blogs. Please try again.")}},z=async()=>{o(1),await g(),h.info("Blog list refreshed")},U=t=>{h.info(`Clicked on blog: ${t.title}`)};return e.jsxs("div",{className:"p-5",children:[e.jsx(Q,{children:e.jsx("title",{children:"Trashcan | GenWrite"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mb-6",children:[e.jsx(l.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4},className:"text-3xl sm:text-4xl font-extrabold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Trashcan"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(l.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(P,{type:"default",icon:e.jsx(se,{className:"w-4 h-4"}),onClick:z,disabled:n,children:"Refresh"})}),y.length>0&&e.jsx(l.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(P,{type:"default",icon:e.jsx(le,{className:"w-4 h-4"}),onClick:()=>F({title:"Delete All Trashed Blogs",description:e.jsxs("span",{className:"my-2",children:["All trashed blogs will be ",e.jsx("b",{children:"permanently deleted"}),". This action cannot be undone."]}),confirmText:"Delete All",onConfirm:_,confirmProps:{className:"border-red-500 hover:bg-red-500 hover:text-white"},cancelProps:{danger:!1}}),disabled:n,children:"Delete All"})})]})]}),e.jsx(l.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"text-gray-600 text-sm sm:text-base max-w-xl mb-6",children:"Restore valuable work or permanently delete clutter. Trashed items are deleted after 7 days."}),e.jsx(l.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},className:"bg-white/90 backdrop-blur-md rounded-xl shadow-sm border border-gray-100 p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(he,{placeholder:"Search by title or keywords...",onChange:t=>L(t.target.value),prefix:e.jsx(oe,{className:"w-5 h-5 text-gray-400 mr-2"}),allowClear:!0,className:"w-full  rounded-lg",disabled:n}),e.jsxs(D,{value:x,onChange:t=>{R(t),o(1)},className:"w-full sm:w-1/4 rounded-lg",placeholder:"Filter by status",disabled:n,children:[e.jsx(b,{value:"all",children:"All Statuses"}),e.jsx(b,{value:"complete",children:"Complete"}),e.jsx(b,{value:"failed",children:"Failed"}),e.jsx(b,{value:"pending",children:"Pending"})]})]})}),n?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:[...Array(c)].map((t,a)=>e.jsx("div",{className:"bg-white shadow-md rounded-xl p-4",children:e.jsx(te,{})},a))}):y.length===0?e.jsxs(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4},className:"flex flex-col justify-center items-center",style:{minHeight:"calc(100vh - 250px)"},children:[e.jsx("img",{src:"Images/trash-can.png",alt:"Trash",style:{width:"8rem"}}),e.jsx("p",{className:"text-xl mt-5 text-gray-600",children:"No trashed blogs available."})]}):e.jsxs(e.Fragment,{children:[e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 p-2",children:y.map(t=>{const{_id:a,title:m,status:i,createdAt:$,content:M,aiModel:u,focusKeywords:j,wordpress:f,archiveDate:Y}=t,v=/gemini/gi.test(u);return e.jsx(re.Ribbon,{text:e.jsxs("span",{className:"flex items-center justify-center gap-1 py-1 font-medium tracking-wide",children:[e.jsx("img",{src:`./Images/${v?"gemini":u==="claude"?"claude":"chatgpt"}.png`,alt:"",width:20,height:20,loading:"lazy",className:"bg-white"}),v?"Gemini-1.5-flash":u==="claude"?"Claude-3-Haiku":"ChatGPT-4o-mini"]}),className:"absolute top-0",color:v?"#4796E3":u==="claude"?"#9368F8":"#74AA9C",children:e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`bg-white shadow-md hover:shadow-xl transition-all duration-300 rounded-xl p-4 min-h-[180px] min-w-[390px] relative border-2
                        ${i==="failed"?"border-red-500":i==="complete"?"border-green-500":"border-yellow-500"}`,title:m,children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 -mt-2",children:new Date($).toLocaleDateString("en-US",{dateStyle:"medium"})}),e.jsx(V,{color:i==="complete"?"black":i==="failed"?"red":"orange",title:i==="complete"?"Click to view blog":"Cannot view incomplete blog",children:e.jsx("div",{className:`cursor-${i==="complete"?"pointer":"default"}`,onClick:()=>{i==="complete"&&U(t)},children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg capitalize font-semibold text-gray-900 !text-left max-w-76",children:m}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:O(H(M))})]})})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:j==null?void 0:j.map((q,W)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:q},W))}),e.jsx(ne,{title:"Restore Blog",description:"Are you sure to restore this blog?",icon:e.jsx(ce,{style:{color:"red"}}),okText:"Yes",cancelText:"No",onConfirm:()=>G(a),children:e.jsx(l.div,{whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx("img",{src:"Images/restore.svg",alt:"Restore",width:"20",height:"20",className:"cursor-pointer restore-icon"})})})]}),e.jsxs("div",{className:"mt-3 mb-2 flex justify-end text-xs text-right text-gray-500 font-medium",children:[(f==null?void 0:f.postedOn)&&e.jsxs("span",{children:["Posted on:",new Date(f.postedOn).toLocaleDateString("en-US",{dateStyle:"medium"})]}),e.jsxs("span",{className:"block -mb-2 text-sm text-right",children:["Archive Date:"," ",new Date(Y).toLocaleDateString("en-US",{dateStyle:"medium"})]})]})]})},a)})}),N>15&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4,delay:.3},className:"flex justify-center mt-6",children:e.jsx(de,{current:p,pageSize:c,total:N,pageSizeOptions:E.filter(t=>t<=100),onChange:(t,a)=>{o(t),a!==c&&(A(a),o(1))},showSizeChanger:!1,showTotal:t=>`Total ${t} blogs`,responsive:!0,disabled:n})})]})]})]})};export{Le as default};
