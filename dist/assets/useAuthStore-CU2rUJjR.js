var B=Object.defineProperty,K=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var F=(e,r,t)=>r in e?B(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,y=(e,r)=>{for(var t in r||(r={}))D.call(r,t)&&F(e,t,r[t]);if(A)for(var t of A(r))j.call(r,t)&&F(e,t,r[t]);return e},S=(e,r)=>K(e,z(r));var L=(e,r)=>{var t={};for(var s in e)D.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&A)for(var s of A(e))r.indexOf(s)<0&&j.call(e,s)&&(t[s]=e[s]);return t};var a=(e,r,t)=>new Promise((s,n)=>{var l=d=>{try{i(t.next(d))}catch(c){n(c)}},p=d=>{try{i(t.throw(d))}catch(c){n(c)}},i=d=>d.done?s(d.value):Promise.resolve(d.value).then(l,p);i((t=t.apply(e,r)).next())});import{a as u}from"./index-CHEUOGl9.js";import{p as E}from"./DataLayer-DALerVhB.js";import{s as T}from"./antd-8WQTeuab.js";import{c as Y}from"./react-wNxFir7h.js";const J={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_BACKEND_URL:"http://localhost:8000",VITE_EMAILJS_PUBLIC_KEY:"KBO-jpOGZJ3yw0x1e",VITE_EMAILJS_SERVICE_ID:"service_lka866s",VITE_EMAILJS_TEMPLATE_ID:"template_vv3nvib",VITE_FRONTEND_URL:"http://localhost:5174",VITE_GOOGLE_CLIENT_ID:"504189816110-r571tj94niako8mcl4dspuco5kbcvqhi.apps.googleusercontent.com",VITE_RECAPTCHA_SITE_KEY:"6LfA8ZorAAAAAGmOuRgP2MfdYe3iUUaXP5B65j5h",VITE_SHOW_TRIAL_CARD:"true",VITE_STRIPE_PUBLISHABLE_KEY:"pk_live_51Mki7oSBIDC2bddy8lPMGokqt3U7YC8znEwcREZF263glgKqMi84ctQqmpSn4apbES6sTOZnFs6aR9zT5YEIjQ9O00BJajmnTk",VITE_TRIAL_TEXT:"Start 3-Day Free Trial"},V=e=>!!e.dispatchFromDevtools&&typeof e.dispatch=="function",I=new Map,k=e=>{const r=I.get(e);return r?Object.fromEntries(Object.entries(r.stores).map(([t,s])=>[t,s.getState()])):{}},W=(e,r,t)=>{if(e===void 0)return{type:"untracked",connection:r.connect(t)};const s=I.get(t.name);if(s)return y({type:"tracked",store:e},s);const n={connection:r.connect(t),stores:{}};return I.set(t.name,n),y({type:"tracked",store:e},n)},$=(e,r)=>{if(r===void 0)return;const t=I.get(e);t&&(delete t.stores[r],Object.keys(t.stores).length===0&&I.delete(e))},q=e=>{var r,t;if(!e)return;const s=e.split(`
`),n=s.findIndex(p=>p.includes("api.setState"));if(n<0)return;const l=((r=s[n+1])==null?void 0:r.trim())||"";return(t=/.+ (.+) .+/.exec(l))==null?void 0:t[1]},H=(e,r={})=>(t,s,n)=>{const U=r,{enabled:l,anonymousActionType:p,store:i}=U,d=L(U,["enabled","anonymousActionType","store"]);let c;try{c=(l!=null?l:(J?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(w){}if(!c)return e(t,s,n);const N=W(i,c,d),{connection:o}=N,h=L(N,["connection"]);let g=!0;n.setState=((w,v,f)=>{const _=t(w,v);if(!g)return _;const M=f===void 0?{type:p||q(new Error().stack)||"anonymous"}:typeof f=="string"?{type:f}:f;return i===void 0?(o==null||o.send(M,s()),_):(o==null||o.send(S(y({},M),{type:`${i}/${M.type}`}),S(y({},k(d.name)),{[i]:n.getState()})),_)}),n.devtools={cleanup:()=>{o&&typeof o.unsubscribe=="function"&&o.unsubscribe(),$(d.name,i)}};const m=(...w)=>{const v=g;g=!1,t(...w),g=v},b=e(n.setState,s,n);if(h.type==="untracked"?o==null||o.init(b):(h.stores[h.store]=n,o==null||o.init(Object.fromEntries(Object.entries(h.stores).map(([w,v])=>[w,w===h.store?b:v.getState()])))),V(n)){let w=!1;const v=n.dispatch;n.dispatch=(...f)=>{(J?"production":void 0)!=="production"&&f[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),v(...f)}}return o.subscribe(w=>{var v;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return O(w.payload,f=>{if(f.type==="__setState"){if(i===void 0){m(f.state);return}Object.keys(f.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const _=f.state[i];if(_==null)return;JSON.stringify(n.getState())!==JSON.stringify(_)&&m(_);return}V(n)&&n.dispatch(f)});case"DISPATCH":switch(w.payload.type){case"RESET":return m(b),i===void 0?o==null?void 0:o.init(n.getState()):o==null?void 0:o.init(k(d.name));case"COMMIT":if(i===void 0){o==null||o.init(n.getState());return}return o==null?void 0:o.init(k(d.name));case"ROLLBACK":return O(w.state,f=>{if(i===void 0){m(f),o==null||o.init(n.getState());return}m(f[i]),o==null||o.init(k(d.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return O(w.state,f=>{if(i===void 0){m(f);return}JSON.stringify(n.getState())!==JSON.stringify(f[i])&&m(f[i])});case"IMPORT_STATE":{const{nextLiftedState:f}=w.payload,_=(v=f.computedStates.slice(-1)[0])==null?void 0:v.state;if(!_)return;m(i===void 0?_:_[i]),o==null||o.send(null,f);return}case"PAUSE_RECORDING":return g=!g}return}}),b},X=H,O=(e,r)=>{let t;try{t=JSON.parse(e)}catch(s){console.error("[zustand devtools middleware] Could not parse the received json",s)}t!==void 0&&r(t)},x=()=>a(null,null,function*(){try{const e=yield fetch("https://api.ipify.org?format=json"),{ip:r}=yield e.json();return r}catch(e){return console.error("IP Fecth Error",e),""}}),Z=(e,r=3,t=1e3)=>a(null,null,function*(){for(let s=0;s<r;s++)try{return yield e()}catch(n){if(s===r-1)throw n;yield new Promise(l=>setTimeout(l,t*Math.pow(2,s)))}}),Q=e=>a(null,null,function*(){return e.ip=yield x(),(yield u.post("/auth/login",e)).data}),ee=e=>a(null,null,function*(){return e.ip=yield x(),(yield u.post("/auth/register",e)).data}),te=()=>a(null,null,function*(){const e=yield u.get("/auth/logout");return localStorage.removeItem("token"),e.data}),se=e=>a(null,null,function*(){var t,s;if(!localStorage.getItem("token"))throw e("/login"),new Error("No authentication token found");try{return(yield Z(()=>u.get("/auth/me"),2,250)).data}catch(n){const l=(t=n==null?void 0:n.response)==null?void 0:t.status,p=(n==null?void 0:n.code)==="ERR_NETWORK";throw l===401||l===403?(localStorage.removeItem("token"),e("/login"),new Error("Session expired. Please log in again.")):p?(console.error("Network error: Backend server not reachable"),new Error("Unable to connect to the server. Please try again later.")):(console.error("Auth Error:",((s=n.response)==null?void 0:s.data)||n.message),new Error("User loading failed"))}}),re=e=>a(null,null,function*(){return(yield u.post("/auth/forgot-password",{email:e})).data}),ne=(e,r)=>a(null,null,function*(){return(yield u.post("/auth/reset-password",{token:e,newPassword:r})).data}),oe=e=>a(null,null,function*(){var r,t;try{return(yield u.post("/auth/google-signin",e)).data}catch(s){throw new Error(((t=(r=s.response)==null?void 0:r.data)==null?void 0:t.message)||"Google login failed")}}),G=()=>a(null,null,function*(){return(yield u.get("/user/profile")).data}),ae=()=>a(null,null,function*(){return(yield u.patch("/user/notifications/read")).data}),ie=()=>a(null,null,function*(){return(yield u.get("/user/transactions")).data}),ce=e=>a(null,null,function*(){return(yield u.put("/user/profile",e)).data}),he=e=>a(null,null,function*(){return(yield u.post("/user/update-password",e)).data}),we=()=>a(null,null,function*(){return(yield u.post("/user/referral/generate")).data}),me=()=>a(null,null,function*(){return(yield u.get("/user/referral/stats")).data}),_e=()=>a(null,null,function*(){return(yield u.get("/user/email-preferences")).data}),ye=e=>a(null,null,function*(){return(yield u.put("/user/email-preferences",e)).data}),ve=()=>a(null,null,function*(){return(yield u.patch("/stripe/cancel-subscription")).data}),Se=e=>a(null,null,function*(){return(yield u.post("/generate/humanised-content",e)).data}),Ee=e=>a(null,null,function*(){return(yield u.get(`/integrations/category?type=${e}`)).data}),Ie=()=>a(null,null,function*(){return(yield u.get("/integrations")).data}),be=e=>a(null,null,function*(){return(yield u.get(`/integrations/ping?type=${e}`)).data}),Ae=e=>a(null,null,function*(){return(yield u.post("/integrations",e)).data}),Te=e=>a(null,null,function*(){return(yield u.post("/generate/outline",e)).data}),ke=e=>a(null,null,function*(){return(yield u.post("/generate/metadata",e)).data}),Pe=t=>a(null,[t],function*({prompt:e,content:r}){try{return(yield u.post("/generate/prompt-content",{prompt:e,content:r})).data}catch(s){throw new Error(s||"Failed to generate prompt content")}}),le=e=>a(null,null,function*(){try{return(yield u.get(`/public/unsubscribe?email=${encodeURIComponent(e)}`)).data}catch(r){throw new Error(r||"Failed to unsubscribe")}}),Me=e=>a(null,null,function*(){return(yield u.put("/integrations/post",e)).data}),P=e=>localStorage.setItem("token",e),R=()=>localStorage.removeItem("token"),C=()=>localStorage.getItem("token"),Le=Y(X((e,r)=>({user:null,token:C(),loading:!1,error:null,isAuthenticated:!!C(),forgotMessage:null,resetMessage:null,transactions:[],profileLoading:!1,unsubscribeSuccessMessage:null,setUser:t=>e({user:t,isAuthenticated:!!t}),setToken:t=>{P(t),e({token:t,isAuthenticated:!0})},clearAuth:()=>{R(),e({user:null,token:null,isAuthenticated:!1,error:null,unsubscribeSuccessMessage:null})},resetUnsubscribe:()=>e({unsubscribeSuccessMessage:null,error:null,loading:!1}),updateCredits:t=>{const s=r().user;s&&e({user:S(y({},s),{credits:t})})},addNotification:t=>{const s=r().user;if(s){const n=s.notifications?[t,...s.notifications]:[t];e({user:S(y({},s),{notifications:n})})}},updateUserPartial:t=>{const s=r().user;s&&e({user:y(y({},s),t)})},loginUser:l=>a(null,[l],function*({email:t,password:s,captchaToken:n}){var p,i,d,c;e({loading:!0,error:null});try{const{user:o,token:h}=yield Q({email:t,password:s,captchaToken:n});if(h&&o)return P(h),E({event:"login_attempt",event_status:"success",auth_method:"email_password",user_id:o._id,user_subscription:o.subscription.plan}),e({user:o,token:h,isAuthenticated:!0,loading:!1}),{user:o,token:h};throw new Error("Invalid login response")}catch(o){E({event:"login_attempt",event_status:"fail",auth_method:"email_password",error_msg:(o==null?void 0:o.message)||((i=(p=o==null?void 0:o.response)==null?void 0:p.data)==null?void 0:i.message)||"Login Failed"});const h=((c=(d=o==null?void 0:o.response)==null?void 0:d.data)==null?void 0:c.message)||o.message||"Login failed";throw e({loading:!1,error:h}),o}}),signupUser:i=>a(null,[i],function*({email:t,password:s,name:n,captchaToken:l,referralId:p}){var d,c,o,h;e({loading:!0,error:null});try{const{user:g,token:m}=yield ee({email:t,password:s,name:n,captchaToken:l,referralId:p});if(m&&g)return P(m),E({event:"sign_up_attempt",event_status:"success",auth_method:"email_password",user_id:g._id,user_subscription:g.subscription.plan}),e({user:g,token:m,isAuthenticated:!0,loading:!1}),{user:g,token:m};throw new Error("Invalid signup response")}catch(g){E({event:"sign_up_attempt",event_status:"fail",auth_method:"email_password",error_msg:(g==null?void 0:g.message)||((c=(d=g==null?void 0:g.response)==null?void 0:d.data)==null?void 0:c.message)||"Signup Failed"});const m=((h=(o=g==null?void 0:g.response)==null?void 0:o.data)==null?void 0:h.message)||g.message||"Signup failed";throw e({loading:!1,error:m}),g}}),googleLogin:n=>a(null,[n],function*({access_token:t,referralId:s}){var l,p,i,d;e({loading:!0,error:null});try{const c=yield oe({access_token:t,referralId:s});if(!c.success||!c.token||!c.user)throw new Error("Invalid Google login response");P(c.token);const{user:o,authStatus:h}=c;return E(S(y({},h=="sign_up"?{event:"sign_up_attempt"}:{event:"google_auth",event_type:h}),{event_status:"success",auth_method:"google_oauth",user_id:o._id,user_subscription:o.subscription.plan})),e({user:o,token:c.token,isAuthenticated:!0,loading:!1}),c}catch(c){E({event:"google_auth",event_status:"fail",auth_method:"google_oauth",error_msg:(c==null?void 0:c.message)||((p=(l=c==null?void 0:c.response)==null?void 0:l.data)==null?void 0:p.message)||"Google Login Failed"});const o=((d=(i=c==null?void 0:c.response)==null?void 0:i.data)==null?void 0:d.message)||c.message||"Google Login Failed";throw e({loading:!1,error:o}),c}}),loadAuthenticatedUser:()=>a(null,null,function*(){const t=C();if(!t){e({user:null,token:null,isAuthenticated:!1});return}e({loading:!0});try{const s=yield se();if(s!=null&&s.success&&(s!=null&&s.user))return e({user:s.user,token:t,isAuthenticated:!0,loading:!1}),{user:s.user,token:t};throw new Error("Failed to load user")}catch(s){throw R(),e({user:null,token:null,isAuthenticated:!1,loading:!1,error:s.message}),s}}),logoutUser:()=>a(null,null,function*(){try{yield te()}catch(t){console.warn("Logout API failed",t)}R(),e({user:null,token:null,isAuthenticated:!1,error:null})}),forgotPassword:t=>a(null,null,function*(){var s,n;e({loading:!0,error:null,forgotMessage:null});try{const l=yield re(t);return e({loading:!1,forgotMessage:l}),l}catch(l){const p=((n=(s=l.response)==null?void 0:s.data)==null?void 0:n.error)||"Failed to send reset link";throw e({loading:!1,error:p}),l}}),resetPassword:n=>a(null,[n],function*({token:t,newPassword:s}){var l,p;e({loading:!0,error:null,resetMessage:null});try{const i=yield ne(t,s);return e({loading:!1,resetMessage:i.message}),i.message}catch(i){const d=((p=(l=i.response)==null?void 0:l.data)==null?void 0:p.error)||"Failed to reset password";throw e({loading:!1,error:d}),i}}),fetchUserProfile:()=>a(null,null,function*(){e({profileLoading:!0,error:null});try{const t=yield G();return e({user:t,isAuthenticated:!0,profileLoading:!1}),t}catch(t){throw T.error("Failed to fetch user profile"),e({profileLoading:!1,error:t.message}),t}}),markAllNotificationsAsRead:()=>a(null,null,function*(){var t,s;e({loading:!0});try{const l=(yield ae()).updatedNotifications||[],p=r().user;return p&&e({user:S(y({},p),{notifications:p.notifications.map(i=>S(y({},i),{read:!0}))})}),e({loading:!1}),l}catch(n){const l=((s=(t=n.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to mark notifications as read.";throw T.error(l),e({loading:!1,error:l}),n}}),fetchTransactions:()=>a(null,null,function*(){e({loading:!0,error:null});try{const t=yield ie();return e({transactions:t||[],loading:!1}),t||[]}catch(t){throw T.error("Failed to fetch transactions"),e({loading:!1,error:t.message}),t}}),updateProfile:t=>a(null,null,function*(){e({loading:!0,error:null});try{const s=yield ce(t),n=yield G();return e({user:n,loading:!1}),s}catch(s){throw T.error("Error updating profile, try again"),e({loading:!1,error:s.message}),s}}),unsubscribeAction:t=>a(null,null,function*(){e({loading:!0,error:null,unsubscribeSuccessMessage:null});try{const s=yield le(t);return e({loading:!1,unsubscribeSuccessMessage:s}),s}catch(s){const n=s.message||"Failed to unsubscribe";throw e({loading:!1,error:n}),s}})}),{name:"auth-store"}));export{Ie as a,me as b,_e as c,X as d,we as e,Ee as f,ke as g,ye as h,he as i,Se as j,ve as k,ce as l,ie as m,Pe as n,Te as o,Me as p,Ae as q,be as r,Le as u};
