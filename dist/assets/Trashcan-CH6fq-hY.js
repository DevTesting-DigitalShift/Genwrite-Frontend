var M=(c,d,l)=>new Promise((C,h)=>{var T=s=>{try{u(l.next(s))}catch(y){h(y)}},m=s=>{try{u(l.throw(s))}catch(y){h(y)}},u=s=>s.done?C(s.value):Promise.resolve(s.value).then(T,m);u((l=l.apply(c,d)).next())});import{r as o,a0 as ae,u as se,z as ie,ak as le,j as e,H as re,m as n,B as z,T as ne,Y as _,aZ as oe,a_ as de,a$ as ce}from"./index-Cir5fXWr.js";import{b as me}from"./SkeletonLoader-NjWXFQUf.js";import{l as pe}from"./lodash-wa6Iow1A.js";import{d as q}from"./dayjs.min-27cklWWK.js";import{u as xe}from"./useQuery-HrFL_SW4.js";import{u as $}from"./useMutation-CfR92CFm.js";import{R as he}from"./refresh-ccw-BXZNyVDG.js";import{T as ue}from"./trash-2-Dz1gaMu9.js";import{I as G}from"./index-CgkAoVZ6.js";import{S as ge}from"./search-C0Vi52eM.js";import{S as L}from"./index-BYB_VxCH.js";import{B as fe}from"./index-C2S2juQV.js";import{P as be}from"./index-W8-8Op0V.js";import{c as ye}from"./createLucideIcon-Dlxw-fv2.js";import{R as je}from"./QuestionCircleOutlined-Bq7IybJG.js";import{P as we}from"./Pagination-FT9gZa5Q.js";import"./clsx-B-dksMZM.js";import"./Input-DfxkVeTs.js";import"./SearchOutlined-COPiOLu_.js";import"./Overflow-Bk8VGYjb.js";import"./index-KPe2R8eH.js";import"./index-DVAGHRQc.js";import"./LeftOutlined-CRbgy7da.js";import"./useBreakpoint-D8e201UQ.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Ne=ye("archive-restore",ve),{Search:We}=G,{Option:k}=L,Ye=()=>{const[c,d]=o.useState(1),[l,C]=o.useState(15),[h,T]=o.useState(""),[m,u]=o.useState("all"),[s,y]=o.useState([null,null]),{handlePopup:O}=ae(),P=se(),j=ie(),w=le(),H=85,Q=[10,15,20,50],K=o.useCallback(pe.debounce(t=>{T(t),d(1)},500,{leading:!1,trailing:!0,maxWait:1e3}),[]),{data:p,isLoading:x}=xe({queryKey:["trashedBlogs",m,h,s,c,l],queryFn:()=>M(null,null,function*(){const t={isArchived:!0,status:m!=="all"?m:void 0,q:h||void 0,start:s[0]?q(s[0]).toISOString():void 0,end:s[1]?q(s[1]).toISOString():void 0,page:c,limit:l},a=yield ce(t);return{trashedBlogs:a.data||[],totalBlogs:a.totalItems||0}}),keepPreviousData:!0}),B=(p==null?void 0:p.trashedBlogs)||[],D=(p==null?void 0:p.totalBlogs)||0,U=$({mutationFn:t=>P(de(t)).unwrap(),onSuccess:()=>{w.invalidateQueries({queryKey:["trashedBlogs"],exact:!1}),w.invalidateQueries({queryKey:["blogs"],exact:!1})},onError:t=>{console.error("Failed to restore blog:",t),_.error("Failed to restore blog. Please try again.")}}),V=$({mutationFn:()=>P(oe()).unwrap(),onSuccess:()=>{w.invalidateQueries({queryKey:["trashedBlogs"],exact:!1}),d(1)},onError:t=>{console.error("Failed to delete all blogs:",t),_.error("Failed to delete all blogs. Please try again.")}});o.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[c]);const R=(t,a=H)=>t?t.length>a?t.substring(0,a)+"...":t:"",E=t=>{var a,g,r;return(r=(g=(a=t==null?void 0:t.replace(/<[^>]*>/g,""))==null?void 0:a.replace(/[\\*#=_~`>\-]+/g,""))==null?void 0:g.replace(/\s{2,}/g," "))==null?void 0:r.trim()},W=t=>{U.mutate(t)},Y=()=>{V.mutate()},Z=()=>{w.invalidateQueries(["trashedBlogs"])},F=o.useCallback(t=>{j(`/toolbox/${t._id}`)},[j]),X=t=>{j(`/blog-editor/${t._id}`)};return e.jsxs("div",{className:"p-2 md:p-4 lg:p-8 max-w-full",children:[e.jsx(re,{children:e.jsx("title",{children:"Trashcan | GenWrite"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row sm:justify-between items-center mt-5 p-2 md:mt-0 md:p-0",children:[e.jsxs("div",{children:[e.jsx(n.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4},className:"text-3xl font-extrabold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2",children:"Trashcan"}),e.jsx(n.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"text-gray-600 text-sm max-w-xl mb-4",children:"Restore valuable work or permanently delete clutter. Trashed items are deleted after 7 days."})]}),e.jsxs("div",{className:"flex  gap-2",children:[e.jsx(n.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(z,{type:"default",icon:e.jsx(he,{className:"w-4 sm:w-5 h-4 sm:h-5"}),onClick:Z,disabled:x,className:"text-xs sm:text-sm px-4 py-2",children:"Refresh"})}),B.length>0&&e.jsx(n.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(z,{type:"default",icon:e.jsx(ue,{className:"w-4 sm:w-5 h-4 sm:h-5"}),onClick:()=>O({title:"Delete All Trashed Blogs",description:e.jsxs("span",{className:"my-2",children:["All trashed blogs will be ",e.jsx("b",{children:"permanently deleted"}),". This action cannot be undone."]}),confirmText:"Delete All",onConfirm:Y,confirmProps:{className:"border-red-500 hover:bg-red-500 hover:text-white"},cancelProps:{danger:!1}}),disabled:x,className:"text-xs sm:text-sm px-4 py-2",children:"Delete All"})})]})]}),e.jsx(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},className:"bg-white/90 p-4 sm:p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(G,{placeholder:"Search by title or keywords...",onChange:t=>K(t.target.value),prefix:e.jsx(ge,{className:"w-4 sm:w-5 h-4 sm:h-5 text-gray-400 mr-2 sm:mr-3"}),allowClear:!0,className:"w-full rounded-lg focus:ring-0 focus:ring-blue-300 text-xs sm:text-sm shadow-none",disabled:x}),e.jsxs(L,{value:m,onChange:t=>{u(t),d(1)},className:"w-full sm:w-48 rounded-lg text-xs sm:text-sm",placeholder:"Filter by status",disabled:x,children:[e.jsx(k,{value:"all",children:"All Status"}),e.jsx(k,{value:"complete",children:"Complete"}),e.jsx(k,{value:"failed",children:"Failed"}),e.jsx(k,{value:"pending",children:"Pending"})]})]})}),x?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8",children:[...Array(l)].map((t,a)=>e.jsx("div",{className:"bg-white shadow-md rounded-lg p-4 sm:p-6",children:e.jsx(me,{})},a))}):B.length===0?e.jsxs(n.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4},className:"flex flex-col justify-center items-center",style:{minHeight:"calc(100vh - 250px)"},children:[e.jsx("img",{src:"Images/trash-can.png",alt:"Trash",className:"w-20 sm:w-24"}),e.jsx("p",{className:"text-lg sm:text-xl mt-5 text-gray-600",children:"No trashed blogs available."})]}):e.jsxs(e.Fragment,{children:[e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 md:gap-8 p-2",children:B.map(t=>{const a=t.isManuallyEdited===!0,{_id:g,title:r,status:i,createdAt:J,content:I,aiModel:f,focusKeywords:A,wordpress:v,archiveDate:ee,agendaJob:N}=t,S=/gemini/gi.test(f);return e.jsx(fe.Ribbon,{text:e.jsx("span",{className:"flex items-center justify-center gap-1 py-1 font-medium tracking-wide text-xs sm:text-sm",children:a?e.jsx(e.Fragment,{children:"Manually Generated"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`./Images/${S?"gemini":f==="claude"?"claude":"chatgpt"}.png`,alt:S?"Gemini":f==="claude"?"Claude":"ChatGPT",width:16,height:16,loading:"lazy",className:"bg-white"}),S?"Gemini 2.0 flash":f==="claude"?"Claude 4 sonnet":"Gpt 4.1 nano"]})}),className:"absolute top-0",color:a?"#9CA3AF":S?"#4796E3":f==="claude"?"#9368F8":"#74AA9C",children:e.jsxs("div",{className:`bg-white shadow-md hover:shadow-xl transition-all duration-300 rounded-lg p-4 sm:p-6 min-h-[180px] min-w-0 relative ${a?"border-gray-500":i==="failed"?"border-red-500":i==="pending"||i==="in-progress"?"border-yellow-500":"border-green-500"} border-2`,title:r,children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 -mt-2",children:new Date(J).toLocaleDateString("en-US",{dateStyle:"medium"})}),a?e.jsx("div",{className:"cursor-pointer",onClick:()=>X(t),role:"button",tabIndex:0,onKeyDown:b=>b.key==="Enter"&&j("/blog-editor"),"aria-label":`View blog ${r}`,children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-base sm:text-lg capitalize font-semibold text-gray-900 !text-left max-w-full",children:r}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:R(E(I))||""})]})}):e.jsx(ne,{title:i==="complete"?r:i==="failed"?"Blog generation failed":i==="pending"?`Pending Blog will be generated ${N!=null&&N.nextRunAt?"at "+new Date(N.nextRunAt).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"shortly"}`:`Blog generation is ${i}`,color:i==="complete"?"green":i==="failed"?"red":"#eab308",children:e.jsx("div",{className:"cursor-pointer",onClick:()=>{(i==="complete"||i==="failed")&&F(t)},role:"button",tabIndex:0,onKeyDown:b=>b.key==="Enter"&&(i==="complete"||i==="failed")&&F(t),"aria-label":`View blog ${r}`,children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-base sm:text-lg capitalize font-semibold text-gray-900 !text-left max-w-full",children:r}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:R(E(I))||""})]})})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:A==null?void 0:A.map((b,te)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2 sm:px-2.5 py-0.5 rounded-full",children:b},te))}),e.jsx(be,{title:"Restore Blog",description:"Are you sure to restore this blog?",icon:e.jsx(je,{style:{color:"red"}}),okText:"Yes",cancelText:"No",onConfirm:()=>W(g),children:e.jsx(n.div,{whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(Ne,{className:"w-5 h-5 cursor-pointer"})})})]}),e.jsxs("div",{className:"mt-3 mb-2 flex justify-end text-xs sm:text-sm text-right text-gray-500 font-medium",children:[(v==null?void 0:v.postedOn)&&e.jsxs("span",{children:["Posted on:",new Date(v.postedOn).toLocaleDateString("en-US",{dateStyle:"medium"})]}),e.jsxs("span",{className:"block -mb-2",children:["Archive Date:"," ",new Date(ee).toLocaleDateString("en-US",{dateStyle:"medium"})]})]})]})},g)})}),D>15&&e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.4,delay:.3},className:"flex justify-center mt-6",children:e.jsx(we,{current:c,pageSize:l,total:D,pageSizeOptions:Q.filter(t=>t<=100),onChange:(t,a)=>{d(t),a!==l&&(C(a),d(1))},showSizeChanger:!1,showTotal:t=>`Total ${t} blogs`,responsive:!0,disabled:x})})]})]}),e.jsx("style",{children:`
          .ant-input-search .ant-input {
            border-radius: 8px !important;
            border: 1px solid #d1d5db !important;
            padding: 6px 12px !important;
          }
          .ant-input-search .ant-input:focus,
          .ant-input-search .ant-input:hover {
            border-color: #3b82f6 !important;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2) !important;
          }
          .ant-input-search .ant-input-prefix {
            display: flex;
            align-items: center;
            margin-right: 8px;
          }
          .ant-select-selector {
            border-radius: 8px !important;
            border: 1px solid #d1d5db !important;
          }
          @media (max-width: 640px) {
            .ant-input {
              font-size: 12px !important;
              padding: 4px 8px !important;
            }
            .ant-select-selector {
              font-size: 12px !important;
              padding: 4px 8px !important;
            }
            .ant-btn {
              font-size: 12px !important;
              padding: 4px 8px !important;
            }
            .ant-badge .ant-ribbon {
              font-size: 10px !important;
              padding: 2px 4px !important;
            }
          }
          @media (min-width: 768px) and (max-width: 1024px) {
            .grid {
              grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
            }
            .grid > div {
              min-width: 0 !important;
            }
          }
        `})]})};export{Ye as default};
