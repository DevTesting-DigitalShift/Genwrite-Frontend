import{q as _,a as M,Z as z,j as e,m as S,T as G,N as U,b as y,Y as o}from"./index-IEu-g-tg.js";import{b as l}from"./chunk-tiptap-Bpe5wDXG.js";import{S as Y}from"./SkeletonLoader-Djp64NgK.js";import{B as q}from"./index-CBoHcm9M.js";import{P as O}from"./index-DZMsL0Jb.js";import{T as W}from"./trash-2-BBrMuZ83.js";import"./index-CoucbzW9.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],B=_("rotate-ccw",H),te=()=>{const[j,w]=l.useState([]),[v,A]=l.useState(1),[n,g]=l.useState(5),[k,N]=l.useState(!0),C=M(),{handlePopup:D}=z(),L=async()=>{var s,t;try{N(!0);const x=(await y.get("/blogs/")).data.filter(i=>!i.isArchived).sort((i,p)=>new Date(p.createdAt)-new Date(i.createdAt));w(x)}catch(a){console.error("Error fetching blogs:",((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to fetch blogs")}finally{N(!1)}};l.useEffect(()=>{L()},[]),l.useEffect(()=>{const s=()=>{window.innerWidth>=1024?g(15):window.innerWidth>=768?g(12):g(6)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const E=s=>{C(`/toolbox/${s._id}`,{state:{blog:s}})},T=async s=>{var t;try{const a=await y.post(`blogs/${s}/retry`);console.log("response",a),a.status===200?o.success(((t=a==null?void 0:a.data)==null?void 0:t.message)||"Blog regenerated successfully!"):o.error("Failed to regenerated blog.")}catch(a){o.error("Failed to regenerated blog."),console.error("Error regenerating blog:",a.response&&a.response.data&&a.response.data.message||"Failed to restore blog")}},h=Math.ceil(j.length/n),P=(v-1)*n,c=j.slice(P,P+n),$=s=>{A(s)},F=async s=>{try{(await y.patch(`/blogs/archive/${s}`)).status===200?(w(a=>a.filter(r=>r._id!==s)),o.success("Blog archived successfully!")):o.error("Failed to archive blog.")}catch(t){o.error("Failed to archive blog."),console.error("Error archiving blog:",t.response&&t.response.data&&t.response.data.message||"Failed to archive blog")}};return e.jsxs("div",{className:"p-5",children:[e.jsx(S.h1,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-3xl md:text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Blogs Generated"}),e.jsx(S.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-gray-600 max-w-xl mt-2 mb-5",children:"All your content creation tools in one place. Streamline your workflow with our powerful suite of tools."}),k?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:[...Array(n)].map((s,t)=>e.jsx("div",{className:"bg-white shadow-md rounded-xl p-4",children:e.jsx(Y,{})},t))}):c.length===0?e.jsxs("div",{className:"flex flex-col justify-center items-center",style:{minHeight:"calc(100vh - 270px)"},children:[e.jsx("img",{src:"Images/no-blog.png",alt:"Trash",style:{width:"8rem"}}),e.jsx("p",{className:"text-xl mt-5",children:"No blogs available."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 place-items-center p-2",children:c==null?void 0:c.map(s=>{const{_id:t,title:a,status:r,createdAt:x,content:i,aiModel:p,focusKeywords:u,updatedAt:I,wordpress:d,agendaJob:m}=s,f=/gemini/gi.test(p);return e.jsx(q.Ribbon,{text:e.jsxs("span",{className:"flex items-center justify-center gap-1 py-1 font-medium tracking-wide",children:[e.jsx("img",{src:`./Images/${f?"gemini":"chatgpt"}.png`,alt:"",width:20,height:20,loading:"lazy",className:"bg-white"}),f?"Gemini-1.5-flash":"Chatgpt-4o-mini"]}),className:"absolute top-0",color:f?"#4796E3":"#74AA9C",children:e.jsxs("div",{className:`bg-white shadow-md  hover:shadow-xl  transition-all duration-300 rounded-xl p-4 min-h-[180px] min-w-[390px] relative
                        ${(r==="failed"?"border-red-500":r!=="complete"&&"border-yellow-500")+" border-2"}
                      `,title:a,children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 -mt-2",children:new Date(x).toLocaleDateString("en-US",{dateStyle:"medium"})}),e.jsx(G,{title:r==="complete"?a:["failed","in-progress"].includes(r)?`Blog generation is ${r}`:`Pending Blog will be generated ${m!=null&&m.nextRunAt?"at "+new Date(m.nextRunAt).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"shortly"}`,color:r==="complete"?"black":r==="failed"?"red":"orange",children:e.jsx("div",{className:"cursor-pointer",onClick:()=>{const{status:b}=s;b==="complete"&&E(s)},children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2 ",children:[e.jsx("h3",{className:"text-lg capitalize font-semibold text-gray-900 !text-left max-w-76",children:a}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:i||""})]})})}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:u==null?void 0:u.map((b,R)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:b},R))}),r==="failed"&&e.jsx(O,{title:"Retry Blog Generation",description:"Are you sure you want to retry generating this blog?",icon:e.jsx(B,{style:{color:"red"},size:15,className:"mt-1 mr-1"}),okText:"Yes",cancelText:"No",onConfirm:()=>T(t),children:e.jsx(B,{})}),e.jsx(U,{type:"undefined",className:"p-2 hover:!border-red-500 hover:text-red-500",onClick:()=>D({title:"Move to Trash",description:e.jsxs("span",{className:"my-2",children:["Blog ",e.jsx("b",{children:a})," will be moved to trash. You can restore it later."]}),confirmText:"Archive",onConfirm:()=>{console.log("Trashing blog:",t),F(t)},confirmProps:{type:"undefined",className:"border-red-500 hover:bg-red-500 hover:text-white"},cancelProps:{danger:!1}}),children:e.jsx(W,{})})]}),e.jsxs("div",{className:"mt-3 -mb-2 flex justify-end text-xs text-right text-gray-500 font-medium",children:[(d==null?void 0:d.postedOn)&&e.jsxs("span",{className:"",children:["Posted on :  ",new Date(d.postedOn).toLocaleDateString("en-US",{dateStyle:"medium"})]}),e.jsxs("span",{className:"ml-auto",children:["Last updated :  ",new Date(I).toLocaleDateString("en-US",{dateStyle:"medium"})]})]})]})},t)})}),h>1&&e.jsx("div",{className:"flex justify-center mt-8 self-end",children:e.jsx("nav",{className:"inline-flex rounded-md shadow",children:e.jsx("ul",{className:"flex",children:Array.from({length:h},(s,t)=>e.jsx("li",{children:e.jsx("button",{onClick:()=>$(t+1),className:`px-4 py-2 border-r border-gray-200 text-sm font-medium ${v===t+1?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"} ${t===0?"rounded-l-md":""} ${t===h-1?"rounded-r-md border-r-0":""}`,children:t+1})},t))})})})]})]})};export{te as default};
