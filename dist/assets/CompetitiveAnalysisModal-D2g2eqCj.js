import{j as e,o as b,B as o}from"./index-DrDbEico.js";import{b as a}from"./chunk-tiptap-M85eTu9n.js";import{X as f}from"./x-B2KoWfN-.js";const E=({closefnc:d})=>{var p;const[r,c]=a.useState({title:"",content:"",keywords:[],keywordInput:"",contentType:"text",selectedProject:null}),[m,j]=a.useState([]),[P,x]=a.useState(!0),[u,y]=a.useState(!1),[l,w]=a.useState(null);a.useEffect(()=>{(async()=>{try{const i=(await b.get("/blogs")).data.slice(-10).reverse();j(i),x(!1)}catch(s){console.error("Error fetching recent projects:",s),o.error("Failed to load recent projects"),x(!1)}})()},[]);const g=t=>{const{name:s,value:n}=t.target;c(i=>({...i,[s]:n}))},v=t=>{c(s=>({...s,title:t.title,content:t.content,keywords:t.focusKeywords||[],selectedProject:t,contentType:"markdown"}))},N=t=>{c(s=>({...s,keywordInput:t.target.value}))},h=()=>{const t=r.keywordInput;if(t.trim()!==""){const s=t.split(",").map(n=>n.trim()).filter(n=>n!==""&&!r.keywords.includes(n));s.length>0&&c(n=>({...n,keywords:[...n.keywords,...s],keywordInput:""}))}},k=t=>{c(s=>({...s,keywords:s.keywords.filter((n,i)=>i!==t)}))},C=t=>{t.key==="Enter"&&(t.preventDefault(),h())},A=async()=>{if(!r.title.trim()){o.error("Please enter a blog title");return}if(!r.content.trim()){o.error("Please enter blog content");return}if(r.keywords.length===0){o.error("Please add at least one keyword");return}y(!0);try{const t=await b.post("/analysis/run",{title:r.title,content:r.content,keywords:r.keywords,contentType:r.contentType});t.data&&(w(t.data),o.success("Analysis completed successfully!"))}catch(t){console.error("Error performing competitive analysis:",t),o.error("Failed to perform competitive analysis")}finally{y(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"w-[800px] bg-white rounded-lg shadow-xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Competitive Analysis"}),e.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600",children:e.jsx(f,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"px-6 py-4 overflow-y-auto",children:e.jsx("div",{className:"space-y-6",children:l?e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Analysis Results"}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-md",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Analysis:"}),e.jsx("ul",{className:"list-disc ml-5 mt-1",children:Object.entries(l.analysis).map(([t,s])=>e.jsxs("li",{className:"mb-1",children:[e.jsxs("strong",{children:[t.replace(/([A-Z])/g," $1"),": "]}),s]},t))})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-4",children:[e.jsx("strong",{children:"Suggestions:"})," ",l.suggestions]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-4",children:[e.jsx("strong",{children:"Summary:"})," ",l.summary]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-4",children:[e.jsx("strong",{children:"Blog Score:"})," ",l.blogScore," / 100"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Recent Project"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500 max-h-[200px] overflow-y-auto",onChange:t=>{const s=m.find(n=>n._id===t.target.value);s&&v(s)},value:((p=r.selectedProject)==null?void 0:p._id)||"",children:[e.jsx("option",{value:"",children:"Select a project"}),m.map(t=>e.jsx("option",{value:t._id,children:t.title},t._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blog Title"}),e.jsx("input",{type:"text",name:"title",value:r.title,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your blog title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blog Content"}),e.jsx("textarea",{name:"content",value:r.content,onChange:g,className:"w-full h-40 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500",placeholder:`Enter your blog content in ${r.contentType} format`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keywords"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:r.keywordInput,onChange:N,onKeyDown:C,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Add keywords (comma-separated)"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.keywords.map((t,s)=>e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800",children:[t,e.jsx("button",{type:"button",onClick:()=>k(s),className:"ml-1.5 flex-shrink-0 text-indigo-400 hover:text-indigo-600",children:e.jsx(f,{className:"w-3 h-3"})})]},s))})]})]})})}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t",children:[e.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"}),!l&&e.jsx("button",{onClick:A,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",disabled:u,children:u?"Analyzing...":"Analyze"})]})]})})};export{E as C};
