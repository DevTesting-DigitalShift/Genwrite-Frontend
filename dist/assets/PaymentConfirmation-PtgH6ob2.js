import{w as E,t as g,j as a,T as x,B as f,q as P}from"./index-D_Iu5SBb.js";import{C as R}from"./index-7PQUmDte.js";import{D as l}from"./index-mLkjVz42.js";import"./chunk-tiptap-JX9QK0Ia.js";import"./EllipsisOutlined-BHXRno_5.js";import"./PlusOutlined-ByZyTB3m.js";import"./useBreakpoint-BnvROIcw.js";var w="basil",L=function(r){return r===3?"v3":r},S="https://js.stripe.com",I="".concat(S,"/").concat(w,"/stripe.js"),T=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,b=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var C=function(r){return T.test(r)||b.test(r)},_=function(){for(var r=document.querySelectorAll('script[src^="'.concat(S,'"]')),e=0;e<r.length;e++){var t=r[e];if(C(t.src))return t}return null},h=function(r){var e="",t=document.createElement("script");t.src="".concat(I).concat(e);var n=document.head||document.body;if(!n)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(t),t},V=function(r,e){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"7.3.1",startTime:e})},u=null,p=null,m=null,k=function(r){return function(e){r(new Error("Failed to load Stripe.js",{cause:e}))}},A=function(r,e){return function(){window.Stripe?r(window.Stripe):e(new Error("Stripe.js not available"))}},G=function(r){return u!==null?u:(u=new Promise(function(e,t){if(typeof window>"u"||typeof document>"u"){e(null);return}if(window.Stripe){e(window.Stripe);return}try{var n=_();if(!(n&&r)){if(!n)n=h(r);else if(n&&m!==null&&p!==null){var s;n.removeEventListener("load",m),n.removeEventListener("error",p),(s=n.parentNode)===null||s===void 0||s.removeChild(n),n=h(r)}}m=A(e,t),p=k(t),n.addEventListener("load",m),n.addEventListener("error",p)}catch(o){t(o);return}}),u.catch(function(e){return u=null,Promise.reject(e)}))},N=function(r,e,t){if(r===null)return null;var n=e[0],s=n.match(/^pk_test/),o=L(r.version),c=w;s&&o!==c&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("7.3.1"," expected Stripe.js@").concat(c,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var v=r.apply(void 0,e);return V(v,t),v},d,j=!1,y=function(){return d||(d=G(null).catch(function(r){return d=null,Promise.reject(r)}),d)};Promise.resolve().then(function(){return y()}).catch(function(i){j||console.warn(i)});var U=function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];j=!0;var n=Date.now();return y().then(function(s){return N(s,e,n)})};const{Title:W}=x;function J(){const i=E(),r=g(),{plan:e,customCredits:t}=r.state||{},n=async()=>{const s=await U("pk_test_51RRByjPwKVl4RglV8Y5NfbjePOnbdIyEHMRdrWpmv0XxMAqc3X6bFcfEXKKGIOF9M3SlvCBNjVTt2R2rTOgWwjyx00yjpRvpMz");try{const o=await P.post("/stripe/checkout",{planName:e.name.toLowerCase().includes("pro")?"pro":e.name.toLowerCase().includes("enterprise")?"enterprise":"credits",credits:e.type==="credit_purchase"?t:e.credits,success_url:`${window.location.origin}/payment/success`,cancel_url:`${window.location.origin}/payment/cancel`});if(console.log(o.data),o!=null&&o.data.sessionId){const c=await s.redirectToCheckout({sessionId:o.data.sessionId});if(c!=null&&c.error)throw error}else throw new Error("Something went wrong")}catch(o){console.error("Error creating checkout session:",o),alert("Failed to initiate checkout. Please try again.")}};if(!(e!=null&&e.name))throw new Error("Invalid Payment Request");return a.jsxs(R,{style:{maxWidth:600,margin:"40px auto"},children:[a.jsx(W,{level:3,children:"Confirm Your Payment"}),a.jsxs(l,{bordered:!0,column:1,children:[a.jsx(l.Item,{label:"Plan Name",children:e.name}),a.jsx(l.Item,{label:"Type",children:e.type}),a.jsx(l.Item,{label:"Price",children:`$${(t?t*.05:e.price).toFixed(2)}`}),t>0&&a.jsx(l.Item,{label:"Credits",children:t})]}),a.jsxs("div",{style:{marginTop:24,textAlign:"center"},children:[a.jsx(f,{type:"primary",onClick:n,children:"Proceed to Pay"}),a.jsx(f,{style:{marginLeft:12},onClick:()=>i(-1),children:"Go Back"})]})]})}export{J as default};
