var E=(g,N,u)=>new Promise((f,b)=>{var v=n=>{try{y(u.next(n))}catch(c){b(c)}},l=n=>{try{y(u.throw(n))}catch(c){b(c)}},y=n=>n.done?f(n.value):Promise.resolve(n.value).then(v,l);y((u=u.apply(g,N)).next())});import{r as w,u as $,a as q,ao as z,j as o,M as S,m as h,B,e9 as K,aq as Q}from"./index-CdvKsoWL.js";import{I as V}from"./index-DrjvdpbZ.js";import{R as X}from"./CloseOutlined-CPYp3_jQ.js";import{S as Y}from"./index-uzi_ZK7X.js";import{F as Z}from"./Table-BtK-hly2.js";import{T as A}from"./index-DU8gBZtG.js";import"./Input-BfZIjPcH.js";import"./EyeOutlined-Bmd706kk.js";import"./SearchOutlined-Dw8wsIF4.js";import"./addEventListener-DnQkdEcL.js";import"./index-Bx0DkFRj.js";import"./index-DEhZmtAc.js";import"./move-z9us6IY5.js";import"./useIcons-CUMdrazp.js";import"./index-CuPYC4fN.js";import"./useForm-BKthYrdQ.js";import"./index-DKr0mJdo.js";import"./LeftOutlined-DPamsJIP.js";import"./RightOutlined-CTq7ZbF_.js";import"./collapse-BbEVqHco.js";import"./index-Dy2kfasd.js";import"./gapSize-U1swVQyS.js";import"./useBreakpoint-Bep9zDwe.js";import"./useForceUpdate-C0HbZGSd.js";import"./Pagination-82MNUT87.js";const Se=({closeFnc:g,openSecondStepModal:N,openJobModal:u,visible:f})=>{var H;const[b,v]=w.useState(""),[l,y]=w.useState([]),[n,c]=w.useState(1),[C,k]=w.useState(!1),d=$(),{keywordAnalysis:r,loading:j,selectedKeywords:a}=q(e=>e.analysis);w.useEffect(()=>{l.length===0&&(c(1),d(z()))},[l,d]);const M=()=>{const e=b.trim();if(!e)return;const t=l.map(s=>s.toLowerCase()),p=new Set,i=e.split(",").map(s=>s.trim()).filter(s=>s&&!t.includes(s.toLowerCase())&&!p.has(s.toLowerCase())&&p.add(s.toLowerCase()));i.length>0&&(y([...l,...i]),v(""))},D=e=>{var i;const t=l[e],p=l.filter((s,x)=>x!==e);if(y(p),p.length===0&&(d(z()),c(1)),(i=a==null?void 0:a.allKeywords)!=null&&i.includes(t)){const s=a.allKeywords.filter(x=>x!==t);d(K({focusKeywords:s.slice(0,3),keywords:s,allKeywords:s}))}},L=e=>{e.key==="Enter"&&(e.preventDefault(),M())},P=()=>{l.length>0&&(d(Q(l)),c(1))},O=()=>{const e={LOW:[],MEDIUM:[],HIGH:[]};r==null||r.forEach(s=>{e[s.competition]&&e[s.competition].push({keyword:s.keyword,competition_index:s.competition_index})});const t=e.LOW.sort((s,x)=>s.competition_index-x.competition_index).slice(0,2),p=e.MEDIUM.sort((s,x)=>s.competition_index-x.competition_index).slice(0,2),i=e.HIGH.sort((s,x)=>s.competition_index-x.competition_index).slice(0,2);return[...t.map(s=>s.keyword),...p.map(s=>s.keyword),...i.map(s=>s.keyword)]},W=()=>{const e=O();if(!e.length||!(r!=null&&r.length)){S.error({title:"No Auto-Selected Keywords",content:"No keywords available to auto-select. Please analyze keywords first."});return}S.info({icon:null,title:o.jsx("div",{className:"flex justify-between items-center",children:o.jsx("span",{children:"Auto-Selected Keywords"})}),content:o.jsxs("div",{children:[o.jsx("p",{children:"We selected these keywords automatically based on competition index:"}),o.jsx("ul",{className:"list-disc ml-5 mt-2",children:e.map(t=>o.jsx("li",{className:"capitalize text-sm sm:text-base",children:t},t))}),o.jsx("p",{className:"mt-3 text-sm sm:text-base",children:"Do you want to add these too?"})]}),okText:"Accept",cancelText:"Decline",closable:!0,onOk(){const t=[...(a==null?void 0:a.allKeywords)||[],...e.filter(p=>{var i;return!((i=a==null?void 0:a.allKeywords)!=null&&i.includes(p))})].slice(0,6);d(K({focusKeywords:t.slice(0,3),keywords:t,allKeywords:t}))},onCancel(){const t=(a==null?void 0:a.allKeywords)||[];d(K({focusKeywords:t.slice(0,3),keywords:t,allKeywords:t}))},okButtonProps:{className:"bg-blue-600 text-white"}})},_=e=>E(null,null,function*(){const t=(a==null?void 0:a.allKeywords)||[];yield d(K({focusKeywords:t.slice(0,3),keywords:t.slice(3),allKeywords:t})),g(),setTimeout(()=>{e==="blog"?N():u()},100)}),G=()=>{_("blog")},U=()=>{_("job")},F=[{title:"Keyword",dataIndex:"keyword",key:"keyword",sorter:(e,t)=>e.keyword.localeCompare(t.keyword),render:e=>o.jsx("span",{className:"font-medium capitalize text-sm sm:text-base",children:e})},{title:"Monthly Searches",dataIndex:"avgMonthlySearches",key:"avgMonthlySearches",sorter:(e,t)=>e.avgMonthlySearches-t.avgMonthlySearches,render:e=>new Intl.NumberFormat().format(e)},{title:"Competition",dataIndex:"competition",key:"competition",sorter:(e,t)=>e.competition_index-t.competition_index,render:e=>o.jsx(A,{color:e==="LOW"?"green":e==="MEDIUM"?"orange":e==="HIGH"?"red":"gray",className:"text-xs sm:text-sm",children:e})},{title:"Competition Index",dataIndex:"competition_index",key:"competition_index",sorter:(e,t)=>e.competition_index-t.competition_index,render:e=>e||"-"}],T=(r==null?void 0:r.map((e,t)=>({key:t,keyword:e.keyword,avgMonthlySearches:e.avgMonthlySearches,competition:e.competition,competition_index:e.competition_index,avgCpc:e.avgCpc,lowBid:e.lowBid,highBid:e.highBid})))||[],I=C?T.filter(e=>{var t;return(t=a==null?void 0:a.allKeywords)==null?void 0:t.includes(e.keyword)}):T,J=e=>c(e);w.useEffect(()=>()=>{y([]),v(""),c(1),k(!1)},[]),w.useEffect(()=>(f?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[f]);const m=((H=a==null?void 0:a.allKeywords)==null?void 0:H.length)>0;return o.jsx(S,{open:f,onCancel:g,closable:!0,footer:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-2 border-t border-gray-100",children:[o.jsx(h.button,{onClick:W,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 w-full sm:w-auto",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:j||!(r!=null&&r.length),style:{opacity:j||!(r!=null&&r.length)?.5:1,cursor:j||!(r!=null&&r.length)?"not-allowed":"pointer"},children:"Show Auto-Selected Keywords"}),o.jsx(h.button,{onClick:G,className:`px-4 py-2 text-sm font-medium rounded-lg w-full sm:w-auto ${m?"text-gray-700 bg-gray-100 hover:bg-gray-200":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,whileHover:{scale:m?1.03:1},whileTap:{scale:m?.97:1},disabled:!m,children:"Create Blog"}),o.jsx(h.button,{onClick:U,className:`px-4 py-2 text-sm font-medium rounded-lg w-full sm:w-auto ${m?"text-gray-700 bg-gray-100 hover:bg-gray-200":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,whileHover:{scale:m?1.03:1},whileTap:{scale:m?.97:1},disabled:!m,children:"Create New Job"}),o.jsx(h.button,{onClick:g,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 w-full sm:w-auto",whileHover:{scale:1.03},whileTap:{scale:.97},children:"Close"})]},"footer-buttons")],width:"90vw",centered:!0,title:"Keyword Research",styles:{content:{maxWidth:"1000px",margin:"0 auto"},body:{padding:"16px"}},className:"rounded-lg sm:rounded-xl",children:o.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[o.jsx("p",{className:"mb-3 sm:mb-4 text-gray-600 text-sm sm:text-base",children:"Find and analyze keywords for your blog"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4 sm:mb-6",children:[o.jsx(V,{placeholder:"Enter a keyword",value:b,onChange:e=>v(e.target.value),onKeyPress:L,className:"flex-1 text-sm sm:text-base","aria-label":"Enter keyword"}),o.jsx(h.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:o.jsx(B,{type:"primary",onClick:M,className:"w-full sm:w-auto",children:"Add"})})]}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-4 sm:mb-6",children:l.map((e,t)=>o.jsxs(h.div,{initial:{opacity:0,scale:.8},animate:{opacity:1},className:"bg-blue-100 text-blue-800 px-2 sm:px-3 py-1 rounded-full flex items-center text-xs sm:text-sm",children:[o.jsx("span",{className:"lowercase",children:e}),o.jsx(h.div,{whileHover:{scale:1.2},whileTap:{scale:.8},className:"ml-1 sm:ml-2 cursor-pointer",onClick:()=>D(t),children:o.jsx(X,{className:"text-blue-800 text-xs"})})]},t))}),o.jsx(h.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:o.jsx(B,{block:!0,type:"primary",onClick:P,loading:j,disabled:l.length===0,className:"text-sm sm:text-base",children:"Analyze Keywords"})}),!j&&(r==null?void 0:r.length)>0&&o.jsxs("div",{className:"mt-4 sm:mt-6",children:[o.jsxs("div",{className:"flex items-center mb-3 sm:mb-4",children:[o.jsx(Y,{checked:C,onChange:e=>k(e),disabled:!m,size:"small"}),o.jsx("span",{className:"ml-2 text-gray-600 text-sm sm:text-base",children:"Show Selected Keywords Only"})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsx(Z,{columns:F,dataSource:I,pagination:{current:n,pageSize:5,showSizeChanger:!1,onChange:J,total:I.length,responsive:!0},rowSelection:{selectedRowKeys:(a==null?void 0:a.allKeywords)||[],onChange:e=>{d(K({focusKeywords:e.slice(0,3),keywords:e,allKeywords:e}))},getCheckboxProps:e=>({name:e.keyword})},rowKey:e=>e.keyword,scroll:{x:600},className:"min-w-[600px]"})})]})]})})};export{Se as default};
