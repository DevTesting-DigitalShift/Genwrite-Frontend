import{J as Z,u as Q,a as V,a$ as X,y as o,j as e,H as K,m as C,D as k,T as ee,b0 as te,b1 as se}from"./index-BETk9C_M.js";import{b as a}from"./chunk-tiptap-Diw-eXXG.js";import{b as ae}from"./SkeletonLoader-BwJgTaAM.js";import{l as le}from"./lodash-Bq_SkVDy.js";import{h as P}from"./moment-C5S46NFB.js";import{R as re}from"./refresh-ccw-BHj60Jgi.js";import{T as oe,B as ie}from"./index-Y8ngZlgI.js";import{I as ne}from"./index-B-ey4HLH.js";import{S as ce}from"./search-D9LAgYQh.js";import{S as D}from"./index-BJVh2y9F.js";import{D as de}from"./index-BT1QsZhm.js";import{P as me}from"./index-C6DYBGAL.js";import{R as he}from"./QuestionCircleOutlined-BY2knEAl.js";import{P as ge}from"./Pagination-DhMnDdxh.js";import"./createLucideIcon-C5jW9RxN.js";import"./Input-BBXn3cf4.js";import"./useIcons-DggjAwr7.js";import"./Overflow-Clx5udWb.js";import"./dayjs.min-BeGhjYCo.js";import"./index-aD7D6SHQ.js";import"./LeftOutlined-BVhGyULB.js";const{Search:xe}=ne,{Option:p}=D,{RangePicker:pe}=de,Ge=()=>{const[u,j]=a.useState([]),[c,i]=a.useState(1),[d,A]=a.useState(15),[y,w]=a.useState(0),[v,B]=a.useState(""),[m,R]=a.useState("all"),[n,F]=a.useState([null,null]),[l,N]=a.useState(!1),{handlePopup:E}=Z(),S=Q(),{blogs:ue,loading:fe}=V(t=>t.blog),I=85,O=[10,15,20,50],L=a.useCallback(le.debounce(t=>{B(t),i(1)},500),[]),h=a.useCallback(async()=>{N(!0);try{const t={isArchived:!0,status:m!=="all"?m:void 0,q:v||void 0,start:n[0]?P(n[0]).toISOString():void 0,end:n[1]?P(n[1]).toISOString():void 0,page:c,pageSize:d},s=await X(t);j(s.data||[]),w(s.total||0)}catch(t){console.error("Failed to fetch trashed blogs:",t),o.error("Failed to load trashed blogs. Please try again.")}finally{N(!1)}},[m,v,n,c,d]);a.useEffect(()=>{h()},[h]),a.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[c]);const z=(t,s=I)=>t?t.length>s?t.substring(0,s)+"...":t:"",G=t=>t.replace(/[#=~`*_\-]+/g,"").trim(),_=async t=>{try{await S(se(t)).unwrap(),o.success("Blog restored successfully"),h()}catch(s){console.error("Failed to restore blog:",s),o.error("Failed to restore blog. Please try again.")}},$=async()=>{try{await S(te()).unwrap(),o.success("All trashed blogs deleted successfully"),j([]),i(1),w(0)}catch(t){console.error("Failed to delete all blogs:",t),o.error("Failed to delete all blogs. Please try again.")}},H=async()=>{i(1),await h(),o.info("Blog list refreshed")},U=t=>{o.info(`Clicked on blog: ${t.title}`)};return e.jsxs("div",{className:"p-5",children:[e.jsx(K,{children:e.jsx("title",{children:"Trashcan | GenWrite"})}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-4 mb-6",children:[e.jsx(C.h1,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-3xl md:text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Trashcan"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{type:"default",icon:e.jsx(re,{className:"w-4 h-4"}),onClick:H,className:"hover:!border-yellow-500 hover:text-yellow-500",disabled:l,children:"Refresh"}),u.length>0&&e.jsx(k,{type:"default",icon:e.jsx(oe,{className:"w-4 h-4"}),onClick:()=>E({title:"Delete All Trashed Blogs",description:e.jsxs("span",{className:"my-2",children:["All trashed blogs will be ",e.jsx("b",{children:"permanently deleted"}),". This action cannot be undone."]}),confirmText:"Delete All",onConfirm:$,confirmProps:{className:"border-red-500 hover:bg-red-500 hover:text-white"},cancelProps:{danger:!1}}),className:"hover:!border-red-500 hover:text-red-500",disabled:l,children:"Delete All"})]})]}),e.jsx(C.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-gray-600 max-w-xl mb-4",children:"Restore valuable work or permanently delete clutter. Trashed items are deleted after 7 days."}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx(xe,{placeholder:"Search by title or keywords...",onChange:t=>L(t.target.value),prefix:e.jsx(ce,{className:"w-5 h-5 text-gray-400 mr-2"}),allowClear:!0,className:"w-full lg:w-1/3",disabled:l}),e.jsxs(D,{value:m,onChange:t=>{R(t),i(1)},className:"w-full lg:w-1/4",placeholder:"Filter by status",disabled:l,children:[e.jsx(p,{value:"all",children:"All "}),e.jsx(p,{value:"complete",children:"Complete"}),e.jsx(p,{value:"failed",children:"Failed"}),e.jsx(p,{value:"pending",children:"Pending"})]}),e.jsx(pe,{value:n,onChange:t=>{F(t),i(1)},className:"w-full lg:w-1/3",disabled:l,format:"YYYY-MM-DD"})]})}),l?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:[...Array(d)].map((t,s)=>e.jsx("div",{className:"bg-white shadow-md rounded-xl p-4",children:e.jsx(ae,{})},s))}):u.length===0?e.jsxs("div",{className:"flex flex-col justify-center items-center",style:{minHeight:"calc(100vh - 250px)"},children:[e.jsx("img",{src:"Images/trash-can.png",alt:"Trash",style:{width:"8rem"}}),e.jsx("p",{className:"text-xl mt-5",children:"No trashed blogs available."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 p-2",children:u.map(t=>{const{_id:s,title:T,status:r,createdAt:Y,content:M,aiModel:g,focusKeywords:f,wordpress:x,archiveDate:q}=t,b=/gemini/gi.test(g);return e.jsx(ie.Ribbon,{text:e.jsxs("span",{className:"flex items-center justify-center gap-1 py-1 font-medium tracking-wide",children:[e.jsx("img",{src:`./Images/${b?"gemini":g==="claude"?"claude":"chatgpt"}.png`,alt:"",width:20,height:20,loading:"lazy",className:"bg-white"}),b?"Gemini-1.5-flash":g==="claude"?"Claude-3-Haiku":"ChatGPT-4o-mini"]}),className:"absolute top-0",color:b?"#4796E3":g==="claude"?"#9368F8":"#74AA9C",children:e.jsxs("div",{className:`bg-white shadow-md hover:shadow-xl transition-all duration-300 rounded-xl p-4 min-h-[180px] min-w-[390px] relative
                      ${(r==="failed"?"border-red-500":r==="complete"?"border-green-500":"border-yellow-500")+" border-2"}
                    `,title:T,children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 -mt-2",children:new Date(Y).toLocaleDateString("en-US",{dateStyle:"medium"})}),e.jsx(ee,{color:r==="complete"?"black":r==="failed"?"red":"orange",title:r==="complete"?"Click to view blog":"Cannot view incomplete blog",children:e.jsx("div",{className:`cursor-${r==="complete"?"pointer":"default"}`,onClick:()=>{r==="complete"&&U(t)},children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg capitalize font-semibold text-gray-900 !text-left max-w-76",children:T}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:z(G(M))})]})})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:f==null?void 0:f.map((J,W)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:J},W))}),e.jsx(me,{title:"Restore Blog",description:"Are you sure to restore this blog?",icon:e.jsx(he,{style:{color:"red"}}),okText:"Yes",cancelText:"No",onConfirm:()=>_(s),children:e.jsx("img",{src:"Images/restore.svg",alt:"Restore",width:"20",height:"20",className:"cursor-pointer restore-icon"})})]}),e.jsxs("div",{className:"mt-3 mb-2 flex justify-end text-xs text-right text-gray-500 font-medium",children:[(x==null?void 0:x.postedOn)&&e.jsxs("span",{children:["Posted on:",new Date(x.postedOn).toLocaleDateString("en-US",{dateStyle:"medium"})]}),e.jsxs("span",{className:"block -mb-2 text-sm text-right",children:["Archive Date:"," ",new Date(q).toLocaleDateString("en-US",{dateStyle:"medium"})]})]})]})},s)})}),y>0&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(ge,{current:c,pageSize:d,total:y,pageSizeOptions:O,onChange:(t,s)=>{i(t),A(s)},showSizeChanger:!0,showTotal:t=>`Total ${t} blogs`,responsive:!0,disabled:l})})]}),e.jsx("style",{children:`
          .restore-icon {
            transition: filter 0.2s;
          }
          .restore-icon:hover {
            filter: invert(18%) sepia(99%) saturate(7482%) hue-rotate(357deg) brightness(97%) contrast(119%);
          }
          .ant-select-disabled .ant-select-selector,
          .ant-input-disabled,
          .ant-picker-disabled {
            background-color: #f5f5f5 !important;
            cursor: not-allowed !important;
          }
        `})]})};export{Ge as default};
