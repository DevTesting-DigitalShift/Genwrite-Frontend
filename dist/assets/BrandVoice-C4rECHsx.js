var le=Object.defineProperty,ne=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var Y=(i,t,l)=>t in i?le(i,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[t]=l,x=(i,t)=>{for(var l in t||(t={}))ce.call(t,l)&&Y(i,l,t[l]);if(W)for(var l of W(t))me.call(t,l)&&Y(i,l,t[l]);return i},h=(i,t)=>ne(i,de(t));var _=(i,t,l)=>new Promise((f,b)=>{var N=a=>{try{g(l.next(a))}catch(u){b(u)}},L=a=>{try{g(l.throw(a))}catch(u){b(u)}},g=a=>a.done?f(a.value):Promise.resolve(a.value).then(N,L);g((l=l.apply(i,t)).next())});import{j as e,m,a as X,u as pe,a0 as xe,r as d,$ as he,aX as R,X as C,aY as ue,aZ as fe,a_ as be,a$ as ge,H as we,T as D,B as ye,Y as ke}from"./index-5bYReZwQ.js";import{b as ve,c as je}from"./index-C6uRu-xL.js";import{u as Ne}from"./useQuery-D25eEySs.js";import{c as Le}from"./createLucideIcon-QO50GtA0.js";import{U as Ve}from"./UpgradeModal-Bg1EpRhg.js";import{I as P}from"./info-BTmOMIHQ.js";import{L as E}from"./loader-circle-CJTmQQ2J.js";import{U as Ce}from"./upload-x6pJvWfJ.js";import{R as Be}from"./refresh-ccw-BsJ86Gpf.js";import"./iconBase-DGsvr09N.js";import"./lock-Fe6Du3It.js";import"./arrow-left-Bb4XLmMl.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Se=Le("trash",Ue),Fe=({id:i,brandName:t,brandVoice:l,onSelect:f,isSelected:b,onEdit:N,onDelete:L})=>e.jsxs(m.div,{className:`p-4 mt-2 rounded-xl cursor-pointer transition-all ${b?"bg-gradient-to-r from-indigo-100 to-purple-100 border-2 border-indigo-300 shadow-md":"bg-white border border-gray-200 hover:bg-gray-50"}`,onClick:f,whileHover:{y:-2,boxShadow:"0 4px 15px rgba(99, 64, 241, 0.1)"},whileTap:{scale:.98},initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2},role:"button",tabIndex:0,onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&(g.preventDefault(),f())},"aria-label":`Select ${t} brand voice`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:`font-medium text-sm ${b?"text-indigo-700":"text-gray-700"} truncate max-w-[70%]`,children:t}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(m.button,{className:"text-indigo-500 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300 rounded",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:N,"aria-label":`Edit ${t}`,title:"Edit",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsx(m.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:L,"aria-label":`Delete ${t}`,title:"Delete",children:e.jsx(Se,{className:"w-4 h-4 text-red-400"})})]})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-3",children:l})]}),ze=()=>{var M,A,Q,z;const i=X(s=>s.auth.user),t=pe(),l=xe(),[f,b]=d.useState(""),[N,L]=d.useState(!1),{handlePopup:g}=he(),[a,u]=d.useState({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",sitemapUrl:"",selectedVoice:null,_id:void 0}),[n,w]=d.useState({}),{siteInfo:y}=X(s=>s.brand),[B,U]=d.useState(""),[K,k]=d.useState(!1),[S,T]=d.useState(!1),I=((M=i==null?void 0:i.credits)==null?void 0:M.base)+((A=i==null?void 0:i.credits)==null?void 0:A.extra)===0&&((Q=i==null?void 0:i.subscription)==null?void 0:Q.plan)==="free"&&((z=i==null?void 0:i.subscription)==null?void 0:z.status)==="unpaid";if(I)return e.jsx(Ve,{featureName:"Brand Voice"});const{data:v=[],isLoading:$,error:_e}=Ne({queryKey:["brands"],queryFn:()=>_(null,null,function*(){return yield t(ke()).unwrap()}),staleTime:1/0,gcTime:1/0,refetchOnMount:!1,refetchOnWindowFocus:!1});d.useEffect(()=>(a._id||V(),()=>{V(),t(R())}),[t]),d.useEffect(()=>{y.data&&!K&&(u(s=>h(x({},s),{nameOfVoice:y.data.nameOfVoice||s.nameOfVoice,describeBrand:y.data.describeBrand||s.describeBrand,keywords:y.data.keywords||s.keywords,postLink:y.data.postLink||s.postLink,sitemapUrl:y.data.sitemap||s.sitemapUrl})),w(s=>h(x({},s),{nameOfVoice:void 0,describeBrand:void 0,keywords:void 0,postLink:void 0,sitemapUrl:void 0})),U(a.postLink))},[y,a.postLink,K]);const V=d.useCallback(()=>{u({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",sitemapUrl:"",selectedVoice:v&&v.length>0?v[0]:null,_id:void 0}),b(""),w({}),U(""),k(!0),T(!1)},[v]),H=d.useCallback(()=>{const s={};if(a.nameOfVoice.trim()||(s.nameOfVoice="Name of Voice is required."),!a.postLink.trim())s.postLink="Post link is required.";else try{new URL(a.postLink)}catch(r){s.postLink="Please enter a valid URL (e.g., https://example.com)."}if(a.keywords.length===0&&(s.keywords="At least one keyword is required."),a.describeBrand.trim()||(s.describeBrand="Brand description is required."),!a.sitemapUrl.trim())s.sitemapUrl="Sitemap URL is required.";else try{new URL(a.sitemapUrl)}catch(r){s.sitemapUrl="Please enter a valid URL (e.g., https://example.com/sitemap.xml)."}return w(s),Object.keys(s).length===0},[a]),F=d.useCallback(s=>{const{name:r,value:o}=s.target;u(c=>h(x({},c),{[r]:o})),w(c=>h(x({},c),{[r]:void 0})),r==="postLink"&&o!==B&&U(""),k(!1)},[B]),G=d.useCallback(s=>{if(s.key==="Enter"&&f.trim()){s.preventDefault();const r=a.keywords.map(p=>p.toLowerCase()),o=new Set,c=f.split(",").map(p=>p.trim()).filter(p=>{const O=p.toLowerCase();return!p||r.includes(O)||o.has(O)?!1:(o.add(O),!0)});if(c.length===0)return;u(p=>h(x({},p),{keywords:[...p.keywords,...c]})),b(""),w(p=>h(x({},p),{keywords:void 0})),k(!1)}},[f,a.keywords]),q=d.useCallback(s=>{u(r=>h(x({},r),{keywords:r.keywords.filter(o=>o!==s)})),k(!1)},[]),Z=d.useCallback(s=>{const r=s.target.files[0];if(!r)return;if(!r.name.toLowerCase().endsWith(".csv")){C.error("Invalid file type. Please upload a .csv file."),s.target.value=null;return}const o=20*1024;if(r.size>o){C.error("File size exceeds 20KB limit. Please upload a smaller file."),s.target.value=null;return}if(r.type!=="text/csv"){C.error("Please upload a valid CSV file."),s.target.value=null;return}const c=new FileReader;c.onload=p=>{const oe=p.target.result.split(/,|\n|;/).map(j=>j.trim()).filter(j=>j.length>0);u(j=>h(x({},j),{keywords:[...new Set([...j.keywords,...oe])]})),w(j=>h(x({},j),{keywords:void 0})),k(!1)},c.onerror=()=>C.error("Error reading CSV file."),c.readAsText(r),s.target.value=null},[]),J=d.useCallback(()=>_(null,null,function*(){if(!H())return;L(!0);const s={nameOfVoice:a.nameOfVoice.trim(),postLink:a.postLink.trim(),keywords:a.keywords.map(o=>o.trim()).filter(Boolean),describeBrand:a.describeBrand.trim(),sitemap:a.sitemapUrl.trim(),userId:i==null?void 0:i._id};if(v.some(o=>o.postLink===s.postLink&&(a._id?o._id!==a._id:!0))){C.error("A brand voice already exists with that name and link."),L(!1);return}try{a._id?yield t(ue({id:a._id,payload:s})).unwrap():yield t(fe({payload:s})).unwrap(),V(),l.invalidateQueries(["brands"]),t(R())}catch(o){console.error("Error saving brand voice:",o)}finally{L(!1)}}),[a,i,t,H,V,v,l]),ee=d.useCallback(s=>{u({nameOfVoice:s.nameOfVoice||"",postLink:s.postLink||"",keywords:Array.isArray(s.keywords)?s.keywords:[],describeBrand:s.describeBrand||"",sitemapUrl:s.sitemap||"",selectedVoice:s,_id:s._id}),w({}),U(s.postLink||""),k(!1),T(!1)},[]),se=d.useCallback(s=>{g({title:"Delete Brand Voice?",description:e.jsxs("span",{className:"my-2",children:["Are you sure you want to delete ",e.jsx("b",{children:s.name}),"? This action cannot be undone."]}),confirmText:"Delete",onConfirm:()=>_(null,null,function*(){var r;try{l.setQueryData(["brands"],(o=[])=>o.filter(c=>c._id!==s._id)),yield t(be({id:s._id})).unwrap(),l.invalidateQueries(["brands"]),((r=a.selectedVoice)==null?void 0:r._id)===s._id&&(V(),t(R()))}catch(o){console.error("Failed to delete brand voice:",o),l.invalidateQueries(["brands"])}}),confirmProps:{type:"text",className:"border-red-500 hover:bg-red-500 bg-red-100 text-red-600"},cancelProps:{danger:!1}})},[t,a.selectedVoice,V,l]),ae=d.useCallback(s=>{u(r=>h(x({},r),{selectedVoice:s})),k(!1)},[]),te=d.useCallback(()=>{const s=a.postLink.trim();if(!s){w(r=>h(x({},r),{postLink:"Post link is required to fetch site info."}));return}if(s===B){C.info("This URL has already been fetched.");return}try{new URL(s),t(ge(s)).unwrap().then(()=>{k(!1)}).catch(()=>C.error("Failed to fetch site info. Please try a different URL."))}catch(r){w(o=>h(x({},o),{postLink:"Please enter a valid URL (e.g., https://example.com)."}))}},[a.postLink,B,t]),re=()=>{l.invalidateQueries(["brands"])},ie=d.useMemo(()=>{const r=S?a.keywords:a.keywords.slice(0,12),o=a.keywords.length-12;return e.jsxs("div",{className:`flex flex-wrap gap-2 ${a.keywords.length>0?"mb-1":"hidden"}`,children:[r.map(c=>e.jsxs(m.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 sm:px-3 py-1",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},whileHover:{scale:1.05},children:[e.jsx("span",{className:"text-xs sm:text-sm truncate max-w-[100px] sm:max-w-[120px]",children:c}),e.jsx(je,{className:"ml-1 cursor-pointer text-indigo-500 hover:text-indigo-700 transition-colors w-3 sm:w-4 h-3 sm:h-4",onClick:p=>{p.stopPropagation(),q(c)},"aria-label":`Remove ${c}`})]},c)),o>0&&e.jsx("button",{type:"button",className:"text-xs sm:text-sm text-indigo-600 hover:text-indigo-800 font-medium",onClick:()=>T(!S),children:S?"Show Less":`Show More (+${o})`})]})},[a.keywords,q,S]);return e.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col lg:flex-row gap-4 sm:gap-6 p-4 sm:p-6 md:p-8 max-w-7xl mx-auto",children:[e.jsx(we,{children:e.jsx("title",{children:"Brand Voice | GenWrite"})}),e.jsxs(m.div,{className:"w-full lg:w-[60%] bg-white rounded-xl p-4 sm:p-6 shadow-lg border border-gray-100",initial:{x:-20},animate:{x:0},children:[e.jsx("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Create Your Brand Voice"})}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 sm:mb-6",children:"Define your brand's unique tone and style to ensure consistent content creation."}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"postLink",className:"text-sm font-medium text-gray-700 flex gap-2 mb-1",children:["Post or Blog Link ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx(D,{title:"Add a link of your home page to fetch site info",styles:{backgroundColor:"#4169e1",color:"#fff",borderRadius:"8px",padding:"8px 12px",fontSize:"13px",maxWidth:"220px"},children:e.jsx("span",{className:"cursor-pointer",children:e.jsx(P,{className:"w-4 sm:w-5 h-4 sm:h-5 text-blue-500"})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(m.input,{id:"postLink",type:"url",name:"postLink",value:a.postLink,onChange:F,placeholder:"e.g., https://example.com/blog",className:`flex-grow p-2 sm:p-3 border rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base ${n.postLink?"border-red-500":"border-gray-300"}`,whileFocus:{scale:1.01},"aria-invalid":!!n.postLink,"aria-describedby":n.postLink?"postLink-error":void 0}),e.jsx(m.button,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-3 sm:px-4 py-2 rounded-lg font-medium shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",onClick:te,whileHover:{scale:1.03},whileTap:{scale:.98},disabled:y.loading||a.postLink&&a.postLink===B||I,"aria-label":"Fetch Site Info",children:y.loading?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"animate-spin w-4 sm:w-5 h-4 sm:h-5"}),"Fetching..."]}):"Fetch Site Info"})]}),n.postLink&&e.jsx("p",{id:"postLink-error",className:"text-red-500 text-xs sm:text-sm mt-1",children:n.postLink})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"nameOfVoice",className:"text-sm font-medium text-gray-700 flex gap-2 mb-1",children:["Name of Voice ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m.input,{id:"nameOfVoice",type:"text",name:"nameOfVoice",value:a.nameOfVoice,onChange:F,placeholder:"e.g., Friendly Tech",className:`w-full p-2 sm:p-3 border rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base ${n.nameOfVoice?"border-red-500":"border-gray-300"}`,whileFocus:{scale:1.01},"aria-invalid":!!n.nameOfVoice,"aria-describedby":n.nameOfVoice?"nameOfVoice-error":void 0}),n.nameOfVoice&&e.jsx("p",{id:"nameOfVoice-error",className:"text-red-500 text-xs sm:text-sm mt-1",children:n.nameOfVoice})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"keywords",className:"text-sm font-medium text-gray-700 flex gap-2 mb-1",children:["Keywords ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx(D,{title:"Upload a .csv file in the format: `Keyword` as header",styles:{backgroundColor:"#4169e1",color:"#fff",borderRadius:"8px",padding:"8px 12px",fontSize:"13px",maxWidth:"220px"},children:e.jsx("span",{className:"cursor-pointer",children:e.jsx(P,{className:"w-4 sm:w-5 h-4 sm:h-5 text-blue-500"})})})]}),e.jsxs(m.div,{className:`flex bg-white border rounded-lg p-2 sm:p-3 flex-col gap-2 ${n.keywords?"border-red-500":"border-gray-300"}`,whileHover:{boxShadow:"0 0 0 3px rgba(99, 102, 241, 0.2)"},children:[ie,e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2",children:[e.jsx("input",{id:"keywords",type:"text",value:f,onChange:s=>b(s.target.value),onKeyDown:G,className:"flex-grow bg-transparent border-none outline-none text-sm sm:text-base",placeholder:"Type a keyword and press Enter","aria-describedby":n.keywords?"keywords-error":void 0}),e.jsx("label",{htmlFor:"file-upload",className:"flex items-center cursor-pointer",children:e.jsx(m.div,{className:"bg-indigo-100 p-2 rounded-lg",whileHover:{scale:1.1},whileTap:{scale:.95},"aria-label":"Upload CSV file",children:e.jsx(Ce,{className:"w-4 sm:w-5 h-4 sm:h-5 text-indigo-600"})})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:Z,accept:".csv"})]})]}),n.keywords&&e.jsx("p",{id:"keywords-error",className:"text-red-500 text-xs sm:text-sm mt-1",children:n.keywords})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"sitemapUrl",className:"text-sm font-medium text-gray-700 flex gap-2 mb-1",children:["Sitemap URL ",e.jsx("span",{className:"text-red-500",children:"*"}),e.jsx(D,{title:"Paste the URL of your XML sitemap (e.g., https://example.com/sitemap.xml)",styles:{backgroundColor:"#4169e1",color:"#fff",borderRadius:"8px",padding:"8px 12px",fontSize:"13px",maxWidth:"320px"},children:e.jsx("span",{className:"cursor-pointer",children:e.jsx(P,{className:"w-4 sm:w-5 h-4 sm:h-5 text-blue-500"})})})]}),e.jsx(m.input,{id:"sitemapUrl",type:"url",name:"sitemapUrl",value:a.sitemapUrl,onChange:F,placeholder:"e.g., https://example.com/sitemap.xml",className:`w-full p-2 sm:p-3 border rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base ${n.sitemapUrl?"border-red-500":"border-gray-300"}`,whileFocus:{scale:1.01},"aria-invalid":!!n.sitemapUrl,"aria-describedby":n.sitemapUrl?"sitemapUrl-error":void 0}),n.sitemapUrl&&e.jsx("p",{id:"sitemapUrl-error",className:"text-red-500 text-xs sm:text-sm mt-1",children:n.sitemapUrl})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"describeBrand",className:"text-sm font-medium text-gray-700 flex gap-2 mb-1",children:["Describe Your Brand ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m.textarea,{id:"describeBrand",name:"describeBrand",value:a.describeBrand,onChange:F,placeholder:"Describe your brand's tone and personality",className:`w-full p-2 sm:p-3 border rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm sm:text-base ${n.describeBrand?"border-red-500":"border-gray-300"}`,rows:4,whileFocus:{scale:1.01},"aria-invalid":!!n.describeBrand,"aria-describedby":n.describeBrand?"describeBrand-error":void 0}),n.describeBrand&&e.jsx("p",{id:"describeBrand-error",className:"text-red-500 text-xs sm:text-sm mt-1",children:n.describeBrand})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 justify-end",children:[e.jsx(m.button,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-3 sm:px-4 py-2 rounded-lg font-medium shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",onClick:J,whileHover:{scale:1.03,y:-2},whileTap:{scale:.98},disabled:N||I,"aria-label":a._id?"Update Brand Voice":"Save Brand Voice",children:N?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"animate-spin w-4 sm:w-5 h-4 sm:h-5"}),"Saving..."]}):a._id?"Update Brand Voice":"Save Brand Voice"}),e.jsx(m.button,{className:"bg-gradient-to-tr from-red-700 from-10% via-red-500 via-80% to-red-700 to-100% text-white px-3 sm:px-4 py-2 rounded-lg font-medium shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",onClick:V,whileHover:{scale:1.03,y:-2},whileTap:{scale:.98},disabled:N,"aria-label":"Clear Form",children:"Clear"})]})]})]}),e.jsxs(m.div,{className:"w-full lg:w-[40%] bg-white rounded-xl p-4 sm:p-6 shadow-lg border border-gray-100",initial:{x:20},animate:{x:0},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-800",children:"Your Brand Voices"}),e.jsx(m.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(ye,{type:"default",icon:e.jsx(Be,{className:"w-4 h-4"}),onClick:re,disabled:$,className:"text-xs sm:text-sm px-4 py-2"})})]}),e.jsx("div",{className:"space-y-3 overflow-y-auto max-h-[calc(100vh-300px)] sm:max-h-[calc(100vh-250px)]",children:$?e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx(E,{className:"animate-spin w-8 h-8 text-indigo-600"})}):v.length>0?v.map(s=>{var r;return e.jsx(Fe,{id:s._id,brandName:s.nameOfVoice,brandVoice:s.describeBrand,onSelect:()=>ae(s),isSelected:((r=a.selectedVoice)==null?void 0:r._id)===s._id,onEdit:o=>{o.stopPropagation(),ee(s)},onDelete:o=>{o.stopPropagation(),se(s)}},s._id)}):e.jsx("div",{className:"p-4 sm:p-6 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center text-gray-500 text-xs sm:text-sm",children:"No brand voices created yet. Start by adding one on the left."})})]})]})};export{ze as default};
