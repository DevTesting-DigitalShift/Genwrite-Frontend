import{a as E,u as T,N as K,j as e,m as r,H as I,b as u}from"./index-CniRpELv.js";import{b as p}from"./chunk-tiptap-DryasWDK.js";import{F as R,a as U}from"./index-C46stefG.js";import{U as S}from"./upload-uVJfWjoY.js";import"./iconBase-D2YiqqgH.js";const G=()=>{E(),T();const h=K(a=>a.auth.user),[t,l]=p.useState({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null}),[c,m]=p.useState(""),[w,d]=p.useState(!1),[j,v]=p.useState([]),b=async()=>{try{const a=await u.get("/brand");let s=Array.isArray(a.data)?a.data:a.data?[a.data]:[];v(s),s.length>0&&!t.selectedVoice&&l(o=>({...o,selectedVoice:s[0]}))}catch{v([])}};p.useEffect(()=>{b()},[]);const L=a=>{l({nameOfVoice:a.nameOfVoice,postLink:a.postLink,keywords:Array.isArray(a.keywords)?a.keywords:[],describeBrand:a.describeBrand,selectedVoice:a,uploadedFile:null,_id:a._id})},H=async()=>{var a,s,o,x,f,g,n,B,F;try{d(!0);const i={nameOfVoice:(a=t.nameOfVoice)==null?void 0:a.trim(),postLink:(s=t.postLink)==null?void 0:s.trim(),keywords:Array.isArray(t.keywords)?t.keywords.map(D=>String(D).trim()).filter(Boolean):[],describeBrand:(o=t.describeBrand)==null?void 0:o.trim(),userId:h==null?void 0:h._id};if(!i.nameOfVoice||!i.postLink||!i.describeBrand||i.keywords.length===0){d(!1),alert("All fields are required and at least one keyword must be provided.");return}try{new URL(i.postLink)}catch{d(!1),alert("Please enter a valid URL for the post link.");return}let C;t._id?C=await u.put(`/brand/${t._id}`,i):C=await u.post("/brand/addBrand",i),d(!1),b(),l({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null,_id:void 0})}catch(i){d(!1),alert(((f=(x=i==null?void 0:i.response)==null?void 0:x.data)==null?void 0:f.message)||((F=(B=(n=(g=i==null?void 0:i.response)==null?void 0:g.data)==null?void 0:n.errors)==null?void 0:B[0])==null?void 0:F.msg)||"Failed to save brand voice. Please check your input.")}},_=async a=>{try{await u.delete(`/brand/${a._id}`),b(),t.selectedVoice&&t.selectedVoice._id===a._id&&l(s=>({...s,selectedVoice:null}))}catch{alert("Failed to delete brand voice.")}},y=a=>{const{name:s,value:o}=a.target;l({...t,[s]:o})},O=a=>{l(s=>({...s,selectedVoice:a}))},N=a=>{const s=a.target.files[0];if(s&&s.type==="text/csv"){const o=new FileReader;o.onload=x=>{let g=x.target.result.split(/,|\n|;/).map(n=>n.trim()).filter(n=>n.length>0);l(n=>({...n,uploadedFile:s.name,keywords:Array.from(new Set([...n.keywords,...g]))}))},o.readAsText(s)}},k=a=>{a.key==="Enter"&&c.trim()&&(l({...t,keywords:[...t.keywords,c.trim()]}),m(""))},A=a=>{l({...t,keywords:t.keywords.filter(s=>s!==a)})},V=()=>{const a=t.keywords.slice(-3),s=t.keywords.length-a.length;return e.jsxs(e.Fragment,{children:[s>0&&e.jsx(r.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{scale:.8},animate:{scale:1},children:e.jsx("span",{className:"text-sm",children:`+${s}`})}),a.map((o,x)=>e.jsxs(r.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},whileHover:{scale:1.05},children:[e.jsx("span",{className:"text-sm",children:o}),e.jsx(R,{className:"ml-1 cursor-pointer text-indigo-500 hover:text-indigo-700 transition-colors",onClick:()=>A(o)})]},x))]})};return e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-8 justify-around p-6",children:[e.jsx(I,{children:e.jsx("title",{children:"Brand Voice | GenWrite"})}),e.jsxs(r.div,{className:"w-[60%] bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:-20},animate:{x:0},children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Letâ€™s create your Brand Voice"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Prototype group pixel duplicate ellipse hand draft style rotate. Layout follower scale comment flows draft select."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Name of Voice"}),e.jsx(r.input,{type:"text",name:"nameOfVoice",value:t.nameOfVoice,onChange:y,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:["Paste link of your post or blog ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(r.input,{type:"text",name:"postLink",value:t.postLink,onChange:y,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{className:"text-center my-4 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-4 text-gray-500",children:"OR"})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:["Keywords ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(r.div,{className:"flex items-center bg-white border border-gray-300 rounded-lg p-2 flex-wrap gap-2",whileHover:{boxShadow:"0 0 0 3px rgba(99, 102, 241, 0.2)"},children:[V(),e.jsx("input",{type:"text",value:c,onChange:a=>m(a.target.value),onKeyDown:k,className:"flex-grow p-2 bg-white border-none outline-none rounded-l-md",placeholder:"e.g., Fun"}),e.jsx("label",{htmlFor:"file-upload",className:"flex items-center cursor-pointer",children:e.jsx(r.div,{className:"bg-indigo-100 p-2 rounded-lg",whileHover:{scale:1.1},whileTap:{scale:.95},children:e.jsx(S,{size:20})})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:N,accept:".csv"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:["Site Map ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(r.div,{className:"flex items-center bg-white border border-gray-300 rounded-lg p-2 flex-wrap gap-2",whileHover:{boxShadow:"0 0 0 3px rgba(99, 102, 241, 0.2)"},children:[V(),e.jsx("input",{type:"text",value:c,onChange:a=>m(a.target.value),onKeyDown:k,className:"flex-grow p-2 bg-white border-none outline-none rounded-l-md",placeholder:"e.g., Fun"}),e.jsx("label",{htmlFor:"file-upload",className:"flex items-center cursor-pointer",children:e.jsx(r.div,{className:"bg-indigo-100 p-2 rounded-lg",whileHover:{scale:1.1},whileTap:{scale:.95},children:e.jsx(S,{size:20})})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:N,accept:".csv"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Describe your Brand"}),e.jsx(r.textarea,{name:"describeBrand",value:t.describeBrand,onChange:y,placeholder:"Write a blog on how to cook pasta",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:"4",whileFocus:{scale:1.01}})]}),e.jsx("div",{className:"text-right",children:e.jsx(r.button,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-3 rounded-lg font-medium shadow-md hover:shadow-lg transition-all",onClick:H,whileHover:{scale:1.03,y:-2},whileTap:{scale:.98},children:"Save Brand Voice"})})]})]}),e.jsx("div",{className:"h-auto w-px bg-gray-200 mx-2"}),e.jsxs(r.div,{className:"flex-1 bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:20},animate:{x:0},children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-4",children:"Your Brand Voices"}),e.jsx("div",{className:"mb-8 space-y-4 overflow-y-auto p-2",children:j.length>0?j.map(a=>{var s;return e.jsx($,{id:a._id,brandName:a.nameOfVoice,brandVoice:a.describeBrand,onSelect:()=>O(a),isSelected:((s=t.selectedVoice)==null?void 0:s._id)===a._id,onEdit:()=>L(a),onDelete:()=>_(a)},a._id)}):e.jsx("div",{className:"p-6 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center text-gray-500",children:"No brand voices created yet."})})]})]})},$=({id:h,brandName:t,brandVoice:l,onSelect:c,isSelected:m,onEdit:w,onDelete:d})=>e.jsxs(r.div,{className:`p-4 rounded-xl cursor-pointer transition-all ${m?"bg-gradient-to-r from-indigo-100 to-purple-100 border-2 border-indigo-300 shadow-md":"bg-white border border-gray-200 hover:border-indigo-300"}`,onClick:c,whileHover:{y:-3,boxShadow:"0 4px 12px rgba(99, 102, 241, 0.1)"},whileTap:{scale:.98},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:`font-medium ${m?"text-indigo-700":"text-gray-700"}`,children:t}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r.button,{className:"text-indigo-500 hover:text-indigo-700",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:w,children:e.jsx(U,{})}),e.jsx(r.button,{className:"text-gray-500 hover:text-red-500",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:d,children:e.jsx("img",{src:"/Images/trash.png",alt:"Delete",className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:l.length>100?`${l.substring(0,100)}...`:l})]});export{G as default};
