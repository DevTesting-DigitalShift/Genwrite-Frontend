import{o as T,w as I,v as $,j as e,s as r,q as y}from"./index-OSlQBlIK.js";import{b as p}from"./chunk-tiptap-JX9QK0Ia.js";import{b as C,c as E}from"./index-BpznHgXJ.js";import"./iconBase-XDJ6T7v5.js";const Y=()=>{T(),I();const g=$(s=>s.auth.user),[t,l]=p.useState({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null}),[x,h]=p.useState(""),[j,c]=p.useState(!1),[m,v]=p.useState([]),b=async()=>{try{const s=await y.get("/brand");let a=Array.isArray(s.data)?s.data:s.data?[s.data]:[];console.log("Fetched brands:",a),v(a),a.length>0&&!t.selectedVoice&&l(i=>({...i,selectedVoice:a[0]}))}catch{v([])}};p.useEffect(()=>{b()},[]);const N=s=>{l({nameOfVoice:s.nameOfVoice,postLink:s.postLink,keywords:Array.isArray(s.keywords)?s.keywords:[],describeBrand:s.describeBrand,selectedVoice:s,uploadedFile:null,_id:s._id})},L=async()=>{var s,a,i,n,w,u,d,B,F;try{c(!0);const o={nameOfVoice:(s=t.nameOfVoice)==null?void 0:s.trim(),postLink:(a=t.postLink)==null?void 0:a.trim(),keywords:Array.isArray(t.keywords)?t.keywords.map(D=>String(D).trim()).filter(Boolean):[],describeBrand:(i=t.describeBrand)==null?void 0:i.trim(),userId:g==null?void 0:g._id};if(!o.nameOfVoice||!o.postLink||!o.describeBrand||o.keywords.length===0){c(!1),alert("All fields are required and at least one keyword must be provided.");return}try{new URL(o.postLink)}catch{c(!1),alert("Please enter a valid URL for the post link.");return}let _;t._id?_=await y.put(`/brand/${t._id}`,o):_=await y.post("/brand/addBrand",o),c(!1),b(),l({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null,_id:void 0})}catch(o){c(!1),alert(((w=(n=o==null?void 0:o.response)==null?void 0:n.data)==null?void 0:w.message)||((F=(B=(d=(u=o==null?void 0:o.response)==null?void 0:u.data)==null?void 0:d.errors)==null?void 0:B[0])==null?void 0:F.msg)||"Failed to save brand voice. Please check your input.")}},k=async s=>{try{await y.delete(`/brand/${s._id}`),b(),t.selectedVoice&&t.selectedVoice._id===s._id&&l(a=>({...a,selectedVoice:null}))}catch{alert("Failed to delete brand voice.")}},f=s=>{const{name:a,value:i}=s.target;l({...t,[a]:i})},V=s=>{l(a=>({...a,selectedVoice:s}))},S=s=>{const a=s.target.files[0];if(a&&a.type==="text/csv"){const i=new FileReader;i.onload=n=>{let u=n.target.result.split(/,|\n|;/).map(d=>d.trim()).filter(d=>d.length>0);l(d=>({...d,uploadedFile:a.name,keywords:Array.from(new Set([...d.keywords,...u]))}))},i.readAsText(a)}},H=s=>{s.key==="Enter"&&x.trim()&&(l({...t,keywords:[...t.keywords,x.trim()]}),h(""))},O=s=>{l({...t,keywords:t.keywords.filter(a=>a!==s)})},A=()=>{const s=t.keywords.slice(-3),a=t.keywords.length-s.length;return e.jsxs(e.Fragment,{children:[a>0&&e.jsx(r.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{scale:.8},animate:{scale:1},children:e.jsx("span",{className:"text-sm",children:`+${a}`})}),s.map((i,n)=>e.jsxs(r.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},whileHover:{scale:1.05},children:[e.jsx("span",{className:"text-sm",children:i}),e.jsx(E,{className:"ml-1 cursor-pointer text-indigo-500 hover:text-indigo-700 transition-colors",onClick:()=>O(i)})]},n))]})};return e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-8 justify-around p-6",children:[e.jsxs(r.div,{className:"w-[60%] bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:-20},animate:{x:0},children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Letâ€™s create your Brand Voice"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Prototype group pixel duplicate ellipse hand draft style rotate. Layout follower scale comment flows draft select."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Name of Voice"}),e.jsx(r.input,{type:"text",name:"nameOfVoice",value:t.nameOfVoice,onChange:f,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Paste link of your post or blog *"}),e.jsx(r.input,{type:"text",name:"postLink",value:t.postLink,onChange:f,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{className:"text-center my-4 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-4 text-gray-500",children:"OR"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Keywords*"}),e.jsxs(r.div,{className:"flex items-center bg-white border border-gray-300 rounded-lg p-2 flex-wrap gap-2",whileHover:{boxShadow:"0 0 0 3px rgba(99, 102, 241, 0.2)"},children:[A(),e.jsx("input",{type:"text",value:x,onChange:s=>h(s.target.value),onKeyDown:H,className:"flex-grow p-2 bg-white border-none outline-none rounded-l-md",placeholder:"e.g., Fun"}),e.jsx("label",{htmlFor:"file-upload",className:"flex items-center cursor-pointer",children:e.jsx(r.div,{className:"bg-indigo-100 p-2 rounded-lg",whileHover:{scale:1.1},whileTap:{scale:.95},children:e.jsx("img",{src:"./Images/upload.png",alt:"Upload",className:"w-6 h-6"})})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:S,accept:".csv"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Describe your Brand"}),e.jsx(r.textarea,{name:"describeBrand",value:t.describeBrand,onChange:f,placeholder:"Write a blog on how to cook pasta",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:"4",whileFocus:{scale:1.01}})]}),e.jsx("div",{className:"text-right",children:e.jsx(r.button,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-3 rounded-lg font-medium shadow-md hover:shadow-lg transition-all",onClick:L,whileHover:{scale:1.03,y:-2},whileTap:{scale:.98},children:"Save Brand Voice"})})]})]}),e.jsx("div",{className:"h-auto w-px bg-gray-200 mx-2"}),e.jsxs(r.div,{className:"flex-1 bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:20},animate:{x:0},children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-4",children:"Your Brand Voices"}),e.jsx("div",{className:"mb-8 space-y-4 max-h-[300px] overflow-y-auto pr-2",children:m.length>0?m.map(s=>{var a,i,n;return e.jsxs(r.div,{className:`rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 border-2 border-indigo-200 p-4 shadow-sm flex items-center justify-between ${((a=t.selectedVoice)==null?void 0:a._id)===s._id?"ring-2 ring-indigo-500":""}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-5},children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:((i=t.selectedVoice)==null?void 0:i._id)===s._id,onChange:()=>V(s),className:"accent-indigo-500 w-5 h-5"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-indigo-700 font-medium",children:s.nameOfVoice}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:((n=s.describeBrand)==null?void 0:n.length)>100?`${s.describeBrand.substring(0,100)}...`:s.describeBrand})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r.button,{className:"text-indigo-500 hover:text-indigo-700",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>N(s),children:e.jsx(C,{})}),e.jsx(r.button,{className:"text-gray-500 hover:text-red-500",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>k(s),children:e.jsx("img",{src:"/Images/trash.png",alt:"Delete",className:"w-4 h-4"})})]})]},s._id)}):e.jsx("div",{className:"p-6 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center text-gray-500",children:"No brand voices created yet."})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4 mt-8",children:"Select Brand Voice"}),e.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto pr-2",children:m.map(s=>{var a;return e.jsx(K,{id:s._id,brandName:s.nameOfVoice,brandVoice:s.describeBrand,onSelect:()=>V(s),isSelected:((a=t.selectedVoice)==null?void 0:a._id)===s._id,onEdit:()=>N(s),onDelete:()=>k(s)},s._id)})})]})]})},K=({id:g,brandName:t,brandVoice:l,onSelect:x,isSelected:h,onEdit:j,onDelete:c})=>e.jsxs(r.div,{className:`p-4 rounded-xl cursor-pointer transition-all ${h?"bg-gradient-to-r from-indigo-100 to-purple-100 border-2 border-indigo-300 shadow-md":"bg-white border border-gray-200 hover:border-indigo-300"}`,onClick:x,whileHover:{y:-3,boxShadow:"0 4px 12px rgba(99, 102, 241, 0.1)"},whileTap:{scale:.98},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:`font-medium ${h?"text-indigo-700":"text-gray-700"}`,children:t}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r.button,{className:"text-indigo-500 hover:text-indigo-700",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:m=>{m.stopPropagation(),j()},children:e.jsx(C,{})}),e.jsx(r.button,{className:"text-gray-500 hover:text-red-500",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:m=>{m.stopPropagation(),c()},children:e.jsx("img",{src:"/Images/trash.png",alt:"Delete",className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:l.length>100?`${l.substring(0,100)}...`:l})]});export{Y as default};
