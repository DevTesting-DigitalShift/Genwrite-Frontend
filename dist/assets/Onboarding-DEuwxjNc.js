var K=Object.defineProperty,R=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var I=(i,t,n)=>t in i?K(i,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[t]=n,c=(i,t)=>{for(var n in t||(t={}))E.call(t,n)&&I(i,n,t[n]);if(O)for(var n of O(t))U.call(t,n)&&I(i,n,t[n]);return i},d=(i,t)=>R(i,W(t));var w=(i,t,n)=>new Promise((u,m)=>{var j=o=>{try{f(n.next(o))}catch(p){m(p)}},N=o=>{try{f(n.throw(o))}catch(p){m(p)}},f=o=>o.done?u(o.value):Promise.resolve(o.value).then(j,N);f((n=n.apply(i,t)).next())});import{j as e}from"./tiptap-BabmW22p.js";import{h as F,b as h}from"./vendor-CcjAMWu8.js";import{g as T,c as M}from"./brandApi-CcbYV95l.js";import{u as G}from"./useAuthStore-CU2rUJjR.js";import{B as y,l as b,c as k,s as g}from"./antd-8WQTeuab.js";import{B as Y}from"./building-2-A_Ftw2tm.js";import{T as q}from"./target-cMTYyqUp.js";import{C as H}from"./check-CTiRpsHo.js";import{A as J,m as C}from"./index-CHEUOGl9.js";import"./DataLayer-DALerVhB.js";import"./react-wNxFir7h.js";import"./utils-DIb0lvMo.js";const{TextArea:L}=b,de=()=>{const i=F(),{user:t,loadAuthenticatedUser:n}=G(),[u,m]=h.useState(0),[j,N]=h.useState(!1),[f,o]=h.useState(!1);h.useEffect(()=>{if(!localStorage.getItem("token")){i("/login",{replace:!0});return}n()},[n,i]),h.useEffect(()=>{if(!t||!t._id)return;const s=localStorage.getItem(`hasCompletedOnboarding_${t._id}`)==="true";(t.lastLogin||s)&&(t.emailVerified===!1?i(`/email-verify/${t.email}`,{replace:!0}):i("/dashboard",{replace:!0}))},[t,i]);const[p,A]=h.useState("https://"),[r,x]=h.useState({nameOfVoice:"",postLink:"",sitemap:"",describeBrand:"",keywords:[],persona:""}),[v,S]=h.useState(""),V=()=>w(null,null,function*(){if(!r.postLink){g.error("Please enter your company website URL");return}o(!0);try{const s=`${p}${r.postLink.replace(/^https?:\/\//,"")}`,a=yield T(s);x(l=>d(c({},l),{nameOfVoice:a.nameOfVoice||l.nameOfVoice,describeBrand:a.describeBrand||l.describeBrand,keywords:a.keywords||l.keywords,persona:a.persona||l.persona,sitemap:a.sitemap||l.sitemap})),g.success("Company information fetched successfully!"),m(1)}catch(s){g.warning(s.message||"Couldn't fetch company information automatically. Please enter details manually."),m(1)}finally{o(!1)}}),B=()=>{if(v.trim()){const s=v.split(",").map(a=>a.trim()).filter(a=>a&&!r.keywords.includes(a));x(a=>d(c({},a),{keywords:[...a.keywords,...s]})),S("")}},_=s=>{x(a=>d(c({},a),{keywords:a.keywords.filter(l=>l!==s)}))},z=()=>{var s,a,l;if(!((s=r.describeBrand)!=null&&s.trim())){g.error("Please enter your brand description");return}if(!((a=r.persona)!=null&&a.trim())){g.error("Please enter your author persona");return}if(!((l=r.keywords)!=null&&l.length)){g.error("Please add at least one keyword");return}m(2)},P=()=>w(null,null,function*(){var s,a;(a=(s=r.sitemap)==null?void 0:s.trim())!=null&&a.length||delete r.sitemap,N(!0);try{const l=d(c({},r),{postLink:`${p}${r.postLink.replace(/^https?:\/\//,"")}`});yield M(l),g.success("Brand voice created successfully!"),t!=null&&t._id&&localStorage.setItem(`hasCompletedOnboarding_${t._id}`,"true"),sessionStorage.setItem("justCompletedOnboarding","true"),i("/dashboard",{replace:!0})}catch(l){g.error(l.message||"Failed to create brand voice")}finally{N(!1)}}),D=()=>{t!=null&&t._id&&localStorage.setItem(`hasCompletedOnboarding_${t._id}`,"true"),sessionStorage.setItem("justCompletedOnboarding","true"),i("/dashboard")},$=[{title:"Company Info",icon:Y},{title:"Brand Details",icon:q},{title:"Review",icon:H}];return e.jsxs("div",{className:"min-h-screen bg-white flex items-center justify-center p-6 relative",children:[e.jsx(y,{type:"text",onClick:D,disabled:!(t!=null&&t._id),className:"absolute top-6 right-6 text-gray-500 hover:text-gray-900",children:"Skip"}),e.jsxs("div",{className:"w-full max-w-xl",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-3",children:"GenWrite"}),e.jsx("p",{className:"text-gray-500",children:"Set up your brand voice"})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mb-12",children:$.map((s,a)=>e.jsx("div",{className:`h-2 rounded-full transition-all ${a===u?"w-8 bg-gray-900":a<u?"w-2 bg-gray-400":"w-2 bg-gray-200"}`},a))}),e.jsxs(J,{mode:"wait",children:[u===0&&e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Company Information"}),e.jsx("p",{className:"text-gray-500",children:"We'll analyze your website to understand your brand"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Company Name"}),e.jsx(b,{size:"large",placeholder:"Acme Corporation",value:r.nameOfVoice,onChange:s=>x(a=>d(c({},a),{nameOfVoice:s.target.value})),className:"rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Website URL"}),e.jsx(b,{size:"large",placeholder:"www.example.com",addonBefore:e.jsxs(k,{value:p,onChange:A,dropdownMatchSelectWidth:!1,className:"protocol-select",children:[e.jsx(k.Option,{value:"https://",children:"https://"}),e.jsx(k.Option,{value:"http://",children:"http://"})]}),value:r.postLink,onChange:s=>x(a=>d(c({},a),{postLink:s.target.value})),className:"url-input"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:["Sitemap URL ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),e.jsx(b,{size:"large",placeholder:"https://www.example.com/sitemap.xml",value:r.sitemap,onChange:s=>x(a=>d(c({},a),{sitemap:s.target.value})),className:"rounded-lg"})]})]}),e.jsx(y,{type:"primary",size:"large",block:!0,onClick:V,loading:f,disabled:!r.postLink||!r.nameOfVoice,className:"h-12 bg-gray-900 hover:bg-gray-800 rounded-lg font-medium",children:f?"Analyzing...":"Continue"})]},"step-0"),u===1&&e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Brand Details"}),e.jsx("p",{className:"text-gray-500",children:"Refine your brand information"})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Brand Description"}),e.jsx(L,{rows:4,placeholder:"Describe what your company does...",value:r.describeBrand,onChange:s=>x(a=>d(c({},a),{describeBrand:s.target.value})),className:"rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Author Persona"}),e.jsx(L,{rows:3,placeholder:"What is your Author Persona?",value:r.persona,onChange:s=>x(a=>d(c({},a),{persona:s.target.value})),className:"rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Keywords"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx(b,{placeholder:"Add keywords (comma-separated)",value:v,onChange:s=>S(s.target.value),onKeyDown:s=>s.key==="Enter"&&B(),className:"rounded-lg"}),e.jsx(y,{onClick:B,className:"rounded-lg",children:"Add"})]}),r.keywords.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:r.keywords.map((s,a)=>e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full text-sm",children:[s,e.jsx("button",{onClick:()=>_(s),className:"hover:text-gray-900",children:"Ã—"})]},a))})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(y,{size:"large",onClick:()=>m(0),className:"flex-1 rounded-lg",children:"Back"}),e.jsx(y,{type:"primary",size:"large",onClick:z,className:"flex-1 h-12 bg-gray-900 hover:bg-gray-800 rounded-lg font-medium",children:"Continue"})]})]},"step-1"),u===2&&e.jsxs(C.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Review"}),e.jsx("p",{className:"text-gray-500",children:"Verify your information before creating"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Brand Name"}),e.jsx("p",{className:"text-gray-900",children:r.nameOfVoice||"Not provided"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Website"}),e.jsxs("p",{className:"text-gray-900",children:[p,r.postLink||"Not provided"]})]}),r.describeBrand&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Description"}),e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:r.describeBrand})]}),r.persona&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Author Persona"}),e.jsx("p",{className:"text-gray-700 text-sm",children:r.persona})]}),r.keywords.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.keywords.map((s,a)=>e.jsx("span",{className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full text-sm",children:s},a))})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(y,{size:"large",onClick:()=>m(1),className:"flex-1 rounded-lg",children:"Back"}),e.jsx(y,{type:"primary",size:"large",onClick:P,loading:j,className:"flex-1 h-12 bg-gray-900 hover:bg-gray-800 rounded-lg font-medium",children:j?"Creating...":"Create Brand Voice"})]})]},"step-2")]}),e.jsx("p",{className:"text-center text-gray-400 text-sm mt-12",children:"You can update these settings anytime"})]})]})};export{de as default};
