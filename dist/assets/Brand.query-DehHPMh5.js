var m=Object.defineProperty,C=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var q=(a,t,e)=>t in a?m(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,u=(a,t)=>{for(var e in t||(t={}))g.call(t,e)&&q(a,e,t[e]);if(K)for(var e of K(t))D.call(t,e)&&q(a,e,t[e]);return a},f=(a,t)=>C(a,w(t));var r=(a,t,e)=>q(a,typeof t!="symbol"?t+"":t,e);var n=(a,t,e)=>new Promise((s,i)=>{var y=c=>{try{d(e.next(c))}catch(Q){i(Q)}},h=c=>{try{d(e.throw(c))}catch(Q){i(Q)}},d=c=>c.done?s(c.value):Promise.resolve(c.value).then(y,h);d((e=e.apply(a,t)).next())});import{u as b}from"./useQuery-CvIsJ24k.js";import{u as $}from"./useMutation-UNyARoir.js";import{u as F}from"./useInfiniteQuery-B2N6sxXC.js";import{ds as I,am as l}from"./index-BF2wYnc7.js";class P{constructor(){r(this,"queryClient",I);r(this,"defaultQueryOptions",{staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!0,refetchOnMount:!1,retry:1});r(this,"useFetchQuery",(t,e,s)=>b(u(u({queryKey:[...this.baseKey,t],queryFn:e},this.defaultQueryOptions),s)));r(this,"useParamQuery",(t,e,s,i)=>b(u(u({queryKey:[...this.baseKey,t,s],queryFn:()=>e(s)},this.defaultQueryOptions),i)));r(this,"useInfiniteQuery",(t,e,s,i,y)=>F(u(u({queryKey:[...this.baseKey,t,i],queryFn:({pageParam:h=1})=>e(f(u({},i),{page:h})),getNextPageParam:s,initialPageParam:1},this.defaultQueryOptions),y)));r(this,"useMutate",(t,e)=>$(u({mutationFn:t},e)));r(this,"setData",(t,e,s)=>{this.queryClient.setQueryData([...this.baseKey,t,e],s)});r(this,"invalidate",t=>this.queryClient.invalidateQueries({queryKey:t?[...this.baseKey,t]:this.baseKey}));r(this,"prefetch",(t,e,s)=>n(this,null,function*(){try{return yield this.queryClient.prefetchQuery(u({queryKey:[...this.baseKey,t],queryFn:e},s)),!0}catch(i){return console.warn(`Prefetch error [${this.baseKey}]:`,i),!1}}));r(this,"prefetchParam",(t,e,s,i)=>n(this,null,function*(){try{return yield this.queryClient.prefetchQuery(u({queryKey:[...this.baseKey,t,s],queryFn:()=>e(s)},i)),!0}catch(y){return console.warn(`Prefetch error [${this.baseKey}]:`,y),!1}}))}}class S extends P{constructor(){super(...arguments);r(this,"useList",e=>this.useFetchQuery("list",()=>this.api.list(),e));r(this,"useListParams",(e,s)=>this.useParamQuery("list",this.api.list,e,s));r(this,"useDetail",(e,s)=>this.useFetchQuery(`detail-${e}`,()=>this.api.get(e),s));r(this,"useCreate",e=>this.useMutate(this.api.create,f(u({},e),{onSuccess:s=>{var i;this.queryClient.setQueryData([...this.baseKey,"list"],(y=[])=>[...y||[],s]),(i=e==null?void 0:e.onSuccess)==null||i.call(e,s)}})));r(this,"useUpdate",e=>this.useMutate(({id:s,data:i})=>this.api.update(s,i),f(u({},e),{onSuccess:s=>{var i;this.queryClient.setQueryData([...this.baseKey,"list"],(y=[])=>y.map(h=>h._id===s._id?s:h)),this.queryClient.setQueryData([...this.baseKey,`detail-${s._id}`],s),(i=e==null?void 0:e.onSuccess)==null||i.call(e,s)}})));r(this,"useDelete",e=>this.useMutate(this.api.delete,f(u({},e),{onSuccess:(s,i)=>{var y;this.queryClient.setQueryData([...this.baseKey,"list"],(h=[])=>h.filter(d=>d._id!==i)),this.queryClient.removeQueries({queryKey:[...this.baseKey,`detail-${i}`]}),(y=e==null?void 0:e.onSuccess)==null||y.call(e,i)}})));r(this,"prefetchList",e=>this.prefetch("list",()=>this.api.list(e)));r(this,"prefetchDetail",e=>this.prefetch(`detail-${e}`,()=>this.api.get(e)));r(this,"invalidateList",()=>this.invalidate("list"));r(this,"invalidateDetail",e=>this.invalidate(`detail-${e}`))}}const O={list:()=>n(null,null,function*(){return(yield l.get("/brand")).data}),get:a=>n(null,null,function*(){return(yield l.get(`/brand/${a}`)).data}),create:a=>n(null,null,function*(){return(yield l.post("/brand/addBrand",a)).data}),update:(a,t)=>n(null,null,function*(){return(yield l.put(`/brand/${a}`,t)).data}),delete:a=>n(null,null,function*(){yield l.delete(`/brand/${a}`)}),getSiteInfo:a=>n(null,null,function*(){return(yield l.get("/brand/site-info",{params:{url:a}})).data})};class M extends S{constructor(){super(...arguments);r(this,"baseKey",["brand"]);r(this,"api",O);r(this,"useSiteInfo",(e,s)=>this.useFetchQuery(`siteInfo-${e}`,()=>this.api.getSiteInfo(e),s))}}const x=new M;export{x as b};
