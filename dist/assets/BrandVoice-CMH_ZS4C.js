import{aG as I,aM as E,aL as P,j as e,aV as r,aY as $,aJ as y}from"./index-Ma0rgsIm.js";import{b as p}from"./chunk-tiptap-JX9QK0Ia.js";import{b as S,c as K}from"./index-BpznHgXJ.js";import"./iconBase-XDJ6T7v5.js";const J=()=>{var V;I(),E();const g=P(a=>a.auth.user),[s,l]=p.useState({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null}),[m,x]=p.useState(""),[j,d]=p.useState(!1),[h,v]=p.useState([]),b=async()=>{try{const a=await y.get("/brand");let t=Array.isArray(a.data)?a.data:a.data?[a.data]:[];console.log("Fetched brands:",t),v(t),t.length>0&&!s.selectedVoice&&l(o=>({...o,selectedVoice:t[0]}))}catch{v([])}};p.useEffect(()=>{b()},[]);const N=a=>{l({nameOfVoice:a.nameOfVoice,postLink:a.postLink,keywords:Array.isArray(a.keywords)?a.keywords:[],describeBrand:a.describeBrand,selectedVoice:a,uploadedFile:null,_id:a._id})},L=async()=>{var a,t,o,c,w,u,n,B,F;try{d(!0);const i={nameOfVoice:(a=s.nameOfVoice)==null?void 0:a.trim(),postLink:(t=s.postLink)==null?void 0:t.trim(),keywords:Array.isArray(s.keywords)?s.keywords.map(T=>String(T).trim()).filter(Boolean):[],describeBrand:(o=s.describeBrand)==null?void 0:o.trim(),userId:g==null?void 0:g._id};if(!i.nameOfVoice||!i.postLink||!i.describeBrand||i.keywords.length===0){d(!1),alert("All fields are required and at least one keyword must be provided.");return}try{new URL(i.postLink)}catch{d(!1),alert("Please enter a valid URL for the post link.");return}let C;s._id?C=await y.put(`/brand/${s._id}`,i):C=await y.post("/brand/addBrand",i),d(!1),b(),l({nameOfVoice:"",postLink:"",keywords:[],describeBrand:"",selectedVoice:null,uploadedFile:null,_id:void 0})}catch(i){d(!1),alert(((w=(c=i==null?void 0:i.response)==null?void 0:c.data)==null?void 0:w.message)||((F=(B=(n=(u=i==null?void 0:i.response)==null?void 0:u.data)==null?void 0:n.errors)==null?void 0:B[0])==null?void 0:F.msg)||"Failed to save brand voice. Please check your input.")}},k=async a=>{try{await y.delete(`/brand/${a._id}`),b(),s.selectedVoice&&s.selectedVoice._id===a._id&&l(t=>({...t,selectedVoice:null}))}catch{alert("Failed to delete brand voice.")}},f=a=>{const{name:t,value:o}=a.target;l({...s,[t]:o})},_=a=>{l(t=>({...t,selectedVoice:a}))},H=a=>{const t=a.target.files[0];if(t&&t.type==="text/csv"){const o=new FileReader;o.onload=c=>{let u=c.target.result.split(/,|\n|;/).map(n=>n.trim()).filter(n=>n.length>0);l(n=>({...n,uploadedFile:t.name,keywords:Array.from(new Set([...n.keywords,...u]))}))},o.readAsText(t)}},O=a=>{a.key==="Enter"&&m.trim()&&(l({...s,keywords:[...s.keywords,m.trim()]}),x(""))},A=a=>{l({...s,keywords:s.keywords.filter(t=>t!==a)})},D=()=>{const a=s.keywords.slice(-3),t=s.keywords.length-a.length;return e.jsxs(e.Fragment,{children:[t>0&&e.jsx(r.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{scale:.8},animate:{scale:1},children:e.jsx("span",{className:"text-sm",children:`+${t}`})}),a.map((o,c)=>e.jsxs(r.div,{className:"flex items-center bg-indigo-100 text-indigo-700 rounded-md px-2 py-1 mr-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.8},whileHover:{scale:1.05},children:[e.jsx("span",{className:"text-sm",children:o}),e.jsx(K,{className:"ml-1 cursor-pointer text-indigo-500 hover:text-indigo-700 transition-colors",onClick:()=>A(o)})]},c))]})};return e.jsxs(r.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-8 justify-around p-6",children:[e.jsxs(r.div,{className:"w-[60%] bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:-20},animate:{x:0},children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Letâ€™s create your Brand Voice"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Prototype group pixel duplicate ellipse hand draft style rotate. Layout follower scale comment flows draft select."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Name of Voice"}),e.jsx(r.input,{type:"text",name:"nameOfVoice",value:s.nameOfVoice,onChange:f,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Paste link of your post or blog *"}),e.jsx(r.input,{type:"text",name:"postLink",value:s.postLink,onChange:f,placeholder:"e.g., How to get?",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",whileFocus:{scale:1.01}})]}),e.jsxs("div",{className:"text-center my-4 relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center",children:e.jsx("span",{className:"bg-white px-4 text-gray-500",children:"OR"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Keywords*"}),e.jsxs(r.div,{className:"flex items-center bg-white border border-gray-300 rounded-lg p-2 flex-wrap gap-2",whileHover:{boxShadow:"0 0 0 3px rgba(99, 102, 241, 0.2)"},children:[D(),e.jsx("input",{type:"text",value:m,onChange:a=>x(a.target.value),onKeyDown:O,className:"flex-grow p-2 bg-white border-none outline-none rounded-l-md",placeholder:"e.g., Fun"}),e.jsx("label",{htmlFor:"file-upload",className:"flex items-center cursor-pointer",children:e.jsx(r.div,{className:"bg-indigo-100 p-2 rounded-lg",whileHover:{scale:1.1},whileTap:{scale:.95},children:e.jsx("img",{src:"./Images/upload.png",alt:"Upload",className:"w-6 h-6"})})}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:H,accept:".csv"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Describe your Brand"}),e.jsx(r.textarea,{name:"describeBrand",value:s.describeBrand,onChange:f,placeholder:"Write a blog on how to cook pasta",className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent",rows:"4",whileFocus:{scale:1.01}})]}),e.jsx("div",{className:"text-right",children:e.jsx(r.button,{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white px-8 py-3 rounded-lg font-medium shadow-md hover:shadow-lg transition-all",onClick:L,whileHover:{scale:1.03,y:-2},whileTap:{scale:.98},children:"Save Brand Voice"})})]})]}),e.jsx("div",{className:"h-auto w-px bg-gray-200 mx-2"}),e.jsxs(r.div,{className:"flex-1 bg-white rounded-xl p-6 shadow-lg border border-gray-100",initial:{x:20},animate:{x:0},children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800 mb-4",children:"Selected Brand Voice"}),e.jsx("div",{className:"mb-8",children:e.jsx($,{children:s.selectedVoice?e.jsxs(r.div,{className:"rounded-xl bg-gradient-to-br from-indigo-50 to-purple-50 border-2 border-indigo-200 p-4 shadow-sm",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0},whileHover:{y:-5},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-indigo-700 font-medium",children:s.selectedVoice.nameOfVoice}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r.button,{className:"text-indigo-500 hover:text-indigo-700",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>N(s.selectedVoice),children:e.jsx(S,{})}),e.jsx(r.button,{className:"text-gray-500 hover:text-red-500",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>k(s.selectedVoice),children:e.jsx("img",{src:"/Images/trash.png",alt:"Delete",className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:((V=s.selectedVoice.describeBrand)==null?void 0:V.length)>100?`${s.selectedVoice.describeBrand.substring(0,100)}...`:s.selectedVoice.describeBrand})]}):e.jsx(r.div,{className:"p-6 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center",initial:{opacity:0},animate:{opacity:1},children:e.jsx("p",{className:"text-gray-500",children:"No brand voice selected. Select one from below."})})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Select Brand Voice"}),e.jsx("div",{className:"space-y-4 max-h-[500px] overflow-y-auto pr-2",children:h.map(a=>{var t;return e.jsx(R,{id:a._id,brandName:a.nameOfVoice,brandVoice:a.describeBrand,onSelect:()=>_(a),isSelected:((t=s.selectedVoice)==null?void 0:t._id)===a._id,onEdit:()=>N(a),onDelete:()=>k(a)},a._id)})})]})]})},R=({id:g,brandName:s,brandVoice:l,onSelect:m,isSelected:x,onEdit:j,onDelete:d})=>e.jsxs(r.div,{className:`p-4 rounded-xl cursor-pointer transition-all ${x?"bg-gradient-to-r from-indigo-100 to-purple-100 border-2 border-indigo-300 shadow-md":"bg-white border border-gray-200 hover:border-indigo-300"}`,onClick:m,whileHover:{y:-3,boxShadow:"0 4px 12px rgba(99, 102, 241, 0.1)"},whileTap:{scale:.98},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:`font-medium ${x?"text-indigo-700":"text-gray-700"}`,children:s}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r.button,{className:"text-indigo-500 hover:text-indigo-700",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:h=>{h.stopPropagation(),j()},children:e.jsx(S,{})}),e.jsx(r.button,{className:"text-gray-500 hover:text-red-500",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:h=>{h.stopPropagation(),d()},children:e.jsx("img",{src:"/Images/trash.png",alt:"Delete",className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:l.length>100?`${l.substring(0,100)}...`:l})]});export{J as default};
