import{q as _,a as I,Y as T,j as e,T as F,N as R,b as S,Z as b}from"./index-DLHHoihS.js";import{b as l}from"./chunk-tiptap-JX9QK0Ia.js";import{S as z}from"./SkeletonLoader-CdP3chkX.js";import{B as G}from"./index-CzC5iGAo.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Y=_("trash-2",U),H=()=>{const[y,j]=l.useState([]),[v,P]=l.useState(1),[n,m]=l.useState(5),[B,w]=l.useState(!0),k=I(),{handlePopup:A}=T(),D=async()=>{var t,s;try{w(!0);const h=(await S.get("/blogs/")).data.filter(o=>!o.isArchived).sort((o,x)=>new Date(x.createdAt)-new Date(o.createdAt));j(h)}catch(r){console.error("Error fetching blogs:",((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to fetch blogs")}finally{w(!1)}};l.useEffect(()=>{D()},[]),l.useEffect(()=>{const t=()=>{window.innerWidth>=1024?m(15):window.innerWidth>=768?m(12):m(6)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const C=t=>{k(`/toolbox/${t._id}`,{state:{blog:t}})},g=Math.ceil(y.length/n),N=(v-1)*n,i=y.slice(N,N+n),L=t=>{P(t)},E=async t=>{try{(await S.patch(`/blogs/archive/${t}`)).status===200?(j(r=>r.filter(a=>a._id!==t)),b.success("Blog archived successfully!")):b.error("Failed to archive blog.")}catch(s){b.error("Failed to archive blog."),console.error("Error archiving blog:",s.response&&s.response.data&&s.response.data.message||"Failed to archive blog")}};return e.jsxs("div",{className:"max-w-7xl mx-auto",style:{overflowY:"auto"},children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Blogs Generated"}),B?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:[...Array(n)].map((t,s)=>e.jsx("div",{className:"bg-white shadow-md rounded-xl p-4",children:e.jsx(z,{})},s))}):i.length===0?e.jsx("p",{children:"No blogs available."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 place-items-center p-2",children:i==null?void 0:i.map(t=>{const{_id:s,title:r,status:a,createdAt:h,content:o,aiModel:x,focusKeywords:p,updatedAt:$,wordpress:c,agendaJob:d}=t,u=/gemini/gi.test(x);return e.jsx(G.Ribbon,{text:e.jsxs("span",{className:"flex items-center justify-center gap-1 py-1 font-medium tracking-wide",children:[e.jsx("img",{src:`./Images/${u?"gemini":"chatgpt"}.png`,alt:"",width:20,height:20,loading:"lazy",className:"bg-white"}),u?"Gemini-1.5-flash":"Chatgpt-4o-mini"]}),className:"absolute top-0",color:u?"#4796E3":"#74AA9C",children:e.jsxs("div",{className:`bg-white shadow-md  hover:shadow-xl  transition-all duration-300 rounded-xl p-4 min-h-[180px] min-w-[390px] relative
                        ${(a==="failed"?"border-red-500":a!=="complete"&&"border-yellow-500")+" border-2"}
                      `,title:r,children:[e.jsx("div",{className:"text-xs font-semibold text-gray-400 mb-2 -mt-2",children:new Date(h).toLocaleDateString("en-US",{dateStyle:"medium"})}),e.jsx(F,{title:a==="complete"?r:["failed","in-progress"].includes(a)?`Blog generation is ${a}`:`Pending Blog will be generated ${d!=null&&d.nextRunAt?"at "+new Date(d.nextRunAt).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"shortly"}`,color:a==="complete"?"black":a==="failed"?"red":"orange",children:e.jsx("div",{className:"cursor-pointer",onClick:()=>{const{status:f}=t;f==="complete"&&C(t)},children:e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-between mb-2 ",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 !text-left max-w-76",children:r}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-3 break-all",children:o||""})]})})}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:p==null?void 0:p.map((f,M)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:f},M))}),e.jsx(R,{type:"undefined",className:"p-2 hover:!border-red-500 hover:text-red-500",onClick:()=>A({title:"Move to Trash",description:e.jsxs("span",{className:"my-2",children:["Blog ",e.jsx("b",{children:r})," will be moved to trash. You can restore it later."]}),confirmText:"Archive",onConfirm:()=>{console.log("Trashing blog:",s),E(s)},confirmProps:{type:"undefined",className:"border-red-500 hover:bg-red-500 hover:text-white"},cancelProps:{danger:!1}}),children:e.jsx(Y,{})})]}),e.jsxs("div",{className:"mt-3 -mb-2 flex justify-end text-xs text-right text-gray-500 font-medium",children:[(c==null?void 0:c.postedOn)&&e.jsxs("span",{className:"",children:["Posted on :  ",new Date(c.postedOn).toLocaleDateString("en-US",{dateStyle:"medium"})]}),e.jsxs("span",{className:"ml-auto",children:["Last updated :  ",new Date($).toLocaleDateString("en-US",{dateStyle:"medium"})]})]})]})},s)})}),g>1&&e.jsx("div",{className:"flex justify-center mt-8 self-end",children:e.jsx("nav",{className:"inline-flex rounded-md shadow",children:e.jsx("ul",{className:"flex",children:Array.from({length:g},(t,s)=>e.jsx("li",{children:e.jsx("button",{onClick:()=>L(s+1),className:`px-4 py-2 border-r border-gray-200 text-sm font-medium ${v===s+1?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"} ${s===0?"rounded-l-md":""} ${s===g-1?"rounded-r-md border-r-0":""}`,children:s+1})},s))})})})]})]})};export{H as default};
