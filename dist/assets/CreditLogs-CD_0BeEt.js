import{u as C,a as L,j as r,A,H as I,m as E,l as U,s as k,T as z}from"./index-wwiryTJs.js";import{b as s}from"./chunk-tiptap-CHS2hqlU.js";import{D as F}from"./index-Dzhda_za.js";import{I as R}from"./index-CpYoDl8S.js";import{R as O}from"./SearchOutlined-D2jOLeHX.js";import{S as $}from"./Pagination-Dbj20mxY.js";import{F as M}from"./Table-B0stjlRe.js";import{T as f}from"./index-CtIGVg0G.js";import"./ClockCircleOutlined-CELcQ7Uv.js";import"./Overflow-BfDMM7oN.js";import"./useIcons-CNAZog-J.js";import"./Input-DtDAdS0q.js";import"./index-DnN5FNDk.js";import"./EllipsisOutlined-B90HHQKU.js";const ee=()=>{const[d,h]=s.useState([]),[y,m]=s.useState([]),[b,j]=s.useState(!0),[i,S]=s.useState(""),[o,D]=s.useState([]),[n,T]=s.useState(null),g=C(),{RangePicker:N}=F,p=L(),[l,x]=s.useState({current:1,pageSize:10}),v=[10,20,50,100];s.useEffect(()=>{(async()=>{try{const t=await U(g);p(T(t==null?void 0:t.user))}catch(t){console.error("User load failed:",t)}})()},[p,g]),s.useEffect(()=>{(async()=>{try{h(n==null?void 0:n.creditLogs),m(n==null?void 0:n.creditLogs)}catch(t){k.error("Failed to load credit logs"),console.error("Failed to load credit logs",t)}finally{j(!1)}})()},[n]),s.useEffect(()=>{let e=d;if(i&&(e=e==null?void 0:e.filter(t=>{var a,c;return(c=(a=t.meta)==null?void 0:a.blogTitle)==null?void 0:c.toLowerCase().includes(i.toLowerCase())})),o&&o.length===2&&o[0]&&o[1]){const t=o[0].startOf("day").toDate(),a=o[1].endOf("day").toDate();e=e.filter(c=>{const u=new Date(c.createdAt);return u>=t&&u<=a})}m(e)},[i,o,d]);const w=[{title:"Date",dataIndex:"createdAt",key:"createdAt",sorter:(e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime(),render:e=>r.jsx("span",{className:"text-sm text-gray-600",children:new Date(e).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"})})},{title:"Type",dataIndex:"type",key:"type",filters:[{text:"Deduction",value:"DEDUCTION"},{text:"Adjustment",value:"ADJUSTMENT"}],onFilter:(e,t)=>t.type===e,render:e=>r.jsx(f,{color:e==="DEDUCTION"?"red":"green",className:"font-medium px-2 py-0.5 rounded-full",children:e})},{title:"Amount",dataIndex:"amount",key:"amount",sorter:(e,t)=>e.amount-t.amount,render:e=>r.jsx("span",{className:`font-semibold ${e<0?"text-red-500":"text-green-600"}`,children:e>0?`+${e}`:e})},{title:"Description",dataIndex:"description",key:"description",render:(e,t)=>{var a;return r.jsxs("div",{className:"text-sm text-gray-800 flex items-center",children:[e,((a=t.meta)==null?void 0:a.error)&&r.jsx(z,{title:t.meta.error,children:r.jsx(f,{color:"volcano",className:"ml-2 cursor-pointer px-2 py-0.5 rounded-full",children:"Error"})})]})}},{title:"Blog Topic",dataIndex:["meta","blogTitle"],key:"blogTitle",render:(e,t)=>{var a;return r.jsx("span",{children:(a=t.meta)==null?void 0:a.blogTitle})}}];return r.jsxs(A,{children:[r.jsx(I,{children:r.jsx("title",{children:"Credit Logs | GenWrite"})}),r.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.3},className:"p-6 bg-white rounded-2xl shadow-lg border border-gray-100",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Credit Logs"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(R,{prefix:r.jsx(O,{className:"text-gray-400"}),placeholder:"Search by blog title",value:i,onChange:e=>S(e.target.value),className:"w-64 rounded-lg border-gray-200 hover:border-blue-300"}),r.jsx(N,{onChange:e=>D(e||[]),className:"rounded-lg border-gray-200 hover:border-blue-300",format:"YYYY-MM-DD"}),r.jsx($,{value:l.pageSize,onChange:e=>x({...l,pageSize:e}),options:v.map(e=>({label:`${e} / page`,value:e})),style:{width:120}})]})]}),r.jsx(M,{dataSource:y,columns:w,loading:b,rowKey:(e,t)=>`${e.createdAt}-${t}`,pagination:{current:l.current,pageSize:l.pageSize,showSizeChanger:!1,onChange:(e,t)=>{x({current:e,pageSize:t})}},className:"rounded-xl overflow-hidden",rowClassName:"hover:bg-gray-50 transition-colors",bordered:!1,scroll:{x:"max-content"}})]})]})};export{ee as default};
