var Oe=Object.defineProperty,_e=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var ye=(i,n,s)=>n in i?Oe(i,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[n]=s,be=(i,n)=>{for(var s in n||(n={}))Te.call(n,s)&&ye(i,s,n[s]);if(pe)for(var s of pe(n))Pe.call(n,s)&&ye(i,s,n[s]);return i},je=(i,n)=>_e(i,Ie(n));var fe=(i,n,s)=>new Promise((x,r)=>{var j=h=>{try{f(s.next(h))}catch(u){r(u)}},N=h=>{try{f(s.throw(h))}catch(u){r(u)}},f=h=>h.done?x(h.value):Promise.resolve(h.value).then(j,N);f((s=s.apply(i,n)).next())});import{r as d,I as ke,aB as Ee,aC as Be,$ as Ke,u as $e,a as we,ab as ze,a5 as Re,j as e,ak as We,V as He,m as g,B as ve,T as B,X as Fe,ag as Ve}from"./index-DNg71K0X.js";import{C as L,E as Ne,L as Ue,g as Ye}from"./getEstimatedCost-D_hJ8uEQ.js";import{S as K}from"./index-BYRmWv2I.js";import{I as qe}from"./index-CVXRHeq7.js";import{T as O}from"./index-r_byTzJt.js";import{E as Xe}from"./index-BP7Hg726.js";import{T as Ge,C as $}from"./index-Cy7RRu7r.js";import{P as Je}from"./progress-BIUtIUae.js";import{c as Qe}from"./createLucideIcon-Cn2T5c06.js";/**
 * @license lucide-react v0.488.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],z=Qe("activity",Ze);function R(){return R=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var x in s)Object.prototype.hasOwnProperty.call(s,x)&&(i[x]=s[x])}return i},R.apply(this,arguments)}const De=(i,n)=>d.createElement(ke,R({},i,{ref:n,icon:Ee})),xs=d.forwardRef(De);function W(){return W=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var x in s)Object.prototype.hasOwnProperty.call(s,x)&&(i[x]=s[x])}return i},W.apply(this,arguments)}const es=(i,n)=>d.createElement(ke,W({},i,{ref:n,icon:Be})),ss=d.forwardRef(es),{Panel:C}=L,hs=({closeFnc:i,open:n})=>{var J,Q,Z,D,ee,se,te,ae,ne,le,ie,re,de,oe,ce,me,xe,he,ue;const[s,x]=d.useState({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),[r,j]=d.useState(null),[N,f]=d.useState(null),[h,u]=d.useState(!1),[Ce,y]=d.useState(null),[_,I]=d.useState(0),{handlePopup:Le}=Ke(),M=$e(),{analysis:T,loading:w}=we(t=>t.analysis),{allBlogs:v,loading:S}=we(t=>t.blog);d.useEffect(()=>{!w&&T&&j(T)},[T,w]),d.useEffect(()=>{n?M(ze()):(x({title:"",content:"",keywords:[],focusKeywords:[],contentType:"markdown",selectedProject:null,generatedMetadata:null}),j(null),f(null),u(!1),y(null),I(0))},[n]),d.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[n]),d.useEffect(()=>{N&&(u(!0),M(Re(N)).unwrap().then(t=>{t!=null&&t._id&&x(a=>je(be({},a),{title:t.title,content:t.content||"",keywords:t.keywords||[],focusKeywords:t.focusKeywords||[],selectedProject:t,contentType:"markdown",generatedMetadata:t.generatedMetadata||null}))}).catch(t=>{console.error("Failed to fetch blog by ID:",t)}).finally(()=>u(!1)))},[N,M]),d.useEffect(()=>{var b,p,k,A,ge;const t=E.length>0,a=((p=(b=s==null?void 0:s.generatedMetadata)==null?void 0:b.outboundLinks)==null?void 0:p.length)>0,l=((A=(k=s==null?void 0:s.generatedMetadata)==null?void 0:k.internalLinks)==null?void 0:A.length)>0,o=!!r,m=!!((ge=s==null?void 0:s.generatedMetadata)!=null&&ge.competitorsAnalysis);y(o?"results":t?"competitors":a||l?"links":m?"initial-analysis":null)},[r,(J=s==null?void 0:s.generatedMetadata)==null?void 0:J.competitors,(Q=s==null?void 0:s.generatedMetadata)==null?void 0:Q.outboundLinks,(Z=s==null?void 0:s.generatedMetadata)==null?void 0:Z.internalLinks,(D=s==null?void 0:s.generatedMetadata)==null?void 0:D.competitorsAnalysis]);const Me=t=>{const a=v==null?void 0:v.find(l=>l._id===t);a&&(f(a._id),j(null),I(l=>l+1))},Se=()=>{if(s.title.trim()&&s.content.trim()&&!(s.keywords.length===0&&s.focusKeywords.length===0)){if(s.content.length<500){Fe.warning("Your content is too short. This may affect competitive analysis accuracy.");return}Le({title:"Analyze Competitors",description:e.jsxs("p",{children:["Competitive Analysis cost: ",e.jsxs("b",{children:[Ye("analysis.competitors")," credits"]}),e.jsx("br",{}),"Do you wish to proceed?"]}),onConfirm:()=>fe(null,null,function*(){var t;u(!0);try{const a=yield M(Ve({title:s.title,content:s.content,keywords:[...new Set([...s.keywords,...s.focusKeywords])],contentType:s.contentType,blogId:(t=s==null?void 0:s.selectedProject)==null?void 0:t._id})).unwrap();j(a)}catch(a){console.error("Error fetching analysis:",a)}finally{u(!1)}})})}},c=t=>t?t.replace(/#{1,3}\s/g,"").replace(/[\*_~`]/g,"").replace(/\n+/g,`
`).trim():"",P=t=>t?c(t).split(`
`).filter(a=>a.trim()!=="").map((a,l)=>e.jsx("p",{className:"mb-2 text-sm md:text-base",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:a.trim().replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},l)):[],Ae=t=>!t||t.length===0?null:e.jsx(L,{accordion:!0,className:"bg-white border border-gray-200 rounded-lg",children:t.map((a,l)=>{var o;return e.jsx(C,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800 truncate max-w-[80%] sm:max-w-[60%] text-sm md:text-base",children:c(a.title)}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0",children:[e.jsx(B,{title:"Relatable Score",children:a.score&&e.jsxs(O,{color:"blue",children:[(a.score*100).toFixed(2),"%"]})}),e.jsxs("a",{href:(o=a==null?void 0:a.link)!=null?o:a==null?void 0:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:m=>m.stopPropagation(),children:["Visit ",e.jsx(Ne,{className:"w-4 h-4"})]})]})]}),className:"text-sm md:text-base text-gray-700 leading-relaxed",children:a!=null&&a.content?e.jsx("div",{children:P(a.content)}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mb-2 font-medium",children:c(a.snippet||a.content)}),e.jsx("div",{children:P(a.summary)})]})},l)})},_),H=(t,a)=>!t||t.length===0?null:e.jsx($,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded text-blue-500",children:e.jsx(Ue,{size:20,strokeWidth:2})}),e.jsx("span",{className:"text-base md:text-lg font-semibold text-gray-800",children:a})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsx(L,{accordion:!0,children:t.map((l,o)=>e.jsxs(C,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center w-full",children:[e.jsx("span",{className:"text-sm md:text-base font-medium text-gray-800",children:c(l.title)}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 sm:mt-0",children:[e.jsx(B,{title:"Relatable Score",children:l.score&&e.jsxs(O,{color:"blue",children:[(l.score*100).toFixed(2),"%"]})}),e.jsxs("a",{href:l.link||l.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 text-sm hover:underline flex items-center gap-1",onClick:m=>m.stopPropagation(),children:["Visit ",e.jsx(Ne,{className:"w-4 h-4"})]})]})]}),className:"text-sm md:text-base text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"text-gray-600",children:c(l.snippet||l.content)}),l.summary&&e.jsx("div",{children:P(l.summary)})]},o))},_)}),F=t=>{if(!t)return null;const{analysis:a,suggestions:l}=t;return e.jsx($,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 rounded text-purple-500",children:e.jsx(z,{size:20,strokeWidth:2})}),e.jsx("span",{className:"text-base md:text-lg font-semibold text-gray-800",children:"Competitors Analysis"})]}),className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsxs(L,{accordion:!0,expandIconPosition:"right",children:[e.jsx(C,{header:e.jsx("span",{className:"font-semibold text-gray-800 text-sm md:text-base",children:"Analysis"}),children:e.jsx(L,{accordion:!0,children:Object.entries(a).map(([o,m],b)=>{const p=m.match(/\((\d+\/\d+)\)$/),k=p?p[1]:null,A=c(m.replace(/\s*\(\d+\/\d+\)$/,"").trim());return e.jsx(C,{header:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center w-full pr-2",children:[e.jsx("span",{className:"font-medium text-gray-800 text-sm md:text-base",children:c(o)}),e.jsx(B,{title:"Relatable Score",children:k&&e.jsx(O,{color:"blue",children:k.replace("/"," / ")})})]}),className:"text-sm md:text-base text-gray-700 leading-relaxed",children:e.jsx("p",{children:A})},o)})})},"analysis"),e.jsx(C,{header:e.jsx("span",{className:"font-semibold text-gray-800 text-sm md:text-base",children:"Suggestions"}),children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm md:text-base text-gray-700",children:l.split(/(?:\d+\.\s)/).filter(Boolean).map((o,m)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:c(o.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},m))})},"suggestions")]},_)})},E=d.useMemo(()=>{var m;const t=((m=s==null?void 0:s.generatedMetadata)==null?void 0:m.competitors)||[],a=(r==null?void 0:r.competitors)||[],l=[],o=new Set;return[...t,...a].forEach(b=>{const p=b.url||b.link;o.has(p)||(o.add(p),l.push(b))}),l},[(ee=s==null?void 0:s.generatedMetadata)==null?void 0:ee.competitors,r==null?void 0:r.competitors]),V=d.useMemo(()=>[...new Set([...s.keywords,...s.focusKeywords])],[s.keywords,s.focusKeywords]),U=E.length>0,Y=((te=(se=s==null?void 0:s.generatedMetadata)==null?void 0:se.outboundLinks)==null?void 0:te.length)>0,q=((ne=(ae=s==null?void 0:s.generatedMetadata)==null?void 0:ae.internalLinks)==null?void 0:ne.length)>0,X=!!r,G=!!((le=s==null?void 0:s.generatedMetadata)!=null&&le.competitorsAnalysis);return h||S||w?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",children:e.jsx(We,{})}):e.jsx(He,{open:n,title:e.jsxs(g.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg text-white",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-900",children:"Competitive Analysis Dashboard"})]}),onCancel:i,footer:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-3",children:[e.jsx(ve,{onClick:i,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition w-full sm:w-auto",children:"Close"}),e.jsx(ve,{onClick:Se,className:`px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition w-full sm:w-auto ${h||S||w?"opacity-50 cursor-not-allowed":""}`,disabled:h||S||w,children:h||S||w?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ss,{}),r?"Re-Analyzing...":"Analyzing..."]}):r?"Re-Run Analysis":"Run Competitive Analysis"})]},"footer")],width:"100%",className:"w-full max-w-[90vw] md:max-w-3xl lg:max-w-4xl",centered:!0,closable:!0,transitionName:"",maskTransitionName:"",styles:{body:{maxHeight:"80vh",overflowY:"auto",padding:"12px sm:16px"}},children:e.jsxs("div",{className:"space-y-4 sm:space-y-6 p-5",children:[e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("label",{className:"block text-sm md:text-base font-medium text-gray-700 mb-2",children:"Select Blog Post"}),e.jsxs(K,{showSearch:!0,filterOption:(t,a)=>{var l;return(l=a==null?void 0:a.children)==null?void 0:l.toLowerCase().includes(t.toLowerCase())},className:"w-full rounded-md text-sm md:text-base",onChange:Me,value:((ie=s.selectedProject)==null?void 0:ie._id)||"",placeholder:"Select a blog",children:[e.jsx(K.Option,{value:"",children:"Select a blog"}),v==null?void 0:v.map(t=>e.jsx(K.Option,{value:t._id,children:t.title.charAt(0).toUpperCase()+t.title.slice(1)},t._id))]})]}),s.selectedProject&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-700",children:"Blog Details"})}),e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("label",{className:"block text-sm md:text-base font-medium text-gray-600 mb-1",children:"Title"}),e.jsx(qe,{name:"title",value:s.title,readOnly:!0,className:"w-full bg-gray-100 cursor-not-allowed text-sm md:text-base"})]}),V.length>0&&e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsx("label",{className:"block text-sm md:text-base font-medium text-gray-600 mb-1",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:V.map((t,a)=>e.jsx(O,{className:"flex items-center gap-1 bg-blue-50 text-blue-700 border-blue-100 text-sm",children:c(t)},t))})]}),s.content?e.jsx("div",{className:"text-gray-700 max-h-40 overflow-y-auto whitespace-pre-wrap leading-relaxed p-3 sm:p-4 bg-gray-50 rounded-md text-sm md:text-base",children:c(s.content).split(`
`).map((t,a)=>e.jsx("p",{className:"mt-2",children:t.trim()},a))}):e.jsx(Xe,{description:"No content available for this blog"})]})]}),((re=s.generatedMetadata)==null?void 0:re.seo_meta)&&e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-3 sm:p-4 bg-gray-50 border-b border-gray-200",children:e.jsx("h3",{className:"text-base md:text-lg font-semibold text-gray-700",children:"SEO Metadata"})}),e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsxs("p",{className:"text-sm md:text-base text-gray-600",children:[e.jsx("strong",{children:"Title:"})," ",c(s.generatedMetadata.seo_meta.title)]}),e.jsxs("p",{className:"text-sm md:text-base text-gray-600 mt-2",children:[e.jsx("strong",{children:"Description:"})," ",c(s.generatedMetadata.seo_meta.description)]})]})]})]}),!s.selectedProject&&e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8 sm:py-10 bg-gray-50 rounded-xl border border-gray-200 shadow-sm",children:e.jsx("p",{className:"text-gray-600 text-sm md:text-lg",children:"Select a blog to view details and analysis"})}),(U||Y||q||X||G)&&e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(Ge,{activeKey:Ce,onChange:t=>{y(t),I(a=>a+1)},type:"card",className:"w-full",children:[X&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"m19 9-5 5-4-4-3 3"})]}),"Analysis Results"]}),children:e.jsxs(g.div,{animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"space-y-4 sm:space-y-6",children:[e.jsxs(g.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},className:"flex flex-col items-center my-10",children:[e.jsx(Je,{type:"dashboard",percent:Number((oe=(de=r.insights)==null?void 0:de.blogScore)!=null?oe:0),width:120,format:t=>`${t} / 100`,strokeColor:{"0%":"#1B6FC9","100%":"#4C9FE8"},trailColor:"#e5e7eb"}),e.jsx("div",{className:"text-gray-800 text-base md:text-lg font-semibold mt-3",children:"Blog SEO Score"})]}),e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.4},children:e.jsx($,{title:"Suggestions to Beat Competitors",className:"bg-white border border-gray-200 rounded-lg shadow-sm",headStyle:{background:"#f9fafb",fontWeight:600,fontSize:"0.9rem sm:1.1rem"},children:e.jsx("ul",{className:"list-decimal pl-6 space-y-3 text-sm md:text-base text-gray-700",children:(me=(ce=r==null?void 0:r.insights)==null?void 0:ce.suggestions)==null?void 0:me.split(/(?:\d+\.\s)/).filter(Boolean).map((t,a)=>e.jsx("li",{children:e.jsx("span",{dangerouslySetInnerHTML:{__html:c(t.trim()).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}})},a))})})}),F(r==null?void 0:r.insights)]})},"results"),U&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("polyline",{points:"14 2 14 8 20 8"})]}),"Competitors"]}),children:Ae(E)},"competitors"),(Y||q)&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsx(z,{size:20,strokeWidth:2}),"Links"]}),children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[H((xe=s==null?void 0:s.generatedMetadata)==null?void 0:xe.outboundLinks,"Outbound Links"),H((he=s==null?void 0:s.generatedMetadata)==null?void 0:he.internalLinks,"Internal Links")]})},"links"),G&&e.jsx("div",{tab:e.jsxs("span",{className:"flex items-center gap-2 text-sm md:text-base",children:[e.jsx(z,{size:20,strokeWidth:2}),"Initial Analysis"]}),children:F((ue=s==null?void 0:s.generatedMetadata)==null?void 0:ue.competitorsAnalysis)},"initial-analysis")]})})]})})};export{z as A,hs as C,ss as R,xs as a};
